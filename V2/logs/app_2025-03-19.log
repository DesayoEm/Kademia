2025-03-19 00:46:14,567 - kademia - INFO - Application started
2025-03-19 00:46:45,839 - kademia - INFO - Request started | a77b5e5c-72cc-4942-aa88-9e15b62b791a | GET /
2025-03-19 00:46:45,841 - kademia - INFO - Request completed | a77b5e5c-72cc-4942-aa88-9e15b62b791a | Status: 200 | Time: 0.001s
2025-03-19 00:46:49,031 - kademia - INFO - Request started | 81102679-5720-42eb-9b55-f03564260e48 | GET /docs
2025-03-19 00:46:49,037 - kademia - INFO - Request completed | 81102679-5720-42eb-9b55-f03564260e48 | Status: 200 | Time: 0.002s
2025-03-19 00:46:49,385 - kademia - INFO - Request started | 6d47e0c6-86ae-4cef-a58a-eb4902f9743e | GET /openapi.json
2025-03-19 00:46:49,555 - kademia - INFO - Request completed | 6d47e0c6-86ae-4cef-a58a-eb4902f9743e | Status: 200 | Time: 0.169s
2025-03-19 00:47:46,176 - kademia - INFO - Application started
2025-03-19 00:47:57,219 - kademia - INFO - Application started
2025-03-19 00:48:02,521 - kademia - INFO - Request started | f67db7b3-3c3a-4602-82a2-9acba2c3ef19 | GET /doc
2025-03-19 00:48:02,523 - kademia - INFO - Request completed | f67db7b3-3c3a-4602-82a2-9acba2c3ef19 | Status: 404 | Time: 0.001s
2025-03-19 00:48:02,657 - kademia - INFO - Request started | 473c1544-b6f3-45a6-916f-42333e1c5045 | GET /favicon.ico
2025-03-19 00:48:02,659 - kademia - INFO - Request completed | 473c1544-b6f3-45a6-916f-42333e1c5045 | Status: 404 | Time: 0.001s
2025-03-19 00:48:05,989 - kademia - INFO - Request started | 40642e5b-e24e-4ca3-b0b6-66aab96cd9b6 | GET /docs
2025-03-19 00:48:05,990 - kademia - INFO - Request completed | 40642e5b-e24e-4ca3-b0b6-66aab96cd9b6 | Status: 200 | Time: 0.001s
2025-03-19 00:48:06,153 - kademia - INFO - Request started | 2e9ea3ae-7285-4f67-8e5e-15923ee3f1dd | GET /openapi.json
2025-03-19 00:48:06,334 - kademia - INFO - Request completed | 2e9ea3ae-7285-4f67-8e5e-15923ee3f1dd | Status: 200 | Time: 0.182s
2025-03-19 00:48:06,878 - kademia - INFO - Request started | 92190cfd-e757-4a4e-8ee8-e2612502fb59 | GET /docs
2025-03-19 00:48:06,896 - kademia - INFO - Request completed | 92190cfd-e757-4a4e-8ee8-e2612502fb59 | Status: 200 | Time: 0.001s
2025-03-19 00:48:07,069 - kademia - INFO - Request started | cacc2dae-1018-49fb-81fa-8a0648649885 | GET /openapi.json
2025-03-19 00:48:07,072 - kademia - INFO - Request completed | cacc2dae-1018-49fb-81fa-8a0648649885 | Status: 200 | Time: 0.002s
2025-03-19 00:49:15,473 - kademia - INFO - Request started | 403aa6f2-9507-43f7-9fc7-3a4abf6a8474 | POST /api/v1/students/departments/
2025-03-19 00:49:15,475 - kademia - INFO - Request completed | 403aa6f2-9507-43f7-9fc7-3a4abf6a8474 | Status: 422 | Time: 0.001s
2025-03-19 00:49:49,778 - kademia - INFO - Request started | c8d6098d-0483-472c-abff-68a478ff5d56 | POST /api/v1/students/departments/
2025-03-19 00:49:49,781 - kademia - INFO - Request completed | c8d6098d-0483-472c-abff-68a478ff5d56 | Status: 422 | Time: 0.002s
2025-03-19 00:50:02,718 - kademia - INFO - Request started | 2cd0b0f6-9c35-47db-99be-bff0d373dfd7 | POST /api/v1/students/departments/
2025-03-19 00:50:02,720 - kademia - INFO - Request completed | 2cd0b0f6-9c35-47db-99be-bff0d373dfd7 | Status: 422 | Time: 0.002s
2025-03-19 00:50:42,863 - kademia - INFO - Application started
2025-03-19 00:50:42,871 - kademia - INFO - Application started
2025-03-19 00:50:42,951 - kademia - INFO - Request started | b99821f9-ca01-4d79-958b-5ca2b7fd01ea | GET /docs
2025-03-19 00:50:42,955 - kademia - INFO - Request completed | b99821f9-ca01-4d79-958b-5ca2b7fd01ea | Status: 200 | Time: 0.002s
2025-03-19 00:50:43,100 - kademia - INFO - Request started | 203afc8e-659f-4597-8f12-17725f74fa7b | GET /openapi.json
2025-03-19 00:50:43,318 - kademia - INFO - Request completed | 203afc8e-659f-4597-8f12-17725f74fa7b | Status: 200 | Time: 0.218s
2025-03-19 00:51:02,867 - kademia - INFO - Request started | e283d97b-4c83-4b7a-bb38-debc1cde32a5 | POST /api/v1/students/departments/
2025-03-19 00:51:03,437 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-03-19 00:51:03,438 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-03-19 00:51:03,441 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-03-19 00:51:03,442 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-03-19 00:51:03,445 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-03-19 00:51:03,446 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-03-19 00:51:03,448 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 00:51:03,458 - sqlalchemy.engine.Engine - INFO - INSERT INTO student_departments (id, name, description, mentor_id, student_rep_id, assistant_rep_id, created_by, last_modified_by, created_at, last_modified_at, is_archived, archived_at, archive_reason, archived_by) VALUES (%(id)s::UUID, %(name)s, %(description)s, %(mentor_id)s::UUID, %(student_rep_id)s::UUID, %(assistant_rep_id)s::UUID, %(created_by)s::UUID, %(last_modified_by)s::UUID, now(), now(), %(is_archived)s, %(archived_at)s, %(archive_reason)s, %(archived_by)s::UUID) RETURNING student_departments.created_at, student_departments.last_modified_at
2025-03-19 00:51:03,460 - sqlalchemy.engine.Engine - INFO - [generated in 0.00221s] {'id': UUID('0eda033a-29f2-4706-b0a4-647238eba9a7'), 'name': 'Science', 'description': 'Science Classes', 'mentor_id': None, 'student_rep_id': None, 'assistant_rep_id': None, 'created_by': UUID('00000000-0000-0000-0000-000000000000'), 'last_modified_by': UUID('00000000-0000-0000-0000-000000000000'), 'is_archived': False, 'archived_at': None, 'archive_reason': None, 'archived_by': None}
2025-03-19 00:51:03,467 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-19 00:51:03,471 - kademia - ERROR - Unhandled exception | e283d97b-4c83-4b7a-bb38-debc1cde32a5 | Duplicate student department creation attempted: unique constraint violation - detail: (psycopg2.errors.uniqueviolation) duplicate key value violates unique constraint "student_departments_name_key"
detail:  key (name)=(science) already exists.

[sql: insert into student_departments (id, name, description, mentor_id, student_rep_id, assistant_rep_id, created_by, last_modified_by, created_at, last_modified_at, is_archived, archived_at, archive_reason, archived_by) values (%(id)s::uuid, %(name)s, %(description)s, %(mentor_id)s::uuid, %(student_rep_id)s::uuid, %(assistant_rep_id)s::uuid, %(created_by)s::uuid, %(last_modified_by)s::uuid, now(), now(), %(is_archived)s, %(archived_at)s, %(archive_reason)s, %(archived_by)s::uuid) returning student_departments.created_at, student_departments.last_modified_at]
[parameters: {'id': uuid('0eda033a-29f2-4706-b0a4-647238eba9a7'), 'name': 'science', 'description': 'science classes', 'mentor_id': none, 'student_rep_id': none, 'assistant_rep_id': none, 'created_by': uuid('00000000-0000-0000-0000-000000000000'), 'last_modified_by': uuid('00000000-0000-0000-0000-000000000000'), 'is_archived': false, 'archived_at': none, 'archive_reason': none, 'archived_by': none}]
(background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 111, in receive
    return self.receive_nowait()
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 106, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 124, in receive
    return receiver.item
           ^^^^^^^^^^^^^
AttributeError: 'MemoryObjectItemReceiver' object has no attribute 'item'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 157, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 126, in receive
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\middleware\error_handler.py", line 81, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\fastapi\routing.py", line 214, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\to_thread.py", line 56, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2461, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 962, in run
    result = context.run(func, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\routers\student_organization\student_departments.py", line 22, in create_department
    return student_departments_crud.create_department(data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\crud\student_organization\student_departments.py", line 30, in create_department
    department = self.factory.create_student_department(data)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\core\factories\student_organization\department.py", line 48, in create_student_department
    raise DuplicateStudentDepartmentError(
app.core.errors.student_organisation_errors.DuplicateStudentDepartmentError: Duplicate student department creation attempted: unique constraint violation - detail: (psycopg2.errors.uniqueviolation) duplicate key value violates unique constraint "student_departments_name_key"
detail:  key (name)=(science) already exists.

[sql: insert into student_departments (id, name, description, mentor_id, student_rep_id, assistant_rep_id, created_by, last_modified_by, created_at, last_modified_at, is_archived, archived_at, archive_reason, archived_by) values (%(id)s::uuid, %(name)s, %(description)s, %(mentor_id)s::uuid, %(student_rep_id)s::uuid, %(assistant_rep_id)s::uuid, %(created_by)s::uuid, %(last_modified_by)s::uuid, now(), now(), %(is_archived)s, %(archived_at)s, %(archive_reason)s, %(archived_by)s::uuid) returning student_departments.created_at, student_departments.last_modified_at]
[parameters: {'id': uuid('0eda033a-29f2-4706-b0a4-647238eba9a7'), 'name': 'science', 'description': 'science classes', 'mentor_id': none, 'student_rep_id': none, 'assistant_rep_id': none, 'created_by': uuid('00000000-0000-0000-0000-000000000000'), 'last_modified_by': uuid('00000000-0000-0000-0000-000000000000'), 'is_archived': false, 'archived_at': none, 'archive_reason': none, 'archived_by': none}]
(background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-19 00:51:03,513 - kademia - WARNING - UniqueViolationError | e283d97b-4c83-4b7a-bb38-debc1cde32a5 | Duplicate student department creation attempted: unique constraint violation - detail: (psycopg2.errors.uniqueviolation) duplicate key value violates unique constraint "student_departments_name_key"
detail:  key (name)=(science) already exists.

[sql: insert into student_departments (id, name, description, mentor_id, student_rep_id, assistant_rep_id, created_by, last_modified_by, created_at, last_modified_at, is_archived, archived_at, archive_reason, archived_by) values (%(id)s::uuid, %(name)s, %(description)s, %(mentor_id)s::uuid, %(student_rep_id)s::uuid, %(assistant_rep_id)s::uuid, %(created_by)s::uuid, %(last_modified_by)s::uuid, now(), now(), %(is_archived)s, %(archived_at)s, %(archive_reason)s, %(archived_by)s::uuid) returning student_departments.created_at, student_departments.last_modified_at]
[parameters: {'id': uuid('0eda033a-29f2-4706-b0a4-647238eba9a7'), 'name': 'science', 'description': 'science classes', 'mentor_id': none, 'student_rep_id': none, 'assistant_rep_id': none, 'created_by': uuid('00000000-0000-0000-0000-000000000000'), 'last_modified_by': uuid('00000000-0000-0000-0000-000000000000'), 'is_archived': false, 'archived_at': none, 'archive_reason': none, 'archived_by': none}]
(background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-19 00:52:21,041 - kademia - INFO - Application started
2025-03-19 00:52:21,042 - kademia - INFO - Application started
2025-03-19 00:52:26,302 - kademia - INFO - Request started | 3d848c2d-9873-4471-b8f3-af8dff0b6b25 | GET /docs
2025-03-19 00:52:26,305 - kademia - INFO - Request completed | 3d848c2d-9873-4471-b8f3-af8dff0b6b25 | Status: 200 | Time: 0.001s
2025-03-19 00:52:26,448 - kademia - INFO - Request started | 83aa7a07-6d86-4996-bb93-73380b5e7aab | GET /openapi.json
2025-03-19 00:52:26,615 - kademia - INFO - Request completed | 83aa7a07-6d86-4996-bb93-73380b5e7aab | Status: 200 | Time: 0.167s
2025-03-19 00:52:39,209 - kademia - INFO - Request started | de7d6007-e9b4-438f-b4fa-bf43342b6e8a | POST /api/v1/students/departments/
2025-03-19 00:52:39,761 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-03-19 00:52:39,762 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-03-19 00:52:39,765 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-03-19 00:52:39,766 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-03-19 00:52:39,768 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-03-19 00:52:39,769 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-03-19 00:52:39,771 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 00:52:39,779 - sqlalchemy.engine.Engine - INFO - INSERT INTO student_departments (id, name, description, mentor_id, student_rep_id, assistant_rep_id, created_by, last_modified_by, created_at, last_modified_at, is_archived, archived_at, archive_reason, archived_by) VALUES (%(id)s::UUID, %(name)s, %(description)s, %(mentor_id)s::UUID, %(student_rep_id)s::UUID, %(assistant_rep_id)s::UUID, %(created_by)s::UUID, %(last_modified_by)s::UUID, now(), now(), %(is_archived)s, %(archived_at)s, %(archive_reason)s, %(archived_by)s::UUID) RETURNING student_departments.created_at, student_departments.last_modified_at
2025-03-19 00:52:39,781 - sqlalchemy.engine.Engine - INFO - [generated in 0.00184s] {'id': UUID('529d310f-d587-403e-b70e-ca4771d7e3c7'), 'name': 'Science', 'description': 'Science Classes', 'mentor_id': None, 'student_rep_id': None, 'assistant_rep_id': None, 'created_by': UUID('00000000-0000-0000-0000-000000000000'), 'last_modified_by': UUID('00000000-0000-0000-0000-000000000000'), 'is_archived': False, 'archived_at': None, 'archive_reason': None, 'archived_by': None}
2025-03-19 00:52:39,787 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-19 00:52:39,790 - kademia - ERROR - Unhandled exception | de7d6007-e9b4-438f-b4fa-bf43342b6e8a | Duplicate student department creation attempted: Unique constraint violation - Detail: (psycopg2.errors.uniqueviolation) duplicate key value violates unique constraint "student_departments_name_key"
detail:  key (name)=(science) already exists.

[sql: insert into student_departments (id, name, description, mentor_id, student_rep_id, assistant_rep_id, created_by, last_modified_by, created_at, last_modified_at, is_archived, archived_at, archive_reason, archived_by) values (%(id)s::uuid, %(name)s, %(description)s, %(mentor_id)s::uuid, %(student_rep_id)s::uuid, %(assistant_rep_id)s::uuid, %(created_by)s::uuid, %(last_modified_by)s::uuid, now(), now(), %(is_archived)s, %(archived_at)s, %(archive_reason)s, %(archived_by)s::uuid) returning student_departments.created_at, student_departments.last_modified_at]
[parameters: {'id': uuid('529d310f-d587-403e-b70e-ca4771d7e3c7'), 'name': 'science', 'description': 'science classes', 'mentor_id': none, 'student_rep_id': none, 'assistant_rep_id': none, 'created_by': uuid('00000000-0000-0000-0000-000000000000'), 'last_modified_by': uuid('00000000-0000-0000-0000-000000000000'), 'is_archived': false, 'archived_at': none, 'archive_reason': none, 'archived_by': none}]
(background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 111, in receive
    return self.receive_nowait()
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 106, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 124, in receive
    return receiver.item
           ^^^^^^^^^^^^^
AttributeError: 'MemoryObjectItemReceiver' object has no attribute 'item'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 157, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 126, in receive
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\middleware\error_handler.py", line 81, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\fastapi\routing.py", line 214, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\to_thread.py", line 56, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2461, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 962, in run
    result = context.run(func, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\routers\student_organization\student_departments.py", line 22, in create_department
    return student_departments_crud.create_department(data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\crud\student_organization\student_departments.py", line 30, in create_department
    department = self.factory.create_student_department(data)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\core\factories\student_organization\department.py", line 44, in create_student_department
    raise DuplicateStudentDepartmentError(
app.core.errors.student_organisation_errors.DuplicateStudentDepartmentError: Duplicate student department creation attempted: Unique constraint violation - Detail: (psycopg2.errors.uniqueviolation) duplicate key value violates unique constraint "student_departments_name_key"
detail:  key (name)=(science) already exists.

[sql: insert into student_departments (id, name, description, mentor_id, student_rep_id, assistant_rep_id, created_by, last_modified_by, created_at, last_modified_at, is_archived, archived_at, archive_reason, archived_by) values (%(id)s::uuid, %(name)s, %(description)s, %(mentor_id)s::uuid, %(student_rep_id)s::uuid, %(assistant_rep_id)s::uuid, %(created_by)s::uuid, %(last_modified_by)s::uuid, now(), now(), %(is_archived)s, %(archived_at)s, %(archive_reason)s, %(archived_by)s::uuid) returning student_departments.created_at, student_departments.last_modified_at]
[parameters: {'id': uuid('529d310f-d587-403e-b70e-ca4771d7e3c7'), 'name': 'science', 'description': 'science classes', 'mentor_id': none, 'student_rep_id': none, 'assistant_rep_id': none, 'created_by': uuid('00000000-0000-0000-0000-000000000000'), 'last_modified_by': uuid('00000000-0000-0000-0000-000000000000'), 'is_archived': false, 'archived_at': none, 'archive_reason': none, 'archived_by': none}]
(background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-19 00:52:39,816 - kademia - WARNING - UniqueViolationError | de7d6007-e9b4-438f-b4fa-bf43342b6e8a | Duplicate student department creation attempted: Unique constraint violation - Detail: (psycopg2.errors.uniqueviolation) duplicate key value violates unique constraint "student_departments_name_key"
detail:  key (name)=(science) already exists.

[sql: insert into student_departments (id, name, description, mentor_id, student_rep_id, assistant_rep_id, created_by, last_modified_by, created_at, last_modified_at, is_archived, archived_at, archive_reason, archived_by) values (%(id)s::uuid, %(name)s, %(description)s, %(mentor_id)s::uuid, %(student_rep_id)s::uuid, %(assistant_rep_id)s::uuid, %(created_by)s::uuid, %(last_modified_by)s::uuid, now(), now(), %(is_archived)s, %(archived_at)s, %(archive_reason)s, %(archived_by)s::uuid) returning student_departments.created_at, student_departments.last_modified_at]
[parameters: {'id': uuid('529d310f-d587-403e-b70e-ca4771d7e3c7'), 'name': 'science', 'description': 'science classes', 'mentor_id': none, 'student_rep_id': none, 'assistant_rep_id': none, 'created_by': uuid('00000000-0000-0000-0000-000000000000'), 'last_modified_by': uuid('00000000-0000-0000-0000-000000000000'), 'is_archived': false, 'archived_at': none, 'archive_reason': none, 'archived_by': none}]
(background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-19 00:52:54,292 - kademia - INFO - Request started | 8cbd47fe-12bf-4afd-b3c5-e0fd96c44f51 | POST /api/v1/students/departments/
2025-03-19 00:52:54,296 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 00:52:54,297 - sqlalchemy.engine.Engine - INFO - INSERT INTO student_departments (id, name, description, mentor_id, student_rep_id, assistant_rep_id, created_by, last_modified_by, created_at, last_modified_at, is_archived, archived_at, archive_reason, archived_by) VALUES (%(id)s::UUID, %(name)s, %(description)s, %(mentor_id)s::UUID, %(student_rep_id)s::UUID, %(assistant_rep_id)s::UUID, %(created_by)s::UUID, %(last_modified_by)s::UUID, now(), now(), %(is_archived)s, %(archived_at)s, %(archive_reason)s, %(archived_by)s::UUID) RETURNING student_departments.created_at, student_departments.last_modified_at
2025-03-19 00:52:54,298 - sqlalchemy.engine.Engine - INFO - [cached since 14.52s ago] {'id': UUID('e86f156b-c846-4a47-9b84-54037eb609cf'), 'name': 'Science', 'description': 'Sciencetv Classes', 'mentor_id': None, 'student_rep_id': None, 'assistant_rep_id': None, 'created_by': UUID('00000000-0000-0000-0000-000000000000'), 'last_modified_by': UUID('00000000-0000-0000-0000-000000000000'), 'is_archived': False, 'archived_at': None, 'archive_reason': None, 'archived_by': None}
2025-03-19 00:52:54,300 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-19 00:52:54,303 - kademia - ERROR - Unhandled exception | 8cbd47fe-12bf-4afd-b3c5-e0fd96c44f51 | Duplicate student department creation attempted: Unique constraint violation - Detail: (psycopg2.errors.uniqueviolation) duplicate key value violates unique constraint "student_departments_name_key"
detail:  key (name)=(science) already exists.

[sql: insert into student_departments (id, name, description, mentor_id, student_rep_id, assistant_rep_id, created_by, last_modified_by, created_at, last_modified_at, is_archived, archived_at, archive_reason, archived_by) values (%(id)s::uuid, %(name)s, %(description)s, %(mentor_id)s::uuid, %(student_rep_id)s::uuid, %(assistant_rep_id)s::uuid, %(created_by)s::uuid, %(last_modified_by)s::uuid, now(), now(), %(is_archived)s, %(archived_at)s, %(archive_reason)s, %(archived_by)s::uuid) returning student_departments.created_at, student_departments.last_modified_at]
[parameters: {'id': uuid('e86f156b-c846-4a47-9b84-54037eb609cf'), 'name': 'science', 'description': 'sciencetv classes', 'mentor_id': none, 'student_rep_id': none, 'assistant_rep_id': none, 'created_by': uuid('00000000-0000-0000-0000-000000000000'), 'last_modified_by': uuid('00000000-0000-0000-0000-000000000000'), 'is_archived': false, 'archived_at': none, 'archive_reason': none, 'archived_by': none}]
(background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 111, in receive
    return self.receive_nowait()
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 106, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 124, in receive
    return receiver.item
           ^^^^^^^^^^^^^
AttributeError: 'MemoryObjectItemReceiver' object has no attribute 'item'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 157, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 126, in receive
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\middleware\error_handler.py", line 81, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\fastapi\routing.py", line 214, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\to_thread.py", line 56, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2461, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 962, in run
    result = context.run(func, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\routers\student_organization\student_departments.py", line 22, in create_department
    return student_departments_crud.create_department(data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\crud\student_organization\student_departments.py", line 30, in create_department
    department = self.factory.create_student_department(data)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\core\factories\student_organization\department.py", line 44, in create_student_department
    raise DuplicateStudentDepartmentError(
app.core.errors.student_organisation_errors.DuplicateStudentDepartmentError: Duplicate student department creation attempted: Unique constraint violation - Detail: (psycopg2.errors.uniqueviolation) duplicate key value violates unique constraint "student_departments_name_key"
detail:  key (name)=(science) already exists.

[sql: insert into student_departments (id, name, description, mentor_id, student_rep_id, assistant_rep_id, created_by, last_modified_by, created_at, last_modified_at, is_archived, archived_at, archive_reason, archived_by) values (%(id)s::uuid, %(name)s, %(description)s, %(mentor_id)s::uuid, %(student_rep_id)s::uuid, %(assistant_rep_id)s::uuid, %(created_by)s::uuid, %(last_modified_by)s::uuid, now(), now(), %(is_archived)s, %(archived_at)s, %(archive_reason)s, %(archived_by)s::uuid) returning student_departments.created_at, student_departments.last_modified_at]
[parameters: {'id': uuid('e86f156b-c846-4a47-9b84-54037eb609cf'), 'name': 'science', 'description': 'sciencetv classes', 'mentor_id': none, 'student_rep_id': none, 'assistant_rep_id': none, 'created_by': uuid('00000000-0000-0000-0000-000000000000'), 'last_modified_by': uuid('00000000-0000-0000-0000-000000000000'), 'is_archived': false, 'archived_at': none, 'archive_reason': none, 'archived_by': none}]
(background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-19 00:52:54,316 - kademia - WARNING - UniqueViolationError | 8cbd47fe-12bf-4afd-b3c5-e0fd96c44f51 | Duplicate student department creation attempted: Unique constraint violation - Detail: (psycopg2.errors.uniqueviolation) duplicate key value violates unique constraint "student_departments_name_key"
detail:  key (name)=(science) already exists.

[sql: insert into student_departments (id, name, description, mentor_id, student_rep_id, assistant_rep_id, created_by, last_modified_by, created_at, last_modified_at, is_archived, archived_at, archive_reason, archived_by) values (%(id)s::uuid, %(name)s, %(description)s, %(mentor_id)s::uuid, %(student_rep_id)s::uuid, %(assistant_rep_id)s::uuid, %(created_by)s::uuid, %(last_modified_by)s::uuid, now(), now(), %(is_archived)s, %(archived_at)s, %(archive_reason)s, %(archived_by)s::uuid) returning student_departments.created_at, student_departments.last_modified_at]
[parameters: {'id': uuid('e86f156b-c846-4a47-9b84-54037eb609cf'), 'name': 'science', 'description': 'sciencetv classes', 'mentor_id': none, 'student_rep_id': none, 'assistant_rep_id': none, 'created_by': uuid('00000000-0000-0000-0000-000000000000'), 'last_modified_by': uuid('00000000-0000-0000-0000-000000000000'), 'is_archived': false, 'archived_at': none, 'archive_reason': none, 'archived_by': none}]
(background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-19 00:53:01,150 - kademia - INFO - Request started | d9975156-8a57-49ee-ae69-8855cb9ecd06 | POST /api/v1/students/departments/
2025-03-19 00:53:01,154 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 00:53:01,155 - sqlalchemy.engine.Engine - INFO - INSERT INTO student_departments (id, name, description, mentor_id, student_rep_id, assistant_rep_id, created_by, last_modified_by, created_at, last_modified_at, is_archived, archived_at, archive_reason, archived_by) VALUES (%(id)s::UUID, %(name)s, %(description)s, %(mentor_id)s::UUID, %(student_rep_id)s::UUID, %(assistant_rep_id)s::UUID, %(created_by)s::UUID, %(last_modified_by)s::UUID, now(), now(), %(is_archived)s, %(archived_at)s, %(archive_reason)s, %(archived_by)s::UUID) RETURNING student_departments.created_at, student_departments.last_modified_at
2025-03-19 00:53:01,156 - sqlalchemy.engine.Engine - INFO - [cached since 21.38s ago] {'id': UUID('cdb909cf-4d27-4105-8f18-5b9a5f3b0070'), 'name': 'Sciennce', 'description': 'Sciencetv Classes', 'mentor_id': None, 'student_rep_id': None, 'assistant_rep_id': None, 'created_by': UUID('00000000-0000-0000-0000-000000000000'), 'last_modified_by': UUID('00000000-0000-0000-0000-000000000000'), 'is_archived': False, 'archived_at': None, 'archive_reason': None, 'archived_by': None}
2025-03-19 00:53:01,169 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-19 00:53:01,177 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 00:53:01,188 - sqlalchemy.engine.Engine - INFO - SELECT student_departments.id, student_departments.name, student_departments.description, student_departments.mentor_id, student_departments.student_rep_id, student_departments.assistant_rep_id, student_departments.created_by, student_departments.last_modified_by, student_departments.created_at, student_departments.last_modified_at, student_departments.is_archived, student_departments.archived_at, student_departments.archive_reason, student_departments.archived_by 
FROM student_departments 
WHERE student_departments.id = %(pk_1)s::UUID
2025-03-19 00:53:01,191 - sqlalchemy.engine.Engine - INFO - [generated in 0.00245s] {'pk_1': UUID('cdb909cf-4d27-4105-8f18-5b9a5f3b0070')}
2025-03-19 00:53:01,201 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-19 00:53:01,204 - kademia - INFO - Request completed | d9975156-8a57-49ee-ae69-8855cb9ecd06 | Status: 201 | Time: 0.053s
2025-03-19 00:54:33,380 - kademia - INFO - Request started | 691451f3-da8b-4a7f-8e8d-f50f886da952 | GET /api/v1/students/departments/
2025-03-19 00:54:33,385 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 00:54:33,390 - sqlalchemy.engine.Engine - INFO - SELECT student_departments.id AS student_departments_id, student_departments.name AS student_departments_name, student_departments.description AS student_departments_description, student_departments.mentor_id AS student_departments_mentor_id, student_departments.student_rep_id AS student_departments_student_rep_id, student_departments.assistant_rep_id AS student_departments_assistant_rep_id, student_departments.created_by AS student_departments_created_by, student_departments.last_modified_by AS student_departments_last_modified_by, student_departments.created_at AS student_departments_created_at, student_departments.last_modified_at AS student_departments_last_modified_at, student_departments.is_archived AS student_departments_is_archived, student_departments.archived_at AS student_departments_archived_at, student_departments.archive_reason AS student_departments_archive_reason, student_departments.archived_by AS student_departments_archived_by 
FROM student_departments 
WHERE student_departments.is_archived = false ORDER BY student_departments.name DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
2025-03-19 00:54:33,391 - sqlalchemy.engine.Engine - INFO - [generated in 0.00135s] {'param_1': 50, 'param_2': 0}
2025-03-19 00:54:33,397 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-19 00:54:33,429 - kademia - INFO - Request completed | 691451f3-da8b-4a7f-8e8d-f50f886da952 | Status: 200 | Time: 0.047s
2025-03-19 00:54:52,838 - kademia - INFO - Request started | 0449736b-5fc5-43e0-9b24-cf9c6d67caab | GET /api/v1/students/departments/cdb909cf-4d27-4105-8f18-5b9a5f3b0070
2025-03-19 00:54:52,841 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 00:54:52,843 - sqlalchemy.engine.Engine - INFO - SELECT student_departments.id AS student_departments_id, student_departments.name AS student_departments_name, student_departments.description AS student_departments_description, student_departments.mentor_id AS student_departments_mentor_id, student_departments.student_rep_id AS student_departments_student_rep_id, student_departments.assistant_rep_id AS student_departments_assistant_rep_id, student_departments.created_by AS student_departments_created_by, student_departments.last_modified_by AS student_departments_last_modified_by, student_departments.created_at AS student_departments_created_at, student_departments.last_modified_at AS student_departments_last_modified_at, student_departments.is_archived AS student_departments_is_archived, student_departments.archived_at AS student_departments_archived_at, student_departments.archive_reason AS student_departments_archive_reason, student_departments.archived_by AS student_departments_archived_by 
FROM student_departments 
WHERE student_departments.is_archived = false AND student_departments.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-03-19 00:54:52,845 - sqlalchemy.engine.Engine - INFO - [generated in 0.00143s] {'id_1': UUID('cdb909cf-4d27-4105-8f18-5b9a5f3b0070'), 'param_1': 1}
2025-03-19 00:54:52,850 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-19 00:54:52,852 - kademia - INFO - Request completed | 0449736b-5fc5-43e0-9b24-cf9c6d67caab | Status: 200 | Time: 0.014s
2025-03-19 00:55:22,722 - kademia - INFO - Request started | 910a0f61-c43d-4250-821a-799d6edf2b10 | PUT /api/v1/students/departments/cdb909cf-4d27-4105-8f18-5b9a5f3b0070
2025-03-19 00:55:22,730 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 00:55:22,731 - sqlalchemy.engine.Engine - INFO - SELECT student_departments.id AS student_departments_id, student_departments.name AS student_departments_name, student_departments.description AS student_departments_description, student_departments.mentor_id AS student_departments_mentor_id, student_departments.student_rep_id AS student_departments_student_rep_id, student_departments.assistant_rep_id AS student_departments_assistant_rep_id, student_departments.created_by AS student_departments_created_by, student_departments.last_modified_by AS student_departments_last_modified_by, student_departments.created_at AS student_departments_created_at, student_departments.last_modified_at AS student_departments_last_modified_at, student_departments.is_archived AS student_departments_is_archived, student_departments.archived_at AS student_departments_archived_at, student_departments.archive_reason AS student_departments_archive_reason, student_departments.archived_by AS student_departments_archived_by 
FROM student_departments 
WHERE student_departments.is_archived = false AND student_departments.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-03-19 00:55:22,732 - sqlalchemy.engine.Engine - INFO - [cached since 29.89s ago] {'id_1': UUID('cdb909cf-4d27-4105-8f18-5b9a5f3b0070'), 'param_1': 1}
2025-03-19 00:55:22,738 - sqlalchemy.engine.Engine - INFO - UPDATE student_departments SET description=%(description)s, mentor_id=%(mentor_id)s::UUID, last_modified_at=now() WHERE student_departments.id = %(student_departments_id)s::UUID
2025-03-19 00:55:22,739 - sqlalchemy.engine.Engine - INFO - [generated in 0.00112s] {'description': 'Science Classes', 'mentor_id': UUID('c8d6098d-0483-472c-abff-68a478ff5d56'), 'student_departments_id': UUID('cdb909cf-4d27-4105-8f18-5b9a5f3b0070')}
2025-03-19 00:55:22,753 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-19 00:55:22,800 - kademia - ERROR - Unhandled exception | 910a0f61-c43d-4250-821a-799d6edf2b10 | 1 validation error for DepartmentResponse
  Input should be a valid dictionary or object to extract fields from [type=model_attributes_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.10/v/model_attributes_type
Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 111, in receive
    return self.receive_nowait()
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 106, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 124, in receive
    return receiver.item
           ^^^^^^^^^^^^^
AttributeError: 'MemoryObjectItemReceiver' object has no attribute 'item'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 157, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 126, in receive
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\middleware\error_handler.py", line 81, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\fastapi\routing.py", line 214, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\to_thread.py", line 56, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2461, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 962, in run
    result = context.run(func, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\routers\student_organization\student_departments.py", line 44, in update_department
    return student_departments_crud.update_department(department_id, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\crud\student_organization\student_departments.py", line 64, in update_department
    return DepartmentResponse.model_validate(updated_department)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\pydantic\main.py", line 627, in model_validate
    return cls.__pydantic_validator__.validate_python(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pydantic_core._pydantic_core.ValidationError: 1 validation error for DepartmentResponse
  Input should be a valid dictionary or object to extract fields from [type=model_attributes_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.10/v/model_attributes_type
2025-03-19 00:55:22,825 - kademia - ERROR - Unhandled exception | 910a0f61-c43d-4250-821a-799d6edf2b10 | 1 validation error for DepartmentResponse
  Input should be a valid dictionary or object to extract fields from [type=model_attributes_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.10/v/model_attributes_type
Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 111, in receive
    return self.receive_nowait()
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 106, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 124, in receive
    return receiver.item
           ^^^^^^^^^^^^^
AttributeError: 'MemoryObjectItemReceiver' object has no attribute 'item'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 157, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 126, in receive
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\middleware\error_handler.py", line 81, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\fastapi\routing.py", line 214, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\to_thread.py", line 56, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2461, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 962, in run
    result = context.run(func, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\routers\student_organization\student_departments.py", line 44, in update_department
    return student_departments_crud.update_department(department_id, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\crud\student_organization\student_departments.py", line 64, in update_department
    return DepartmentResponse.model_validate(updated_department)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\pydantic\main.py", line 627, in model_validate
    return cls.__pydantic_validator__.validate_python(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pydantic_core._pydantic_core.ValidationError: 1 validation error for DepartmentResponse
  Input should be a valid dictionary or object to extract fields from [type=model_attributes_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.10/v/model_attributes_type
2025-03-19 00:58:26,486 - kademia - INFO - Application started
2025-03-19 00:58:26,493 - kademia - INFO - Application started
2025-03-19 00:58:31,869 - kademia - INFO - Request started | 56bfebac-13b3-4984-bce3-ba3280eb3587 | GET /docs
2025-03-19 00:58:31,871 - kademia - INFO - Request completed | 56bfebac-13b3-4984-bce3-ba3280eb3587 | Status: 200 | Time: 0.001s
2025-03-19 00:58:32,036 - kademia - INFO - Request started | 381df2f9-498f-47be-a693-9f2c1b1bfd86 | GET /openapi.json
2025-03-19 00:58:32,245 - kademia - INFO - Request completed | 381df2f9-498f-47be-a693-9f2c1b1bfd86 | Status: 200 | Time: 0.209s
2025-03-19 00:59:03,229 - kademia - INFO - Request started | 1679ae8d-02a9-488c-8196-31116ef7cc87 | PUT /api/v1/students/departments/cdb909cf-4d27-4105-8f18-5b9a5f3b0070
2025-03-19 00:59:03,626 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-03-19 00:59:03,627 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-03-19 00:59:03,629 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-03-19 00:59:03,629 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-03-19 00:59:03,631 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-03-19 00:59:03,631 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-03-19 00:59:03,633 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 00:59:03,638 - sqlalchemy.engine.Engine - INFO - SELECT student_departments.id AS student_departments_id, student_departments.name AS student_departments_name, student_departments.description AS student_departments_description, student_departments.mentor_id AS student_departments_mentor_id, student_departments.student_rep_id AS student_departments_student_rep_id, student_departments.assistant_rep_id AS student_departments_assistant_rep_id, student_departments.created_by AS student_departments_created_by, student_departments.last_modified_by AS student_departments_last_modified_by, student_departments.created_at AS student_departments_created_at, student_departments.last_modified_at AS student_departments_last_modified_at, student_departments.is_archived AS student_departments_is_archived, student_departments.archived_at AS student_departments_archived_at, student_departments.archive_reason AS student_departments_archive_reason, student_departments.archived_by AS student_departments_archived_by 
FROM student_departments 
WHERE student_departments.is_archived = false AND student_departments.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-03-19 00:59:03,639 - sqlalchemy.engine.Engine - INFO - [generated in 0.00100s] {'id_1': UUID('cdb909cf-4d27-4105-8f18-5b9a5f3b0070'), 'param_1': 1}
2025-03-19 00:59:03,652 - sqlalchemy.engine.Engine - INFO - UPDATE student_departments SET name=%(name)s, description=%(description)s, mentor_id=%(mentor_id)s::UUID, last_modified_at=now() WHERE student_departments.id = %(student_departments_id)s::UUID
2025-03-19 00:59:03,652 - sqlalchemy.engine.Engine - INFO - [generated in 0.00079s] {'name': 'Science', 'description': 'Science Classes', 'mentor_id': UUID('c8d6098d-0483-472c-abff-68a478ff5d56'), 'student_departments_id': UUID('cdb909cf-4d27-4105-8f18-5b9a5f3b0070')}
2025-03-19 00:59:03,655 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-19 00:59:03,657 - kademia - ERROR - Unhandled exception | 1679ae8d-02a9-488c-8196-31116ef7cc87 | Duplicate student department creation attempted: Unique constraint violation - Detail: (raised as a result of query-invoked autoflush; consider using a session.no_autoflush block if this flush is occurring prematurely)
(psycopg2.errors.uniqueviolation) duplicate key value violates unique constraint "student_departments_name_key"
detail:  key (name)=(science) already exists.

[sql: update student_departments set name=%(name)s, description=%(description)s, mentor_id=%(mentor_id)s::uuid, last_modified_at=now() where student_departments.id = %(student_departments_id)s::uuid]
[parameters: {'name': 'science', 'description': 'science classes', 'mentor_id': uuid('c8d6098d-0483-472c-abff-68a478ff5d56'), 'student_departments_id': uuid('cdb909cf-4d27-4105-8f18-5b9a5f3b0070')}]
(background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 111, in receive
    return self.receive_nowait()
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 106, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 124, in receive
    return receiver.item
           ^^^^^^^^^^^^^
AttributeError: 'MemoryObjectItemReceiver' object has no attribute 'item'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 157, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 126, in receive
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\middleware\error_handler.py", line 81, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\fastapi\routing.py", line 214, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\to_thread.py", line 56, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2461, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 962, in run
    result = context.run(func, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\routers\student_organization\student_departments.py", line 44, in update_department
    return student_departments_crud.update_department(department_id, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\crud\student_organization\student_departments.py", line 63, in update_department
    updated_department = self.factory.update_student_department(department_id, data)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\core\factories\student_organization\department.py", line 112, in update_student_department
    raise DuplicateStudentDepartmentError(
app.core.errors.student_organisation_errors.DuplicateStudentDepartmentError: Duplicate student department creation attempted: Unique constraint violation - Detail: (raised as a result of query-invoked autoflush; consider using a session.no_autoflush block if this flush is occurring prematurely)
(psycopg2.errors.uniqueviolation) duplicate key value violates unique constraint "student_departments_name_key"
detail:  key (name)=(science) already exists.

[sql: update student_departments set name=%(name)s, description=%(description)s, mentor_id=%(mentor_id)s::uuid, last_modified_at=now() where student_departments.id = %(student_departments_id)s::uuid]
[parameters: {'name': 'science', 'description': 'science classes', 'mentor_id': uuid('c8d6098d-0483-472c-abff-68a478ff5d56'), 'student_departments_id': uuid('cdb909cf-4d27-4105-8f18-5b9a5f3b0070')}]
(background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-19 00:59:03,673 - kademia - WARNING - UniqueViolationError | 1679ae8d-02a9-488c-8196-31116ef7cc87 | Duplicate student department creation attempted: Unique constraint violation - Detail: (raised as a result of query-invoked autoflush; consider using a session.no_autoflush block if this flush is occurring prematurely)
(psycopg2.errors.uniqueviolation) duplicate key value violates unique constraint "student_departments_name_key"
detail:  key (name)=(science) already exists.

[sql: update student_departments set name=%(name)s, description=%(description)s, mentor_id=%(mentor_id)s::uuid, last_modified_at=now() where student_departments.id = %(student_departments_id)s::uuid]
[parameters: {'name': 'science', 'description': 'science classes', 'mentor_id': uuid('c8d6098d-0483-472c-abff-68a478ff5d56'), 'student_departments_id': uuid('cdb909cf-4d27-4105-8f18-5b9a5f3b0070')}]
(background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-19 00:59:19,830 - kademia - INFO - Request started | 59ef82fb-038b-4127-b570-d1718b17463b | PUT /api/v1/students/departments/cdb909cf-4d27-4105-8f18-5b9a5f3b0070
2025-03-19 00:59:19,834 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 00:59:19,835 - sqlalchemy.engine.Engine - INFO - SELECT student_departments.id AS student_departments_id, student_departments.name AS student_departments_name, student_departments.description AS student_departments_description, student_departments.mentor_id AS student_departments_mentor_id, student_departments.student_rep_id AS student_departments_student_rep_id, student_departments.assistant_rep_id AS student_departments_assistant_rep_id, student_departments.created_by AS student_departments_created_by, student_departments.last_modified_by AS student_departments_last_modified_by, student_departments.created_at AS student_departments_created_at, student_departments.last_modified_at AS student_departments_last_modified_at, student_departments.is_archived AS student_departments_is_archived, student_departments.archived_at AS student_departments_archived_at, student_departments.archive_reason AS student_departments_archive_reason, student_departments.archived_by AS student_departments_archived_by 
FROM student_departments 
WHERE student_departments.is_archived = false AND student_departments.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-03-19 00:59:19,836 - sqlalchemy.engine.Engine - INFO - [cached since 16.2s ago] {'id_1': UUID('cdb909cf-4d27-4105-8f18-5b9a5f3b0070'), 'param_1': 1}
2025-03-19 00:59:19,840 - sqlalchemy.engine.Engine - INFO - UPDATE student_departments SET name=%(name)s, description=%(description)s, mentor_id=%(mentor_id)s::UUID, last_modified_at=now() WHERE student_departments.id = %(student_departments_id)s::UUID
2025-03-19 00:59:19,841 - sqlalchemy.engine.Engine - INFO - [cached since 16.19s ago] {'name': 'Scienyiuuce', 'description': 'Science Classes', 'mentor_id': UUID('c8d6098d-0483-472c-abff-68a478ff5d56'), 'student_departments_id': UUID('cdb909cf-4d27-4105-8f18-5b9a5f3b0070')}
2025-03-19 00:59:19,847 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-19 00:59:19,851 - kademia - ERROR - Unhandled exception | 59ef82fb-038b-4127-b570-d1718b17463b | 1 validation error for DepartmentResponse
  Input should be a valid dictionary or object to extract fields from [type=model_attributes_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.10/v/model_attributes_type
Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 111, in receive
    return self.receive_nowait()
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 106, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 124, in receive
    return receiver.item
           ^^^^^^^^^^^^^
AttributeError: 'MemoryObjectItemReceiver' object has no attribute 'item'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 157, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 126, in receive
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\middleware\error_handler.py", line 81, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\fastapi\routing.py", line 214, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\to_thread.py", line 56, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2461, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 962, in run
    result = context.run(func, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\routers\student_organization\student_departments.py", line 44, in update_department
    return student_departments_crud.update_department(department_id, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\crud\student_organization\student_departments.py", line 64, in update_department
    return DepartmentResponse.model_validate(updated_department)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\pydantic\main.py", line 627, in model_validate
    return cls.__pydantic_validator__.validate_python(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pydantic_core._pydantic_core.ValidationError: 1 validation error for DepartmentResponse
  Input should be a valid dictionary or object to extract fields from [type=model_attributes_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.10/v/model_attributes_type
2025-03-19 00:59:19,873 - kademia - ERROR - Unhandled exception | 59ef82fb-038b-4127-b570-d1718b17463b | 1 validation error for DepartmentResponse
  Input should be a valid dictionary or object to extract fields from [type=model_attributes_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.10/v/model_attributes_type
Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 111, in receive
    return self.receive_nowait()
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 106, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 124, in receive
    return receiver.item
           ^^^^^^^^^^^^^
AttributeError: 'MemoryObjectItemReceiver' object has no attribute 'item'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 157, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 126, in receive
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\middleware\error_handler.py", line 81, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\fastapi\routing.py", line 214, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\to_thread.py", line 56, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2461, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 962, in run
    result = context.run(func, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\routers\student_organization\student_departments.py", line 44, in update_department
    return student_departments_crud.update_department(department_id, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\crud\student_organization\student_departments.py", line 64, in update_department
    return DepartmentResponse.model_validate(updated_department)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\pydantic\main.py", line 627, in model_validate
    return cls.__pydantic_validator__.validate_python(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pydantic_core._pydantic_core.ValidationError: 1 validation error for DepartmentResponse
  Input should be a valid dictionary or object to extract fields from [type=model_attributes_type, input_value=None, input_type=NoneType]
    For further information visit https://errors.pydantic.dev/2.10/v/model_attributes_type
2025-03-19 01:00:37,008 - kademia - INFO - Application started
2025-03-19 01:00:37,012 - kademia - INFO - Application started
2025-03-19 01:00:40,815 - kademia - INFO - Request started | 2961235a-748a-4e0a-b0d7-9feeb42ce39b | GET /docs
2025-03-19 01:00:40,818 - kademia - INFO - Request completed | 2961235a-748a-4e0a-b0d7-9feeb42ce39b | Status: 200 | Time: 0.003s
2025-03-19 01:00:40,964 - kademia - INFO - Request started | 20d5a445-52f0-4ab5-ac22-b336fe7eb248 | GET /openapi.json
2025-03-19 01:00:41,145 - kademia - INFO - Request completed | 20d5a445-52f0-4ab5-ac22-b336fe7eb248 | Status: 200 | Time: 0.181s
2025-03-19 01:01:13,558 - kademia - INFO - Request started | f18c3f87-da91-45a8-b57c-a2a7e21a74ab | PUT /api/v1/students/departments/cdb909cf-4d27-4105-8f18-5b9a5f3b0070
2025-03-19 01:01:13,956 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-03-19 01:01:13,957 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-03-19 01:01:13,959 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-03-19 01:01:13,960 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-03-19 01:01:13,961 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-03-19 01:01:13,962 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-03-19 01:01:13,963 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 01:01:13,970 - sqlalchemy.engine.Engine - INFO - SELECT student_departments.id AS student_departments_id, student_departments.name AS student_departments_name, student_departments.description AS student_departments_description, student_departments.mentor_id AS student_departments_mentor_id, student_departments.student_rep_id AS student_departments_student_rep_id, student_departments.assistant_rep_id AS student_departments_assistant_rep_id, student_departments.created_by AS student_departments_created_by, student_departments.last_modified_by AS student_departments_last_modified_by, student_departments.created_at AS student_departments_created_at, student_departments.last_modified_at AS student_departments_last_modified_at, student_departments.is_archived AS student_departments_is_archived, student_departments.archived_at AS student_departments_archived_at, student_departments.archive_reason AS student_departments_archive_reason, student_departments.archived_by AS student_departments_archived_by 
FROM student_departments 
WHERE student_departments.is_archived = false AND student_departments.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-03-19 01:01:13,972 - sqlalchemy.engine.Engine - INFO - [generated in 0.00171s] {'id_1': UUID('cdb909cf-4d27-4105-8f18-5b9a5f3b0070'), 'param_1': 1}
2025-03-19 01:01:13,984 - sqlalchemy.engine.Engine - INFO - UPDATE student_departments SET name=%(name)s, description=%(description)s, mentor_id=%(mentor_id)s::UUID, last_modified_at=now() WHERE student_departments.id = %(student_departments_id)s::UUID
2025-03-19 01:01:13,985 - sqlalchemy.engine.Engine - INFO - [generated in 0.00088s] {'name': 'Scrrtergience', 'description': 'Science Classes', 'mentor_id': UUID('c8d6098d-0483-472c-abff-68a478ff5d56'), 'student_departments_id': UUID('cdb909cf-4d27-4105-8f18-5b9a5f3b0070')}
2025-03-19 01:01:13,990 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-19 01:01:13,992 - kademia - ERROR - Unhandled exception | f18c3f87-da91-45a8-b57c-a2a7e21a74ab | Cannot update record because related unknown does not exist
Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 111, in receive
    return self.receive_nowait()
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 106, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 124, in receive
    return receiver.item
           ^^^^^^^^^^^^^
AttributeError: 'MemoryObjectItemReceiver' object has no attribute 'item'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 157, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 126, in receive
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\middleware\error_handler.py", line 81, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\fastapi\routing.py", line 214, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\to_thread.py", line 56, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2461, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 962, in run
    result = context.run(func, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\routers\student_organization\student_departments.py", line 44, in update_department
    return student_departments_crud.update_department(department_id, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\crud\student_organization\student_departments.py", line 63, in update_department
    updated_department = self.factory.update_student_department(department_id, data)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\core\factories\student_organization\department.py", line 126, in update_student_department
    raise RelationshipError(error=str(e), operation='update', entity='unknown')
app.core.errors.database_errors.RelationshipError: Cannot update record because related unknown does not exist
2025-03-19 01:01:14,008 - kademia - WARNING - RelationshipError | f18c3f87-da91-45a8-b57c-a2a7e21a74ab | Foreign key constraint violation during update operation. Detail: Cannot create record because related Unknown does not exist
2025-03-19 01:06:38,941 - kademia - INFO - Application started
2025-03-19 01:06:38,946 - kademia - INFO - Application started
2025-03-19 01:06:58,343 - kademia - INFO - Request started | bdf08766-819a-4a5a-8c5e-f21952e20ffb | GET /docs
2025-03-19 01:06:58,346 - kademia - INFO - Request completed | bdf08766-819a-4a5a-8c5e-f21952e20ffb | Status: 200 | Time: 0.002s
2025-03-19 01:06:58,483 - kademia - INFO - Request started | 6d57fd52-7d32-4fea-aee4-70856a7793b2 | GET /openapi.json
2025-03-19 01:06:58,685 - kademia - INFO - Request completed | 6d57fd52-7d32-4fea-aee4-70856a7793b2 | Status: 200 | Time: 0.202s
2025-03-19 01:07:22,807 - kademia - INFO - Request started | 1fa2d7bd-ed8e-4b85-8b28-3bb5fcad74d9 | PUT /api/v1/students/departments/cdb909cf-4d27-4105-8f18-5b9a5f3b0070
2025-03-19 01:07:23,203 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-03-19 01:07:23,204 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-03-19 01:07:23,207 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-03-19 01:07:23,208 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-03-19 01:07:23,209 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-03-19 01:07:23,210 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-03-19 01:07:23,212 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 01:07:23,219 - sqlalchemy.engine.Engine - INFO - SELECT student_departments.id AS student_departments_id, student_departments.name AS student_departments_name, student_departments.description AS student_departments_description, student_departments.mentor_id AS student_departments_mentor_id, student_departments.student_rep_id AS student_departments_student_rep_id, student_departments.assistant_rep_id AS student_departments_assistant_rep_id, student_departments.created_by AS student_departments_created_by, student_departments.last_modified_by AS student_departments_last_modified_by, student_departments.created_at AS student_departments_created_at, student_departments.last_modified_at AS student_departments_last_modified_at, student_departments.is_archived AS student_departments_is_archived, student_departments.archived_at AS student_departments_archived_at, student_departments.archive_reason AS student_departments_archive_reason, student_departments.archived_by AS student_departments_archived_by 
FROM student_departments 
WHERE student_departments.is_archived = false AND student_departments.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-03-19 01:07:23,220 - sqlalchemy.engine.Engine - INFO - [generated in 0.00130s] {'id_1': UUID('cdb909cf-4d27-4105-8f18-5b9a5f3b0070'), 'param_1': 1}
2025-03-19 01:07:23,235 - sqlalchemy.engine.Engine - INFO - UPDATE student_departments SET name=%(name)s, description=%(description)s, mentor_id=%(mentor_id)s::UUID, last_modified_at=now() WHERE student_departments.id = %(student_departments_id)s::UUID
2025-03-19 01:07:23,235 - sqlalchemy.engine.Engine - INFO - [generated in 0.00088s] {'name': 'Sciewd233Ence', 'description': 'Science Classes', 'mentor_id': UUID('c8d6098d-0483-472c-abff-68a478ff5d56'), 'student_departments_id': UUID('cdb909cf-4d27-4105-8f18-5b9a5f3b0070')}
2025-03-19 01:07:23,241 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-19 01:07:23,245 - kademia - ERROR - Unhandled exception | 1fa2d7bd-ed8e-4b85-8b28-3bb5fcad74d9 | 
Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 111, in receive
    return self.receive_nowait()
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 106, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 124, in receive
    return receiver.item
           ^^^^^^^^^^^^^
AttributeError: 'MemoryObjectItemReceiver' object has no attribute 'item'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 157, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 126, in receive
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\middleware\error_handler.py", line 81, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\fastapi\routing.py", line 214, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\to_thread.py", line 56, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2461, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 962, in run
    result = context.run(func, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\routers\student_organization\student_departments.py", line 44, in update_department
    return student_departments_crud.update_department(department_id, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\crud\student_organization\student_departments.py", line 63, in update_department
    updated_department = self.factory.update_student_department(department_id, data)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\core\factories\student_organization\department.py", line 126, in update_student_department
    raise RelationshipError(error=str(e), operation='update', entity='unknown')
app.core.errors.database_errors.RelationshipError
2025-03-19 01:07:23,255 - kademia - WARNING - RelationshipError | 1fa2d7bd-ed8e-4b85-8b28-3bb5fcad74d9 | Foreign key constraint violation during update operation. Detail: 
2025-03-19 01:08:17,623 - kademia - INFO - Application started
2025-03-19 01:08:17,624 - kademia - INFO - Application started
2025-03-19 01:08:25,776 - kademia - INFO - Application started
2025-03-19 01:08:25,807 - kademia - INFO - Application started
2025-03-19 01:08:31,968 - kademia - INFO - Request started | 0cfcacfd-46d7-4c52-aa93-6704683205e4 | GET /docs
2025-03-19 01:08:31,972 - kademia - INFO - Request completed | 0cfcacfd-46d7-4c52-aa93-6704683205e4 | Status: 200 | Time: 0.002s
2025-03-19 01:08:32,116 - kademia - INFO - Request started | b0bef809-63c7-4ec1-af7e-d4ea4ec05bde | GET /openapi.json
2025-03-19 01:08:32,348 - kademia - INFO - Request completed | b0bef809-63c7-4ec1-af7e-d4ea4ec05bde | Status: 200 | Time: 0.232s
2025-03-19 01:09:39,792 - kademia - INFO - Request started | ea57b32e-9f53-44aa-aceb-569572db2230 | PUT /api/v1/students/departments/cdb909cf-4d27-4105-8f18-5b9a5f3b0070
2025-03-19 01:09:40,153 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-03-19 01:09:40,153 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-03-19 01:09:40,155 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-03-19 01:09:40,156 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-03-19 01:09:40,157 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-03-19 01:09:40,158 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-03-19 01:09:40,159 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 01:09:40,167 - sqlalchemy.engine.Engine - INFO - SELECT student_departments.id AS student_departments_id, student_departments.name AS student_departments_name, student_departments.description AS student_departments_description, student_departments.mentor_id AS student_departments_mentor_id, student_departments.student_rep_id AS student_departments_student_rep_id, student_departments.assistant_rep_id AS student_departments_assistant_rep_id, student_departments.created_by AS student_departments_created_by, student_departments.last_modified_by AS student_departments_last_modified_by, student_departments.created_at AS student_departments_created_at, student_departments.last_modified_at AS student_departments_last_modified_at, student_departments.is_archived AS student_departments_is_archived, student_departments.archived_at AS student_departments_archived_at, student_departments.archive_reason AS student_departments_archive_reason, student_departments.archived_by AS student_departments_archived_by 
FROM student_departments 
WHERE student_departments.is_archived = false AND student_departments.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-03-19 01:09:40,168 - sqlalchemy.engine.Engine - INFO - [generated in 0.00116s] {'id_1': UUID('cdb909cf-4d27-4105-8f18-5b9a5f3b0070'), 'param_1': 1}
2025-03-19 01:09:40,177 - sqlalchemy.engine.Engine - INFO - UPDATE student_departments SET name=%(name)s, description=%(description)s, mentor_id=%(mentor_id)s::UUID, last_modified_at=now() WHERE student_departments.id = %(student_departments_id)s::UUID
2025-03-19 01:09:40,178 - sqlalchemy.engine.Engine - INFO - [generated in 0.00094s] {'name': 'Science', 'description': 'Science Classes', 'mentor_id': UUID('c8d6098d-0483-472c-abff-68a478ff5d56'), 'student_departments_id': UUID('cdb909cf-4d27-4105-8f18-5b9a5f3b0070')}
2025-03-19 01:09:40,182 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-19 01:09:40,184 - kademia - ERROR - Unhandled exception | ea57b32e-9f53-44aa-aceb-569572db2230 | Duplicate student department creation attempted: Unique constraint violation - Detail: (raised as a result of query-invoked autoflush; consider using a session.no_autoflush block if this flush is occurring prematurely)
(psycopg2.errors.uniqueviolation) duplicate key value violates unique constraint "student_departments_name_key"
detail:  key (name)=(science) already exists.

[sql: update student_departments set name=%(name)s, description=%(description)s, mentor_id=%(mentor_id)s::uuid, last_modified_at=now() where student_departments.id = %(student_departments_id)s::uuid]
[parameters: {'name': 'science', 'description': 'science classes', 'mentor_id': uuid('c8d6098d-0483-472c-abff-68a478ff5d56'), 'student_departments_id': uuid('cdb909cf-4d27-4105-8f18-5b9a5f3b0070')}]
(background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 111, in receive
    return self.receive_nowait()
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 106, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 124, in receive
    return receiver.item
           ^^^^^^^^^^^^^
AttributeError: 'MemoryObjectItemReceiver' object has no attribute 'item'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 157, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 126, in receive
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\middleware\error_handler.py", line 81, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\fastapi\routing.py", line 214, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\to_thread.py", line 56, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2461, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 962, in run
    result = context.run(func, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\routers\student_organization\student_departments.py", line 44, in update_department
    return student_departments_crud.update_department(department_id, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\crud\student_organization\student_departments.py", line 63, in update_department
    updated_department = self.factory.update_student_department(department_id, data)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\core\factories\student_organization\department.py", line 112, in update_student_department
    raise DuplicateStudentDepartmentError(
app.core.errors.student_organisation_errors.DuplicateStudentDepartmentError: Duplicate student department creation attempted: Unique constraint violation - Detail: (raised as a result of query-invoked autoflush; consider using a session.no_autoflush block if this flush is occurring prematurely)
(psycopg2.errors.uniqueviolation) duplicate key value violates unique constraint "student_departments_name_key"
detail:  key (name)=(science) already exists.

[sql: update student_departments set name=%(name)s, description=%(description)s, mentor_id=%(mentor_id)s::uuid, last_modified_at=now() where student_departments.id = %(student_departments_id)s::uuid]
[parameters: {'name': 'science', 'description': 'science classes', 'mentor_id': uuid('c8d6098d-0483-472c-abff-68a478ff5d56'), 'student_departments_id': uuid('cdb909cf-4d27-4105-8f18-5b9a5f3b0070')}]
(background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-19 01:09:40,198 - kademia - WARNING - UniqueViolationError | ea57b32e-9f53-44aa-aceb-569572db2230 | Duplicate student department creation attempted: Unique constraint violation - Detail: (raised as a result of query-invoked autoflush; consider using a session.no_autoflush block if this flush is occurring prematurely)
(psycopg2.errors.uniqueviolation) duplicate key value violates unique constraint "student_departments_name_key"
detail:  key (name)=(science) already exists.

[sql: update student_departments set name=%(name)s, description=%(description)s, mentor_id=%(mentor_id)s::uuid, last_modified_at=now() where student_departments.id = %(student_departments_id)s::uuid]
[parameters: {'name': 'science', 'description': 'science classes', 'mentor_id': uuid('c8d6098d-0483-472c-abff-68a478ff5d56'), 'student_departments_id': uuid('cdb909cf-4d27-4105-8f18-5b9a5f3b0070')}]
(background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-19 01:10:05,796 - kademia - INFO - Request started | 40af0570-e8f3-40aa-8d75-d42debc0824b | PUT /api/v1/students/departments/cdb909cf-4d27-4105-8f18-5b9a5f3b0070
2025-03-19 01:10:05,798 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 01:10:05,801 - sqlalchemy.engine.Engine - INFO - SELECT student_departments.id AS student_departments_id, student_departments.name AS student_departments_name, student_departments.description AS student_departments_description, student_departments.mentor_id AS student_departments_mentor_id, student_departments.student_rep_id AS student_departments_student_rep_id, student_departments.assistant_rep_id AS student_departments_assistant_rep_id, student_departments.created_by AS student_departments_created_by, student_departments.last_modified_by AS student_departments_last_modified_by, student_departments.created_at AS student_departments_created_at, student_departments.last_modified_at AS student_departments_last_modified_at, student_departments.is_archived AS student_departments_is_archived, student_departments.archived_at AS student_departments_archived_at, student_departments.archive_reason AS student_departments_archive_reason, student_departments.archived_by AS student_departments_archived_by 
FROM student_departments 
WHERE student_departments.is_archived = false AND student_departments.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-03-19 01:10:05,802 - sqlalchemy.engine.Engine - INFO - [cached since 25.63s ago] {'id_1': UUID('cdb909cf-4d27-4105-8f18-5b9a5f3b0070'), 'param_1': 1}
2025-03-19 01:10:05,806 - sqlalchemy.engine.Engine - INFO - UPDATE student_departments SET name=%(name)s, description=%(description)s, mentor_id=%(mentor_id)s::UUID, last_modified_at=now() WHERE student_departments.id = %(student_departments_id)s::UUID
2025-03-19 01:10:05,808 - sqlalchemy.engine.Engine - INFO - [cached since 25.63s ago] {'name': 'Scieeaergnce', 'description': 'Science Classes', 'mentor_id': UUID('c8d6098d-0483-472c-abff-68a478ff5d56'), 'student_departments_id': UUID('cdb909cf-4d27-4105-8f18-5b9a5f3b0070')}
2025-03-19 01:10:05,812 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-19 01:10:05,850 - kademia - ERROR - Unhandled exception | 40af0570-e8f3-40aa-8d75-d42debc0824b | Error during during fk insertion of Educator with id:c8d6098d-0483-472c-abff-68a478ff5d56 during update operation. Detail Foreign key constraint violation during create operation. Detail: (raised as a result of Query-invoked autoflush; consider using a session.no_autoflush block if this flush is occurring prematurely)
(psycopg2.errors.ForeignKeyViolation) insert or update on table "student_departments" violates foreign key constraint "fk_student_departments_educators_mentor_id"
DETAIL:  Key (mentor_id)=(c8d6098d-0483-472c-abff-68a478ff5d56) is not present in table "educators".

[SQL: UPDATE student_departments SET name=%(name)s, description=%(description)s, mentor_id=%(mentor_id)s::UUID, last_modified_at=now() WHERE student_departments.id = %(student_departments_id)s::UUID]
[parameters: {'name': 'Scieeaergnce', 'description': 'Science Classes', 'mentor_id': UUID('c8d6098d-0483-472c-abff-68a478ff5d56'), 'student_departments_id': UUID('cdb909cf-4d27-4105-8f18-5b9a5f3b0070')}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 111, in receive
    return self.receive_nowait()
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 106, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 124, in receive
    return receiver.item
           ^^^^^^^^^^^^^
AttributeError: 'MemoryObjectItemReceiver' object has no attribute 'item'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 157, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 126, in receive
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\middleware\error_handler.py", line 81, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\fastapi\routing.py", line 214, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\to_thread.py", line 56, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2461, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 962, in run
    result = context.run(func, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\routers\student_organization\student_departments.py", line 44, in update_department
    return student_departments_crud.update_department(department_id, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\crud\student_organization\student_departments.py", line 63, in update_department
    updated_department = self.factory.update_student_department(department_id, data)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\core\factories\student_organization\department.py", line 125, in update_student_department
    raise error_class(id=entity_id, detail=str(e), action='update')
app.core.errors.profile_errors.RelatedEducatorNotFoundError: Error during during fk insertion of Educator with id:c8d6098d-0483-472c-abff-68a478ff5d56 during update operation. Detail Foreign key constraint violation during create operation. Detail: (raised as a result of Query-invoked autoflush; consider using a session.no_autoflush block if this flush is occurring prematurely)
(psycopg2.errors.ForeignKeyViolation) insert or update on table "student_departments" violates foreign key constraint "fk_student_departments_educators_mentor_id"
DETAIL:  Key (mentor_id)=(c8d6098d-0483-472c-abff-68a478ff5d56) is not present in table "educators".

[SQL: UPDATE student_departments SET name=%(name)s, description=%(description)s, mentor_id=%(mentor_id)s::UUID, last_modified_at=now() WHERE student_departments.id = %(student_departments_id)s::UUID]
[parameters: {'name': 'Scieeaergnce', 'description': 'Science Classes', 'mentor_id': UUID('c8d6098d-0483-472c-abff-68a478ff5d56'), 'student_departments_id': UUID('cdb909cf-4d27-4105-8f18-5b9a5f3b0070')}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-19 01:10:05,887 - kademia - WARNING - RelationshipError | 40af0570-e8f3-40aa-8d75-d42debc0824b | Error during during fk insertion of Educator with id:c8d6098d-0483-472c-abff-68a478ff5d56 during update operation. Detail Foreign key constraint violation during create operation. Detail: (raised as a result of Query-invoked autoflush; consider using a session.no_autoflush block if this flush is occurring prematurely)
(psycopg2.errors.ForeignKeyViolation) insert or update on table "student_departments" violates foreign key constraint "fk_student_departments_educators_mentor_id"
DETAIL:  Key (mentor_id)=(c8d6098d-0483-472c-abff-68a478ff5d56) is not present in table "educators".

[SQL: UPDATE student_departments SET name=%(name)s, description=%(description)s, mentor_id=%(mentor_id)s::UUID, last_modified_at=now() WHERE student_departments.id = %(student_departments_id)s::UUID]
[parameters: {'name': 'Scieeaergnce', 'description': 'Science Classes', 'mentor_id': UUID('c8d6098d-0483-472c-abff-68a478ff5d56'), 'student_departments_id': UUID('cdb909cf-4d27-4105-8f18-5b9a5f3b0070')}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-19 01:13:58,053 - kademia - INFO - Application started
2025-03-19 01:13:58,057 - kademia - INFO - Application started
2025-03-19 01:16:19,622 - kademia - INFO - Request started | b3d84e29-0359-418d-997f-4343735ed462 | PUT /api/v1/students/departments/cdb909cf-4d27-4105-8f18-5b9a5f3b0070
2025-03-19 01:16:20,175 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-03-19 01:16:20,176 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-03-19 01:16:20,181 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-03-19 01:16:20,183 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-03-19 01:16:20,185 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-03-19 01:16:20,186 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-03-19 01:16:20,190 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 01:16:20,201 - sqlalchemy.engine.Engine - INFO - SELECT student_departments.id AS student_departments_id, student_departments.name AS student_departments_name, student_departments.description AS student_departments_description, student_departments.mentor_id AS student_departments_mentor_id, student_departments.student_rep_id AS student_departments_student_rep_id, student_departments.assistant_rep_id AS student_departments_assistant_rep_id, student_departments.created_by AS student_departments_created_by, student_departments.last_modified_by AS student_departments_last_modified_by, student_departments.created_at AS student_departments_created_at, student_departments.last_modified_at AS student_departments_last_modified_at, student_departments.is_archived AS student_departments_is_archived, student_departments.archived_at AS student_departments_archived_at, student_departments.archive_reason AS student_departments_archive_reason, student_departments.archived_by AS student_departments_archived_by 
FROM student_departments 
WHERE student_departments.is_archived = false AND student_departments.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-03-19 01:16:20,203 - sqlalchemy.engine.Engine - INFO - [generated in 0.00187s] {'id_1': UUID('cdb909cf-4d27-4105-8f18-5b9a5f3b0070'), 'param_1': 1}
2025-03-19 01:16:20,217 - sqlalchemy.engine.Engine - INFO - UPDATE student_departments SET name=%(name)s, description=%(description)s, student_rep_id=%(student_rep_id)s::UUID, last_modified_at=now() WHERE student_departments.id = %(student_departments_id)s::UUID
2025-03-19 01:16:20,218 - sqlalchemy.engine.Engine - INFO - [generated in 0.00115s] {'name': 'Scieeaergnce', 'description': 'Science Classes', 'student_rep_id': UUID('c8d6098d-0483-472c-abff-68a478ff5d56'), 'student_departments_id': UUID('cdb909cf-4d27-4105-8f18-5b9a5f3b0070')}
2025-03-19 01:16:20,239 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-19 01:16:20,243 - kademia - ERROR - Unhandled exception | b3d84e29-0359-418d-997f-4343735ed462 | Error during during fk insertion of Staff with id:c8d6098d-0483-472c-abff-68a478ff5d56 during update operation. Detail Foreign key constraint violation during create operation. Detail: (raised as a result of Query-invoked autoflush; consider using a session.no_autoflush block if this flush is occurring prematurely)
(psycopg2.errors.ForeignKeyViolation) insert or update on table "student_departments" violates foreign key constraint "fk_student_departments_students_student_rep"
DETAIL:  Key (student_rep_id)=(c8d6098d-0483-472c-abff-68a478ff5d56) is not present in table "students".

[SQL: UPDATE student_departments SET name=%(name)s, description=%(description)s, student_rep_id=%(student_rep_id)s::UUID, last_modified_at=now() WHERE student_departments.id = %(student_departments_id)s::UUID]
[parameters: {'name': 'Scieeaergnce', 'description': 'Science Classes', 'student_rep_id': UUID('c8d6098d-0483-472c-abff-68a478ff5d56'), 'student_departments_id': UUID('cdb909cf-4d27-4105-8f18-5b9a5f3b0070')}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 111, in receive
    return self.receive_nowait()
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 106, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 124, in receive
    return receiver.item
           ^^^^^^^^^^^^^
AttributeError: 'MemoryObjectItemReceiver' object has no attribute 'item'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 157, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 126, in receive
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\middleware\error_handler.py", line 81, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\fastapi\routing.py", line 214, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\to_thread.py", line 56, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2461, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 962, in run
    result = context.run(func, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\routers\student_organization\student_departments.py", line 44, in update_department
    return student_departments_crud.update_department(department_id, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\crud\student_organization\student_departments.py", line 63, in update_department
    updated_department = self.factory.update_student_department(department_id, data)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\core\factories\student_organization\department.py", line 125, in update_student_department
    raise error_class(id=entity_id, detail=str(e), action='update')
app.core.errors.profile_errors.RelatedStudentNotFoundError: Error during during fk insertion of Staff with id:c8d6098d-0483-472c-abff-68a478ff5d56 during update operation. Detail Foreign key constraint violation during create operation. Detail: (raised as a result of Query-invoked autoflush; consider using a session.no_autoflush block if this flush is occurring prematurely)
(psycopg2.errors.ForeignKeyViolation) insert or update on table "student_departments" violates foreign key constraint "fk_student_departments_students_student_rep"
DETAIL:  Key (student_rep_id)=(c8d6098d-0483-472c-abff-68a478ff5d56) is not present in table "students".

[SQL: UPDATE student_departments SET name=%(name)s, description=%(description)s, student_rep_id=%(student_rep_id)s::UUID, last_modified_at=now() WHERE student_departments.id = %(student_departments_id)s::UUID]
[parameters: {'name': 'Scieeaergnce', 'description': 'Science Classes', 'student_rep_id': UUID('c8d6098d-0483-472c-abff-68a478ff5d56'), 'student_departments_id': UUID('cdb909cf-4d27-4105-8f18-5b9a5f3b0070')}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-19 01:16:20,282 - kademia - WARNING - RelationshipError | b3d84e29-0359-418d-997f-4343735ed462 | Error during during fk insertion of Staff with id:c8d6098d-0483-472c-abff-68a478ff5d56 during update operation. Detail Foreign key constraint violation during create operation. Detail: (raised as a result of Query-invoked autoflush; consider using a session.no_autoflush block if this flush is occurring prematurely)
(psycopg2.errors.ForeignKeyViolation) insert or update on table "student_departments" violates foreign key constraint "fk_student_departments_students_student_rep"
DETAIL:  Key (student_rep_id)=(c8d6098d-0483-472c-abff-68a478ff5d56) is not present in table "students".

[SQL: UPDATE student_departments SET name=%(name)s, description=%(description)s, student_rep_id=%(student_rep_id)s::UUID, last_modified_at=now() WHERE student_departments.id = %(student_departments_id)s::UUID]
[parameters: {'name': 'Scieeaergnce', 'description': 'Science Classes', 'student_rep_id': UUID('c8d6098d-0483-472c-abff-68a478ff5d56'), 'student_departments_id': UUID('cdb909cf-4d27-4105-8f18-5b9a5f3b0070')}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-19 01:17:14,847 - kademia - INFO - Application started
2025-03-19 01:17:14,849 - kademia - INFO - Application started
2025-03-19 01:17:16,059 - kademia - INFO - Request started | 5e91ab33-ad4f-44d6-850d-6bc99aaa364c | GET /docs
2025-03-19 01:17:16,061 - kademia - INFO - Request completed | 5e91ab33-ad4f-44d6-850d-6bc99aaa364c | Status: 200 | Time: 0.000s
2025-03-19 01:17:16,253 - kademia - INFO - Request started | f89aafe4-3aec-4914-9129-6a75a0c734ad | GET /openapi.json
2025-03-19 01:17:16,558 - kademia - INFO - Request completed | f89aafe4-3aec-4914-9129-6a75a0c734ad | Status: 200 | Time: 0.304s
2025-03-19 01:18:13,270 - kademia - INFO - Request started | 93af3f8c-a301-4157-a5d2-0f8d745d4c78 | PUT /api/v1/students/departments/cdb909cf-4d27-4105-8f18-5b9a5f3b0070
2025-03-19 01:18:13,707 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-03-19 01:18:13,709 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-03-19 01:18:13,711 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-03-19 01:18:13,712 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-03-19 01:18:13,713 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-03-19 01:18:13,713 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-03-19 01:18:13,716 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 01:18:13,722 - sqlalchemy.engine.Engine - INFO - SELECT student_departments.id AS student_departments_id, student_departments.name AS student_departments_name, student_departments.description AS student_departments_description, student_departments.mentor_id AS student_departments_mentor_id, student_departments.student_rep_id AS student_departments_student_rep_id, student_departments.assistant_rep_id AS student_departments_assistant_rep_id, student_departments.created_by AS student_departments_created_by, student_departments.last_modified_by AS student_departments_last_modified_by, student_departments.created_at AS student_departments_created_at, student_departments.last_modified_at AS student_departments_last_modified_at, student_departments.is_archived AS student_departments_is_archived, student_departments.archived_at AS student_departments_archived_at, student_departments.archive_reason AS student_departments_archive_reason, student_departments.archived_by AS student_departments_archived_by 
FROM student_departments 
WHERE student_departments.is_archived = false AND student_departments.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-03-19 01:18:13,723 - sqlalchemy.engine.Engine - INFO - [generated in 0.00145s] {'id_1': UUID('cdb909cf-4d27-4105-8f18-5b9a5f3b0070'), 'param_1': 1}
2025-03-19 01:18:13,732 - sqlalchemy.engine.Engine - INFO - UPDATE student_departments SET name=%(name)s, description=%(description)s, student_rep_id=%(student_rep_id)s::UUID, last_modified_at=now() WHERE student_departments.id = %(student_departments_id)s::UUID
2025-03-19 01:18:13,733 - sqlalchemy.engine.Engine - INFO - [generated in 0.00094s] {'name': 'Scierthrthnce', 'description': 'Science Classes', 'student_rep_id': UUID('c8d6098d-0483-472c-abff-68a478ff5d56'), 'student_departments_id': UUID('cdb909cf-4d27-4105-8f18-5b9a5f3b0070')}
2025-03-19 01:18:13,744 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-19 01:18:13,746 - kademia - ERROR - Unhandled exception | 93af3f8c-a301-4157-a5d2-0f8d745d4c78 | Error during during fk insertion of student with id:c8d6098d-0483-472c-abff-68a478ff5d56 during update operation. Detail Foreign key constraint violation during create operation. Detail: (raised as a result of Query-invoked autoflush; consider using a session.no_autoflush block if this flush is occurring prematurely)
(psycopg2.errors.ForeignKeyViolation) insert or update on table "student_departments" violates foreign key constraint "fk_student_departments_students_student_rep"
DETAIL:  Key (student_rep_id)=(c8d6098d-0483-472c-abff-68a478ff5d56) is not present in table "students".

[SQL: UPDATE student_departments SET name=%(name)s, description=%(description)s, student_rep_id=%(student_rep_id)s::UUID, last_modified_at=now() WHERE student_departments.id = %(student_departments_id)s::UUID]
[parameters: {'name': 'Scierthrthnce', 'description': 'Science Classes', 'student_rep_id': UUID('c8d6098d-0483-472c-abff-68a478ff5d56'), 'student_departments_id': UUID('cdb909cf-4d27-4105-8f18-5b9a5f3b0070')}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 111, in receive
    return self.receive_nowait()
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 106, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 124, in receive
    return receiver.item
           ^^^^^^^^^^^^^
AttributeError: 'MemoryObjectItemReceiver' object has no attribute 'item'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 157, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 126, in receive
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\middleware\error_handler.py", line 81, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\fastapi\routing.py", line 214, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\to_thread.py", line 56, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2461, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 962, in run
    result = context.run(func, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\routers\student_organization\student_departments.py", line 44, in update_department
    return student_departments_crud.update_department(department_id, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\crud\student_organization\student_departments.py", line 63, in update_department
    updated_department = self.factory.update_student_department(department_id, data)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\core\factories\student_organization\department.py", line 125, in update_student_department
    raise error_class(id=entity_id, detail=str(e), action='update')
app.core.errors.profile_errors.RelatedStudentNotFoundError: Error during during fk insertion of student with id:c8d6098d-0483-472c-abff-68a478ff5d56 during update operation. Detail Foreign key constraint violation during create operation. Detail: (raised as a result of Query-invoked autoflush; consider using a session.no_autoflush block if this flush is occurring prematurely)
(psycopg2.errors.ForeignKeyViolation) insert or update on table "student_departments" violates foreign key constraint "fk_student_departments_students_student_rep"
DETAIL:  Key (student_rep_id)=(c8d6098d-0483-472c-abff-68a478ff5d56) is not present in table "students".

[SQL: UPDATE student_departments SET name=%(name)s, description=%(description)s, student_rep_id=%(student_rep_id)s::UUID, last_modified_at=now() WHERE student_departments.id = %(student_departments_id)s::UUID]
[parameters: {'name': 'Scierthrthnce', 'description': 'Science Classes', 'student_rep_id': UUID('c8d6098d-0483-472c-abff-68a478ff5d56'), 'student_departments_id': UUID('cdb909cf-4d27-4105-8f18-5b9a5f3b0070')}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-19 01:18:13,759 - kademia - WARNING - RelationshipError | 93af3f8c-a301-4157-a5d2-0f8d745d4c78 | Error during during fk insertion of student with id:c8d6098d-0483-472c-abff-68a478ff5d56 during update operation. Detail Foreign key constraint violation during create operation. Detail: (raised as a result of Query-invoked autoflush; consider using a session.no_autoflush block if this flush is occurring prematurely)
(psycopg2.errors.ForeignKeyViolation) insert or update on table "student_departments" violates foreign key constraint "fk_student_departments_students_student_rep"
DETAIL:  Key (student_rep_id)=(c8d6098d-0483-472c-abff-68a478ff5d56) is not present in table "students".

[SQL: UPDATE student_departments SET name=%(name)s, description=%(description)s, student_rep_id=%(student_rep_id)s::UUID, last_modified_at=now() WHERE student_departments.id = %(student_departments_id)s::UUID]
[parameters: {'name': 'Scierthrthnce', 'description': 'Science Classes', 'student_rep_id': UUID('c8d6098d-0483-472c-abff-68a478ff5d56'), 'student_departments_id': UUID('cdb909cf-4d27-4105-8f18-5b9a5f3b0070')}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-19 01:18:32,610 - kademia - INFO - Request started | 13bef349-efc0-4286-85fa-8094b0976c50 | PUT /api/v1/students/departments/cdb909cf-4d27-4105-8f18-5b9a5f3b0070
2025-03-19 01:18:32,615 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 01:18:32,619 - sqlalchemy.engine.Engine - INFO - SELECT student_departments.id AS student_departments_id, student_departments.name AS student_departments_name, student_departments.description AS student_departments_description, student_departments.mentor_id AS student_departments_mentor_id, student_departments.student_rep_id AS student_departments_student_rep_id, student_departments.assistant_rep_id AS student_departments_assistant_rep_id, student_departments.created_by AS student_departments_created_by, student_departments.last_modified_by AS student_departments_last_modified_by, student_departments.created_at AS student_departments_created_at, student_departments.last_modified_at AS student_departments_last_modified_at, student_departments.is_archived AS student_departments_is_archived, student_departments.archived_at AS student_departments_archived_at, student_departments.archive_reason AS student_departments_archive_reason, student_departments.archived_by AS student_departments_archived_by 
FROM student_departments 
WHERE student_departments.is_archived = false AND student_departments.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-03-19 01:18:32,620 - sqlalchemy.engine.Engine - INFO - [cached since 18.9s ago] {'id_1': UUID('cdb909cf-4d27-4105-8f18-5b9a5f3b0070'), 'param_1': 1}
2025-03-19 01:18:32,626 - sqlalchemy.engine.Engine - INFO - UPDATE student_departments SET name=%(name)s, description=%(description)s, assistant_rep_id=%(assistant_rep_id)s::UUID, last_modified_at=now() WHERE student_departments.id = %(student_departments_id)s::UUID
2025-03-19 01:18:32,627 - sqlalchemy.engine.Engine - INFO - [generated in 0.00106s] {'name': 'Scierthrthnce', 'description': 'Science Classes', 'assistant_rep_id': UUID('c8d6098d-0483-472c-abff-68a478ff5d56'), 'student_departments_id': UUID('cdb909cf-4d27-4105-8f18-5b9a5f3b0070')}
2025-03-19 01:18:32,630 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-19 01:18:32,634 - kademia - ERROR - Unhandled exception | 13bef349-efc0-4286-85fa-8094b0976c50 | Error during during fk insertion of student with id:c8d6098d-0483-472c-abff-68a478ff5d56 during update operation. Detail Foreign key constraint violation during create operation. Detail: (raised as a result of Query-invoked autoflush; consider using a session.no_autoflush block if this flush is occurring prematurely)
(psycopg2.errors.ForeignKeyViolation) insert or update on table "student_departments" violates foreign key constraint "fk_student_departments_students_assistant_rep"
DETAIL:  Key (assistant_rep_id)=(c8d6098d-0483-472c-abff-68a478ff5d56) is not present in table "students".

[SQL: UPDATE student_departments SET name=%(name)s, description=%(description)s, assistant_rep_id=%(assistant_rep_id)s::UUID, last_modified_at=now() WHERE student_departments.id = %(student_departments_id)s::UUID]
[parameters: {'name': 'Scierthrthnce', 'description': 'Science Classes', 'assistant_rep_id': UUID('c8d6098d-0483-472c-abff-68a478ff5d56'), 'student_departments_id': UUID('cdb909cf-4d27-4105-8f18-5b9a5f3b0070')}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 111, in receive
    return self.receive_nowait()
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 106, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 124, in receive
    return receiver.item
           ^^^^^^^^^^^^^
AttributeError: 'MemoryObjectItemReceiver' object has no attribute 'item'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 157, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 126, in receive
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\middleware\error_handler.py", line 81, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\fastapi\routing.py", line 214, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\to_thread.py", line 56, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2461, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 962, in run
    result = context.run(func, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\routers\student_organization\student_departments.py", line 44, in update_department
    return student_departments_crud.update_department(department_id, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\crud\student_organization\student_departments.py", line 63, in update_department
    updated_department = self.factory.update_student_department(department_id, data)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\core\factories\student_organization\department.py", line 125, in update_student_department
    raise error_class(id=entity_id, detail=str(e), action='update')
app.core.errors.profile_errors.RelatedStudentNotFoundError: Error during during fk insertion of student with id:c8d6098d-0483-472c-abff-68a478ff5d56 during update operation. Detail Foreign key constraint violation during create operation. Detail: (raised as a result of Query-invoked autoflush; consider using a session.no_autoflush block if this flush is occurring prematurely)
(psycopg2.errors.ForeignKeyViolation) insert or update on table "student_departments" violates foreign key constraint "fk_student_departments_students_assistant_rep"
DETAIL:  Key (assistant_rep_id)=(c8d6098d-0483-472c-abff-68a478ff5d56) is not present in table "students".

[SQL: UPDATE student_departments SET name=%(name)s, description=%(description)s, assistant_rep_id=%(assistant_rep_id)s::UUID, last_modified_at=now() WHERE student_departments.id = %(student_departments_id)s::UUID]
[parameters: {'name': 'Scierthrthnce', 'description': 'Science Classes', 'assistant_rep_id': UUID('c8d6098d-0483-472c-abff-68a478ff5d56'), 'student_departments_id': UUID('cdb909cf-4d27-4105-8f18-5b9a5f3b0070')}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-19 01:18:32,693 - kademia - WARNING - RelationshipError | 13bef349-efc0-4286-85fa-8094b0976c50 | Error during during fk insertion of student with id:c8d6098d-0483-472c-abff-68a478ff5d56 during update operation. Detail Foreign key constraint violation during create operation. Detail: (raised as a result of Query-invoked autoflush; consider using a session.no_autoflush block if this flush is occurring prematurely)
(psycopg2.errors.ForeignKeyViolation) insert or update on table "student_departments" violates foreign key constraint "fk_student_departments_students_assistant_rep"
DETAIL:  Key (assistant_rep_id)=(c8d6098d-0483-472c-abff-68a478ff5d56) is not present in table "students".

[SQL: UPDATE student_departments SET name=%(name)s, description=%(description)s, assistant_rep_id=%(assistant_rep_id)s::UUID, last_modified_at=now() WHERE student_departments.id = %(student_departments_id)s::UUID]
[parameters: {'name': 'Scierthrthnce', 'description': 'Science Classes', 'assistant_rep_id': UUID('c8d6098d-0483-472c-abff-68a478ff5d56'), 'student_departments_id': UUID('cdb909cf-4d27-4105-8f18-5b9a5f3b0070')}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-19 01:21:01,230 - kademia - INFO - Request started | 80e00e0b-6f78-4166-a855-bcbf4e30ab47 | PATCH /api/v1/students/departments/cdb909cf-4d27-4105-8f18-5b9a5f3b0070
2025-03-19 01:21:01,237 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 01:21:01,238 - sqlalchemy.engine.Engine - INFO - SELECT student_departments.id AS student_departments_id, student_departments.name AS student_departments_name, student_departments.description AS student_departments_description, student_departments.mentor_id AS student_departments_mentor_id, student_departments.student_rep_id AS student_departments_student_rep_id, student_departments.assistant_rep_id AS student_departments_assistant_rep_id, student_departments.created_by AS student_departments_created_by, student_departments.last_modified_by AS student_departments_last_modified_by, student_departments.created_at AS student_departments_created_at, student_departments.last_modified_at AS student_departments_last_modified_at, student_departments.is_archived AS student_departments_is_archived, student_departments.archived_at AS student_departments_archived_at, student_departments.archive_reason AS student_departments_archive_reason, student_departments.archived_by AS student_departments_archived_by 
FROM student_departments 
WHERE student_departments.is_archived = false AND student_departments.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-03-19 01:21:01,239 - sqlalchemy.engine.Engine - INFO - [cached since 167.5s ago] {'id_1': UUID('cdb909cf-4d27-4105-8f18-5b9a5f3b0070'), 'param_1': 1}
2025-03-19 01:21:01,244 - sqlalchemy.engine.Engine - INFO - UPDATE student_departments SET last_modified_at=now(), is_archived=%(is_archived)s, archived_at=%(archived_at)s, archive_reason=%(archive_reason)s, archived_by=%(archived_by)s::UUID WHERE student_departments.id = %(student_departments_id)s::UUID
2025-03-19 01:21:01,245 - sqlalchemy.engine.Engine - INFO - [generated in 0.00138s] {'is_archived': True, 'archived_at': datetime.datetime(2025, 3, 19, 1, 21, 1, 242743, tzinfo=datetime.timezone.utc), 'archive_reason': 'ERROR', 'archived_by': UUID('00000000-0000-0000-0000-000000000000'), 'student_departments_id': UUID('cdb909cf-4d27-4105-8f18-5b9a5f3b0070')}
2025-03-19 01:21:01,265 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-19 01:21:01,271 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 01:21:01,275 - sqlalchemy.engine.Engine - INFO - SELECT student_departments.id, student_departments.name, student_departments.description, student_departments.mentor_id, student_departments.student_rep_id, student_departments.assistant_rep_id, student_departments.created_by, student_departments.last_modified_by, student_departments.created_at, student_departments.last_modified_at, student_departments.is_archived, student_departments.archived_at, student_departments.archive_reason, student_departments.archived_by 
FROM student_departments 
WHERE student_departments.id = %(pk_1)s::UUID
2025-03-19 01:21:01,276 - sqlalchemy.engine.Engine - INFO - [generated in 0.00132s] {'pk_1': UUID('cdb909cf-4d27-4105-8f18-5b9a5f3b0070')}
2025-03-19 01:21:01,284 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-19 01:21:01,285 - kademia - INFO - Request completed | 80e00e0b-6f78-4166-a855-bcbf4e30ab47 | Status: 204 | Time: 0.054s
2025-03-19 01:21:26,421 - kademia - INFO - Request started | 3db51239-e257-4cef-a08d-db16ee71d050 | GET /api/v1/students/departments/
2025-03-19 01:21:26,425 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 01:21:26,427 - sqlalchemy.engine.Engine - INFO - SELECT student_departments.id AS student_departments_id, student_departments.name AS student_departments_name, student_departments.description AS student_departments_description, student_departments.mentor_id AS student_departments_mentor_id, student_departments.student_rep_id AS student_departments_student_rep_id, student_departments.assistant_rep_id AS student_departments_assistant_rep_id, student_departments.created_by AS student_departments_created_by, student_departments.last_modified_by AS student_departments_last_modified_by, student_departments.created_at AS student_departments_created_at, student_departments.last_modified_at AS student_departments_last_modified_at, student_departments.is_archived AS student_departments_is_archived, student_departments.archived_at AS student_departments_archived_at, student_departments.archive_reason AS student_departments_archive_reason, student_departments.archived_by AS student_departments_archived_by 
FROM student_departments 
WHERE student_departments.is_archived = false ORDER BY student_departments.name DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
2025-03-19 01:21:26,428 - sqlalchemy.engine.Engine - INFO - [generated in 0.00132s] {'param_1': 50, 'param_2': 0}
2025-03-19 01:21:26,433 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-19 01:21:26,436 - kademia - INFO - Request completed | 3db51239-e257-4cef-a08d-db16ee71d050 | Status: 200 | Time: 0.014s
2025-03-19 01:22:23,579 - kademia - INFO - Request started | 0f5180b1-2524-4d99-b511-af8219ce5feb | GET /api/v1/students/departments/cdb909cf-4d27-4105-8f18-5b9a5f3b0070
2025-03-19 01:22:23,581 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 01:22:23,583 - sqlalchemy.engine.Engine - INFO - SELECT student_departments.id AS student_departments_id, student_departments.name AS student_departments_name, student_departments.description AS student_departments_description, student_departments.mentor_id AS student_departments_mentor_id, student_departments.student_rep_id AS student_departments_student_rep_id, student_departments.assistant_rep_id AS student_departments_assistant_rep_id, student_departments.created_by AS student_departments_created_by, student_departments.last_modified_by AS student_departments_last_modified_by, student_departments.created_at AS student_departments_created_at, student_departments.last_modified_at AS student_departments_last_modified_at, student_departments.is_archived AS student_departments_is_archived, student_departments.archived_at AS student_departments_archived_at, student_departments.archive_reason AS student_departments_archive_reason, student_departments.archived_by AS student_departments_archived_by 
FROM student_departments 
WHERE student_departments.is_archived = false AND student_departments.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-03-19 01:22:23,583 - sqlalchemy.engine.Engine - INFO - [cached since 249.9s ago] {'id_1': UUID('cdb909cf-4d27-4105-8f18-5b9a5f3b0070'), 'param_1': 1}
2025-03-19 01:22:23,585 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-19 01:22:23,587 - kademia - ERROR - Unhandled exception | 0f5180b1-2524-4d99-b511-af8219ce5feb | Department with id:cdb909cf-4d27-4105-8f18-5b9a5f3b0070 not found. DETAIL: StudentDepartments not with id cdb909cf-4d27-4105-8f18-5b9a5f3b0070 not found. DETAIL: Record not found
Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 111, in receive
    return self.receive_nowait()
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 106, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 124, in receive
    return receiver.item
           ^^^^^^^^^^^^^
AttributeError: 'MemoryObjectItemReceiver' object has no attribute 'item'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 157, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 126, in receive
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\middleware\error_handler.py", line 81, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\fastapi\routing.py", line 214, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\to_thread.py", line 56, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2461, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 962, in run
    result = context.run(func, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\routers\student_organization\student_departments.py", line 36, in get_department
    return student_departments_crud.get_department(department_id)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\crud\student_organization\student_departments.py", line 41, in get_department
    department = self.factory.get_student_department(department_id)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\core\factories\student_organization\department.py", line 77, in get_student_department
    raise StudentDepartmentNotFoundError(id=department_id, detail=str(e))
app.core.errors.student_organisation_errors.StudentDepartmentNotFoundError: Department with id:cdb909cf-4d27-4105-8f18-5b9a5f3b0070 not found. DETAIL: StudentDepartments not with id cdb909cf-4d27-4105-8f18-5b9a5f3b0070 not found. DETAIL: Record not found
2025-03-19 01:22:23,590 - kademia - WARNING - EntityNotFoundError | 0f5180b1-2524-4d99-b511-af8219ce5feb | Department with id:cdb909cf-4d27-4105-8f18-5b9a5f3b0070 not found. DETAIL: StudentDepartments not with id cdb909cf-4d27-4105-8f18-5b9a5f3b0070 not found. DETAIL: Record not found
2025-03-19 01:22:38,232 - kademia - INFO - Request started | 357eb07b-80f7-433b-b55f-0a4ce1e4e0ad | PUT /api/v1/students/departments/cdb909cf-4d27-4105-8f18-5b9a5f3b0070
2025-03-19 01:22:38,234 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 01:22:38,235 - sqlalchemy.engine.Engine - INFO - SELECT student_departments.id AS student_departments_id, student_departments.name AS student_departments_name, student_departments.description AS student_departments_description, student_departments.mentor_id AS student_departments_mentor_id, student_departments.student_rep_id AS student_departments_student_rep_id, student_departments.assistant_rep_id AS student_departments_assistant_rep_id, student_departments.created_by AS student_departments_created_by, student_departments.last_modified_by AS student_departments_last_modified_by, student_departments.created_at AS student_departments_created_at, student_departments.last_modified_at AS student_departments_last_modified_at, student_departments.is_archived AS student_departments_is_archived, student_departments.archived_at AS student_departments_archived_at, student_departments.archive_reason AS student_departments_archive_reason, student_departments.archived_by AS student_departments_archived_by 
FROM student_departments 
WHERE student_departments.is_archived = false AND student_departments.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-03-19 01:22:38,235 - sqlalchemy.engine.Engine - INFO - [cached since 264.5s ago] {'id_1': UUID('cdb909cf-4d27-4105-8f18-5b9a5f3b0070'), 'param_1': 1}
2025-03-19 01:22:38,237 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-19 01:22:38,238 - kademia - ERROR - Unhandled exception | 357eb07b-80f7-433b-b55f-0a4ce1e4e0ad | Department with id:cdb909cf-4d27-4105-8f18-5b9a5f3b0070 not found. DETAIL: Department with id:cdb909cf-4d27-4105-8f18-5b9a5f3b0070 not found. DETAIL: StudentDepartments not with id cdb909cf-4d27-4105-8f18-5b9a5f3b0070 not found. DETAIL: Record not found
Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 111, in receive
    return self.receive_nowait()
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 106, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 124, in receive
    return receiver.item
           ^^^^^^^^^^^^^
AttributeError: 'MemoryObjectItemReceiver' object has no attribute 'item'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 157, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 126, in receive
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\middleware\error_handler.py", line 81, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\fastapi\routing.py", line 214, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\to_thread.py", line 56, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2461, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 962, in run
    result = context.run(func, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\routers\student_organization\student_departments.py", line 44, in update_department
    return student_departments_crud.update_department(department_id, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\crud\student_organization\student_departments.py", line 63, in update_department
    updated_department = self.factory.update_student_department(department_id, data)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\core\factories\student_organization\department.py", line 110, in update_student_department
    raise StudentDepartmentNotFoundError(id=department_id, detail=str(e))
app.core.errors.student_organisation_errors.StudentDepartmentNotFoundError: Department with id:cdb909cf-4d27-4105-8f18-5b9a5f3b0070 not found. DETAIL: Department with id:cdb909cf-4d27-4105-8f18-5b9a5f3b0070 not found. DETAIL: StudentDepartments not with id cdb909cf-4d27-4105-8f18-5b9a5f3b0070 not found. DETAIL: Record not found
2025-03-19 01:22:38,243 - kademia - WARNING - EntityNotFoundError | 357eb07b-80f7-433b-b55f-0a4ce1e4e0ad | Department with id:cdb909cf-4d27-4105-8f18-5b9a5f3b0070 not found. DETAIL: Department with id:cdb909cf-4d27-4105-8f18-5b9a5f3b0070 not found. DETAIL: StudentDepartments not with id cdb909cf-4d27-4105-8f18-5b9a5f3b0070 not found. DETAIL: Record not found
2025-03-19 01:22:53,532 - kademia - INFO - Request started | b8d4278f-49d8-4cdf-a9bd-1ff68baf212c | PATCH /api/v1/students/departments/cdb909cf-4d27-4105-8f18-5b9a5f3b0070
2025-03-19 01:22:53,535 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 01:22:53,536 - sqlalchemy.engine.Engine - INFO - SELECT student_departments.id AS student_departments_id, student_departments.name AS student_departments_name, student_departments.description AS student_departments_description, student_departments.mentor_id AS student_departments_mentor_id, student_departments.student_rep_id AS student_departments_student_rep_id, student_departments.assistant_rep_id AS student_departments_assistant_rep_id, student_departments.created_by AS student_departments_created_by, student_departments.last_modified_by AS student_departments_last_modified_by, student_departments.created_at AS student_departments_created_at, student_departments.last_modified_at AS student_departments_last_modified_at, student_departments.is_archived AS student_departments_is_archived, student_departments.archived_at AS student_departments_archived_at, student_departments.archive_reason AS student_departments_archive_reason, student_departments.archived_by AS student_departments_archived_by 
FROM student_departments 
WHERE student_departments.is_archived = false AND student_departments.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-03-19 01:22:53,537 - sqlalchemy.engine.Engine - INFO - [cached since 279.8s ago] {'id_1': UUID('cdb909cf-4d27-4105-8f18-5b9a5f3b0070'), 'param_1': 1}
2025-03-19 01:22:53,539 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-19 01:22:53,541 - kademia - ERROR - Unhandled exception | b8d4278f-49d8-4cdf-a9bd-1ff68baf212c | Department with id:cdb909cf-4d27-4105-8f18-5b9a5f3b0070 not found. DETAIL: StudentDepartments not with id cdb909cf-4d27-4105-8f18-5b9a5f3b0070 not found. DETAIL: object not found
Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 111, in receive
    return self.receive_nowait()
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 106, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 124, in receive
    return receiver.item
           ^^^^^^^^^^^^^
AttributeError: 'MemoryObjectItemReceiver' object has no attribute 'item'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 157, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 126, in receive
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\middleware\error_handler.py", line 81, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\fastapi\routing.py", line 214, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\to_thread.py", line 56, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2461, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 962, in run
    result = context.run(func, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\routers\student_organization\student_departments.py", line 51, in archive_department
    return student_departments_crud.archive_department(department_id, reason.reason)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\crud\student_organization\student_departments.py", line 74, in archive_department
    self.factory.archive_department(department_id, reason)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\core\factories\student_organization\department.py", line 140, in archive_department
    raise StudentDepartmentNotFoundError(id=department_id, detail=str(e))
app.core.errors.student_organisation_errors.StudentDepartmentNotFoundError: Department with id:cdb909cf-4d27-4105-8f18-5b9a5f3b0070 not found. DETAIL: StudentDepartments not with id cdb909cf-4d27-4105-8f18-5b9a5f3b0070 not found. DETAIL: object not found
2025-03-19 01:22:53,546 - kademia - WARNING - EntityNotFoundError | b8d4278f-49d8-4cdf-a9bd-1ff68baf212c | Department with id:cdb909cf-4d27-4105-8f18-5b9a5f3b0070 not found. DETAIL: StudentDepartments not with id cdb909cf-4d27-4105-8f18-5b9a5f3b0070 not found. DETAIL: object not found
2025-03-19 01:23:03,062 - kademia - INFO - Request started | 316b3308-b642-45b6-990f-194fdb455db3 | DELETE /api/v1/students/departments/cdb909cf-4d27-4105-8f18-5b9a5f3b0070
2025-03-19 01:23:03,065 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 01:23:03,065 - sqlalchemy.engine.Engine - INFO - SELECT student_departments.id AS student_departments_id, student_departments.name AS student_departments_name, student_departments.description AS student_departments_description, student_departments.mentor_id AS student_departments_mentor_id, student_departments.student_rep_id AS student_departments_student_rep_id, student_departments.assistant_rep_id AS student_departments_assistant_rep_id, student_departments.created_by AS student_departments_created_by, student_departments.last_modified_by AS student_departments_last_modified_by, student_departments.created_at AS student_departments_created_at, student_departments.last_modified_at AS student_departments_last_modified_at, student_departments.is_archived AS student_departments_is_archived, student_departments.archived_at AS student_departments_archived_at, student_departments.archive_reason AS student_departments_archive_reason, student_departments.archived_by AS student_departments_archived_by 
FROM student_departments 
WHERE student_departments.is_archived = false AND student_departments.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-03-19 01:23:03,066 - sqlalchemy.engine.Engine - INFO - [cached since 289.3s ago] {'id_1': UUID('cdb909cf-4d27-4105-8f18-5b9a5f3b0070'), 'param_1': 1}
2025-03-19 01:23:03,068 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-19 01:23:03,070 - kademia - ERROR - Unhandled exception | 316b3308-b642-45b6-990f-194fdb455db3 | Department with id:cdb909cf-4d27-4105-8f18-5b9a5f3b0070 not found. DETAIL: StudentDepartments not with id cdb909cf-4d27-4105-8f18-5b9a5f3b0070 not found. DETAIL: object not found
Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 111, in receive
    return self.receive_nowait()
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 106, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 124, in receive
    return receiver.item
           ^^^^^^^^^^^^^
AttributeError: 'MemoryObjectItemReceiver' object has no attribute 'item'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 157, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 126, in receive
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\middleware\error_handler.py", line 81, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\fastapi\routing.py", line 214, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\to_thread.py", line 56, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2461, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 962, in run
    result = context.run(func, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\routers\student_organization\student_departments.py", line 57, in delete_department
    return student_departments_crud.delete_department(department_id)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\crud\student_organization\student_departments.py", line 82, in delete_department
    self.factory.delete_department(department_id)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\core\factories\student_organization\department.py", line 150, in delete_department
    raise StudentDepartmentNotFoundError(id=department_id, detail=str(e))
app.core.errors.student_organisation_errors.StudentDepartmentNotFoundError: Department with id:cdb909cf-4d27-4105-8f18-5b9a5f3b0070 not found. DETAIL: StudentDepartments not with id cdb909cf-4d27-4105-8f18-5b9a5f3b0070 not found. DETAIL: object not found
2025-03-19 01:23:03,076 - kademia - WARNING - EntityNotFoundError | 316b3308-b642-45b6-990f-194fdb455db3 | Department with id:cdb909cf-4d27-4105-8f18-5b9a5f3b0070 not found. DETAIL: StudentDepartments not with id cdb909cf-4d27-4105-8f18-5b9a5f3b0070 not found. DETAIL: object not found
2025-03-19 01:23:12,120 - kademia - INFO - Request started | d3ef5efd-0bd0-466a-8f0c-893d9e6dfcd2 | GET /api/v1/archive/students/departments/
2025-03-19 01:23:12,122 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 01:23:12,124 - sqlalchemy.engine.Engine - INFO - SELECT student_departments.id AS student_departments_id, student_departments.name AS student_departments_name, student_departments.description AS student_departments_description, student_departments.mentor_id AS student_departments_mentor_id, student_departments.student_rep_id AS student_departments_student_rep_id, student_departments.assistant_rep_id AS student_departments_assistant_rep_id, student_departments.created_by AS student_departments_created_by, student_departments.last_modified_by AS student_departments_last_modified_by, student_departments.created_at AS student_departments_created_at, student_departments.last_modified_at AS student_departments_last_modified_at, student_departments.is_archived AS student_departments_is_archived, student_departments.archived_at AS student_departments_archived_at, student_departments.archive_reason AS student_departments_archive_reason, student_departments.archived_by AS student_departments_archived_by 
FROM student_departments 
WHERE student_departments.is_archived = true ORDER BY student_departments.name DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
2025-03-19 01:23:12,125 - sqlalchemy.engine.Engine - INFO - [generated in 0.00081s] {'param_1': 50, 'param_2': 0}
2025-03-19 01:23:12,127 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-19 01:23:12,129 - kademia - INFO - Request completed | d3ef5efd-0bd0-466a-8f0c-893d9e6dfcd2 | Status: 200 | Time: 0.009s
2025-03-19 01:23:22,430 - kademia - INFO - Request started | a95f5df3-511f-43ba-a31c-8f6a81fd0c9b | GET /api/v1/archive/students/departments/cdb909cf-4d27-4105-8f18-5b9a5f3b0070
2025-03-19 01:23:22,431 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 01:23:22,433 - sqlalchemy.engine.Engine - INFO - SELECT student_departments.id AS student_departments_id, student_departments.name AS student_departments_name, student_departments.description AS student_departments_description, student_departments.mentor_id AS student_departments_mentor_id, student_departments.student_rep_id AS student_departments_student_rep_id, student_departments.assistant_rep_id AS student_departments_assistant_rep_id, student_departments.created_by AS student_departments_created_by, student_departments.last_modified_by AS student_departments_last_modified_by, student_departments.created_at AS student_departments_created_at, student_departments.last_modified_at AS student_departments_last_modified_at, student_departments.is_archived AS student_departments_is_archived, student_departments.archived_at AS student_departments_archived_at, student_departments.archive_reason AS student_departments_archive_reason, student_departments.archived_by AS student_departments_archived_by 
FROM student_departments 
WHERE student_departments.is_archived = true AND student_departments.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-03-19 01:23:22,433 - sqlalchemy.engine.Engine - INFO - [generated in 0.00079s] {'id_1': UUID('cdb909cf-4d27-4105-8f18-5b9a5f3b0070'), 'param_1': 1}
2025-03-19 01:23:22,436 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-19 01:23:22,436 - kademia - INFO - Request completed | a95f5df3-511f-43ba-a31c-8f6a81fd0c9b | Status: 200 | Time: 0.006s
2025-03-19 01:23:31,729 - kademia - INFO - Request started | 03720a11-d55e-4e9f-9f97-e36d9e98656a | PATCH /api/v1/archive/students/departments/cdb909cf-4d27-4105-8f18-5b9a5f3b0070
2025-03-19 01:23:31,731 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 01:23:31,731 - sqlalchemy.engine.Engine - INFO - SELECT student_departments.id AS student_departments_id, student_departments.name AS student_departments_name, student_departments.description AS student_departments_description, student_departments.mentor_id AS student_departments_mentor_id, student_departments.student_rep_id AS student_departments_student_rep_id, student_departments.assistant_rep_id AS student_departments_assistant_rep_id, student_departments.created_by AS student_departments_created_by, student_departments.last_modified_by AS student_departments_last_modified_by, student_departments.created_at AS student_departments_created_at, student_departments.last_modified_at AS student_departments_last_modified_at, student_departments.is_archived AS student_departments_is_archived, student_departments.archived_at AS student_departments_archived_at, student_departments.archive_reason AS student_departments_archive_reason, student_departments.archived_by AS student_departments_archived_by 
FROM student_departments 
WHERE student_departments.is_archived = true AND student_departments.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-03-19 01:23:31,732 - sqlalchemy.engine.Engine - INFO - [cached since 9.299s ago] {'id_1': UUID('cdb909cf-4d27-4105-8f18-5b9a5f3b0070'), 'param_1': 1}
2025-03-19 01:23:31,734 - sqlalchemy.engine.Engine - INFO - SELECT student_departments.id AS student_departments_id, student_departments.name AS student_departments_name, student_departments.description AS student_departments_description, student_departments.mentor_id AS student_departments_mentor_id, student_departments.student_rep_id AS student_departments_student_rep_id, student_departments.assistant_rep_id AS student_departments_assistant_rep_id, student_departments.created_by AS student_departments_created_by, student_departments.last_modified_by AS student_departments_last_modified_by, student_departments.created_at AS student_departments_created_at, student_departments.last_modified_at AS student_departments_last_modified_at, student_departments.is_archived AS student_departments_is_archived, student_departments.archived_at AS student_departments_archived_at, student_departments.archive_reason AS student_departments_archive_reason, student_departments.archived_by AS student_departments_archived_by 
FROM student_departments 
WHERE student_departments.is_archived = true AND student_departments.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-03-19 01:23:31,735 - sqlalchemy.engine.Engine - INFO - [cached since 9.302s ago] {'id_1': UUID('cdb909cf-4d27-4105-8f18-5b9a5f3b0070'), 'param_1': 1}
2025-03-19 01:23:31,737 - sqlalchemy.engine.Engine - INFO - UPDATE student_departments SET last_modified_at=now(), is_archived=%(is_archived)s WHERE student_departments.id = %(student_departments_id)s::UUID
2025-03-19 01:23:31,737 - sqlalchemy.engine.Engine - INFO - [generated in 0.00061s] {'is_archived': False, 'student_departments_id': UUID('cdb909cf-4d27-4105-8f18-5b9a5f3b0070')}
2025-03-19 01:23:31,739 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-19 01:23:31,742 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 01:23:31,744 - sqlalchemy.engine.Engine - INFO - SELECT student_departments.id AS student_departments_id, student_departments.name AS student_departments_name, student_departments.description AS student_departments_description, student_departments.mentor_id AS student_departments_mentor_id, student_departments.student_rep_id AS student_departments_student_rep_id, student_departments.assistant_rep_id AS student_departments_assistant_rep_id, student_departments.created_by AS student_departments_created_by, student_departments.last_modified_by AS student_departments_last_modified_by, student_departments.created_at AS student_departments_created_at, student_departments.last_modified_at AS student_departments_last_modified_at, student_departments.is_archived AS student_departments_is_archived, student_departments.archived_at AS student_departments_archived_at, student_departments.archive_reason AS student_departments_archive_reason, student_departments.archived_by AS student_departments_archived_by 
FROM student_departments 
WHERE student_departments.id = %(pk_1)s::UUID
2025-03-19 01:23:31,745 - sqlalchemy.engine.Engine - INFO - [generated in 0.00090s] {'pk_1': UUID('cdb909cf-4d27-4105-8f18-5b9a5f3b0070')}
2025-03-19 01:23:31,749 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-19 01:23:31,750 - kademia - INFO - Request completed | 03720a11-d55e-4e9f-9f97-e36d9e98656a | Status: 200 | Time: 0.021s
2025-03-19 01:23:39,249 - kademia - INFO - Request started | 43135152-3553-4110-925f-0e3ff2da38e9 | GET /api/v1/archive/students/departments/
2025-03-19 01:23:39,251 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 01:23:39,252 - sqlalchemy.engine.Engine - INFO - SELECT student_departments.id AS student_departments_id, student_departments.name AS student_departments_name, student_departments.description AS student_departments_description, student_departments.mentor_id AS student_departments_mentor_id, student_departments.student_rep_id AS student_departments_student_rep_id, student_departments.assistant_rep_id AS student_departments_assistant_rep_id, student_departments.created_by AS student_departments_created_by, student_departments.last_modified_by AS student_departments_last_modified_by, student_departments.created_at AS student_departments_created_at, student_departments.last_modified_at AS student_departments_last_modified_at, student_departments.is_archived AS student_departments_is_archived, student_departments.archived_at AS student_departments_archived_at, student_departments.archive_reason AS student_departments_archive_reason, student_departments.archived_by AS student_departments_archived_by 
FROM student_departments 
WHERE student_departments.is_archived = true ORDER BY student_departments.name DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
2025-03-19 01:23:39,252 - sqlalchemy.engine.Engine - INFO - [cached since 27.13s ago] {'param_1': 50, 'param_2': 0}
2025-03-19 01:23:39,254 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-19 01:23:39,255 - kademia - INFO - Request completed | 43135152-3553-4110-925f-0e3ff2da38e9 | Status: 200 | Time: 0.006s
2025-03-19 01:23:44,815 - kademia - INFO - Request started | 75c524e6-a910-4cfe-ad66-9a0cc0d9abd8 | GET /api/v1/archive/students/departments/cdb909cf-4d27-4105-8f18-5b9a5f3b0070
2025-03-19 01:23:44,816 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 01:23:44,818 - sqlalchemy.engine.Engine - INFO - SELECT student_departments.id AS student_departments_id, student_departments.name AS student_departments_name, student_departments.description AS student_departments_description, student_departments.mentor_id AS student_departments_mentor_id, student_departments.student_rep_id AS student_departments_student_rep_id, student_departments.assistant_rep_id AS student_departments_assistant_rep_id, student_departments.created_by AS student_departments_created_by, student_departments.last_modified_by AS student_departments_last_modified_by, student_departments.created_at AS student_departments_created_at, student_departments.last_modified_at AS student_departments_last_modified_at, student_departments.is_archived AS student_departments_is_archived, student_departments.archived_at AS student_departments_archived_at, student_departments.archive_reason AS student_departments_archive_reason, student_departments.archived_by AS student_departments_archived_by 
FROM student_departments 
WHERE student_departments.is_archived = true AND student_departments.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-03-19 01:23:44,818 - sqlalchemy.engine.Engine - INFO - [cached since 22.39s ago] {'id_1': UUID('cdb909cf-4d27-4105-8f18-5b9a5f3b0070'), 'param_1': 1}
2025-03-19 01:23:44,820 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-19 01:23:44,822 - kademia - ERROR - Unhandled exception | 75c524e6-a910-4cfe-ad66-9a0cc0d9abd8 | Department with id:cdb909cf-4d27-4105-8f18-5b9a5f3b0070 not found. DETAIL: StudentDepartments not with id cdb909cf-4d27-4105-8f18-5b9a5f3b0070 not found. DETAIL: object not found
Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 111, in receive
    return self.receive_nowait()
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 106, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 124, in receive
    return receiver.item
           ^^^^^^^^^^^^^
AttributeError: 'MemoryObjectItemReceiver' object has no attribute 'item'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 157, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 126, in receive
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\middleware\error_handler.py", line 81, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\fastapi\routing.py", line 214, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\to_thread.py", line 56, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2461, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 962, in run
    result = context.run(func, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\routers\student_organization\archived_student_departments.py", line 27, in get_archived_department
    return student_departments_crud.get_archived_department(department_id)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\crud\student_organization\student_departments.py", line 93, in get_archived_department
    department = self.factory.get_archived_department(department_id)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\core\factories\student_organization\department.py", line 172, in get_archived_department
    raise StudentDepartmentNotFoundError(id=department_id, detail=str(e))
app.core.errors.student_organisation_errors.StudentDepartmentNotFoundError: Department with id:cdb909cf-4d27-4105-8f18-5b9a5f3b0070 not found. DETAIL: StudentDepartments not with id cdb909cf-4d27-4105-8f18-5b9a5f3b0070 not found. DETAIL: object not found
2025-03-19 01:23:44,835 - kademia - WARNING - EntityNotFoundError | 75c524e6-a910-4cfe-ad66-9a0cc0d9abd8 | Department with id:cdb909cf-4d27-4105-8f18-5b9a5f3b0070 not found. DETAIL: StudentDepartments not with id cdb909cf-4d27-4105-8f18-5b9a5f3b0070 not found. DETAIL: object not found
2025-03-19 01:23:50,423 - kademia - INFO - Request started | 62a8bf33-145a-424e-aa1d-8e272204a775 | PATCH /api/v1/archive/students/departments/cdb909cf-4d27-4105-8f18-5b9a5f3b0070
2025-03-19 01:23:50,425 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 01:23:50,426 - sqlalchemy.engine.Engine - INFO - SELECT student_departments.id AS student_departments_id, student_departments.name AS student_departments_name, student_departments.description AS student_departments_description, student_departments.mentor_id AS student_departments_mentor_id, student_departments.student_rep_id AS student_departments_student_rep_id, student_departments.assistant_rep_id AS student_departments_assistant_rep_id, student_departments.created_by AS student_departments_created_by, student_departments.last_modified_by AS student_departments_last_modified_by, student_departments.created_at AS student_departments_created_at, student_departments.last_modified_at AS student_departments_last_modified_at, student_departments.is_archived AS student_departments_is_archived, student_departments.archived_at AS student_departments_archived_at, student_departments.archive_reason AS student_departments_archive_reason, student_departments.archived_by AS student_departments_archived_by 
FROM student_departments 
WHERE student_departments.is_archived = true AND student_departments.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-03-19 01:23:50,427 - sqlalchemy.engine.Engine - INFO - [cached since 27.99s ago] {'id_1': UUID('cdb909cf-4d27-4105-8f18-5b9a5f3b0070'), 'param_1': 1}
2025-03-19 01:23:50,429 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-19 01:23:50,430 - kademia - ERROR - Unhandled exception | 62a8bf33-145a-424e-aa1d-8e272204a775 | Department with id:cdb909cf-4d27-4105-8f18-5b9a5f3b0070 not found. DETAIL: Department with id:cdb909cf-4d27-4105-8f18-5b9a5f3b0070 not found. DETAIL: StudentDepartments not with id cdb909cf-4d27-4105-8f18-5b9a5f3b0070 not found. DETAIL: object not found
Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 111, in receive
    return self.receive_nowait()
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 106, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 124, in receive
    return receiver.item
           ^^^^^^^^^^^^^
AttributeError: 'MemoryObjectItemReceiver' object has no attribute 'item'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 157, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 126, in receive
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\middleware\error_handler.py", line 81, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\fastapi\routing.py", line 214, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\to_thread.py", line 56, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2461, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 962, in run
    result = context.run(func, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\routers\student_organization\archived_student_departments.py", line 33, in restore_department
    return student_departments_crud.restore_department(department_id)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\crud\student_organization\student_departments.py", line 113, in restore_department
    department = self.factory.restore_department(department_id)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\core\factories\student_organization\department.py", line 186, in restore_department
    raise StudentDepartmentNotFoundError(id=department_id, detail=str(e))
app.core.errors.student_organisation_errors.StudentDepartmentNotFoundError: Department with id:cdb909cf-4d27-4105-8f18-5b9a5f3b0070 not found. DETAIL: Department with id:cdb909cf-4d27-4105-8f18-5b9a5f3b0070 not found. DETAIL: StudentDepartments not with id cdb909cf-4d27-4105-8f18-5b9a5f3b0070 not found. DETAIL: object not found
2025-03-19 01:23:50,450 - kademia - WARNING - EntityNotFoundError | 62a8bf33-145a-424e-aa1d-8e272204a775 | Department with id:cdb909cf-4d27-4105-8f18-5b9a5f3b0070 not found. DETAIL: Department with id:cdb909cf-4d27-4105-8f18-5b9a5f3b0070 not found. DETAIL: StudentDepartments not with id cdb909cf-4d27-4105-8f18-5b9a5f3b0070 not found. DETAIL: object not found
2025-03-19 01:24:00,866 - kademia - INFO - Request started | ba9ba3cb-947d-4ec5-ae3f-23db3b351109 | GET /api/v1/students/departments/cdb909cf-4d27-4105-8f18-5b9a5f3b0070
2025-03-19 01:24:00,868 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 01:24:00,869 - sqlalchemy.engine.Engine - INFO - SELECT student_departments.id AS student_departments_id, student_departments.name AS student_departments_name, student_departments.description AS student_departments_description, student_departments.mentor_id AS student_departments_mentor_id, student_departments.student_rep_id AS student_departments_student_rep_id, student_departments.assistant_rep_id AS student_departments_assistant_rep_id, student_departments.created_by AS student_departments_created_by, student_departments.last_modified_by AS student_departments_last_modified_by, student_departments.created_at AS student_departments_created_at, student_departments.last_modified_at AS student_departments_last_modified_at, student_departments.is_archived AS student_departments_is_archived, student_departments.archived_at AS student_departments_archived_at, student_departments.archive_reason AS student_departments_archive_reason, student_departments.archived_by AS student_departments_archived_by 
FROM student_departments 
WHERE student_departments.is_archived = false AND student_departments.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-03-19 01:24:00,870 - sqlalchemy.engine.Engine - INFO - [cached since 347.1s ago] {'id_1': UUID('cdb909cf-4d27-4105-8f18-5b9a5f3b0070'), 'param_1': 1}
2025-03-19 01:24:00,872 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-19 01:24:00,873 - kademia - INFO - Request completed | ba9ba3cb-947d-4ec5-ae3f-23db3b351109 | Status: 200 | Time: 0.006s
2025-03-19 01:24:07,127 - kademia - INFO - Request started | f60d13aa-55cb-4932-afbb-821a58c0c741 | DELETE /api/v1/students/departments/cdb909cf-4d27-4105-8f18-5b9a5f3b0070
2025-03-19 01:24:07,129 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 01:24:07,130 - sqlalchemy.engine.Engine - INFO - SELECT student_departments.id AS student_departments_id, student_departments.name AS student_departments_name, student_departments.description AS student_departments_description, student_departments.mentor_id AS student_departments_mentor_id, student_departments.student_rep_id AS student_departments_student_rep_id, student_departments.assistant_rep_id AS student_departments_assistant_rep_id, student_departments.created_by AS student_departments_created_by, student_departments.last_modified_by AS student_departments_last_modified_by, student_departments.created_at AS student_departments_created_at, student_departments.last_modified_at AS student_departments_last_modified_at, student_departments.is_archived AS student_departments_is_archived, student_departments.archived_at AS student_departments_archived_at, student_departments.archive_reason AS student_departments_archive_reason, student_departments.archived_by AS student_departments_archived_by 
FROM student_departments 
WHERE student_departments.is_archived = false AND student_departments.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-03-19 01:24:07,131 - sqlalchemy.engine.Engine - INFO - [cached since 353.4s ago] {'id_1': UUID('cdb909cf-4d27-4105-8f18-5b9a5f3b0070'), 'param_1': 1}
2025-03-19 01:24:07,137 - sqlalchemy.engine.Engine - INFO - SELECT students.student_id AS students_student_id, students.user_type AS students_user_type, students.access_level AS students_access_level, students.status AS students_status, students.date_of_birth AS students_date_of_birth, students.image_url AS students_image_url, students.class_id AS students_class_id, students.level_id AS students_level_id, students.department_id AS students_department_id, students.guardian_id AS students_guardian_id, students.is_repeating AS students_is_repeating, students.admission_date AS students_admission_date, students.date_left AS students_date_left, students.graduation_date AS students_graduation_date, students.id AS students_id, students.password_hash AS students_password_hash, students.first_name AS students_first_name, students.last_name AS students_last_name, students.gender AS students_gender, students.last_login AS students_last_login, students.deletion_eligible AS students_deletion_eligible, students.created_by AS students_created_by, students.last_modified_by AS students_last_modified_by, students.created_at AS students_created_at, students.last_modified_at AS students_last_modified_at, students.is_archived AS students_is_archived, students.archived_at AS students_archived_at, students.archive_reason AS students_archive_reason, students.archived_by AS students_archived_by 
FROM students 
WHERE %(param_1)s::UUID = students.department_id
2025-03-19 01:24:07,139 - sqlalchemy.engine.Engine - INFO - [generated in 0.00127s] {'param_1': UUID('cdb909cf-4d27-4105-8f18-5b9a5f3b0070')}
2025-03-19 01:24:07,148 - sqlalchemy.engine.Engine - INFO - DELETE FROM student_departments WHERE student_departments.id = %(id)s::UUID
2025-03-19 01:24:07,149 - sqlalchemy.engine.Engine - INFO - [generated in 0.00049s] {'id': UUID('cdb909cf-4d27-4105-8f18-5b9a5f3b0070')}
2025-03-19 01:24:07,164 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-19 01:24:07,165 - kademia - INFO - Request completed | f60d13aa-55cb-4932-afbb-821a58c0c741 | Status: 204 | Time: 0.038s
2025-03-19 01:24:38,898 - kademia - INFO - Request started | 55323d7c-2252-419e-ae84-622e06a32db2 | PATCH /api/v1/students/departments/4f9a41d7-391e-444b-9ebe-fac76d49b550
2025-03-19 01:24:38,901 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 01:24:38,902 - sqlalchemy.engine.Engine - INFO - SELECT student_departments.id AS student_departments_id, student_departments.name AS student_departments_name, student_departments.description AS student_departments_description, student_departments.mentor_id AS student_departments_mentor_id, student_departments.student_rep_id AS student_departments_student_rep_id, student_departments.assistant_rep_id AS student_departments_assistant_rep_id, student_departments.created_by AS student_departments_created_by, student_departments.last_modified_by AS student_departments_last_modified_by, student_departments.created_at AS student_departments_created_at, student_departments.last_modified_at AS student_departments_last_modified_at, student_departments.is_archived AS student_departments_is_archived, student_departments.archived_at AS student_departments_archived_at, student_departments.archive_reason AS student_departments_archive_reason, student_departments.archived_by AS student_departments_archived_by 
FROM student_departments 
WHERE student_departments.is_archived = false AND student_departments.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-03-19 01:24:38,902 - sqlalchemy.engine.Engine - INFO - [cached since 385.2s ago] {'id_1': UUID('4f9a41d7-391e-444b-9ebe-fac76d49b550'), 'param_1': 1}
2025-03-19 01:24:38,903 - sqlalchemy.engine.Engine - INFO - UPDATE student_departments SET last_modified_at=now(), is_archived=%(is_archived)s, archived_at=%(archived_at)s, archive_reason=%(archive_reason)s, archived_by=%(archived_by)s::UUID WHERE student_departments.id = %(student_departments_id)s::UUID
2025-03-19 01:24:38,905 - sqlalchemy.engine.Engine - INFO - [cached since 217.7s ago] {'is_archived': True, 'archived_at': datetime.datetime(2025, 3, 19, 1, 24, 38, 903708, tzinfo=datetime.timezone.utc), 'archive_reason': 'ERROR', 'archived_by': UUID('00000000-0000-0000-0000-000000000000'), 'student_departments_id': UUID('4f9a41d7-391e-444b-9ebe-fac76d49b550')}
2025-03-19 01:24:38,907 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-19 01:24:38,912 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 01:24:38,912 - sqlalchemy.engine.Engine - INFO - SELECT student_departments.id, student_departments.name, student_departments.description, student_departments.mentor_id, student_departments.student_rep_id, student_departments.assistant_rep_id, student_departments.created_by, student_departments.last_modified_by, student_departments.created_at, student_departments.last_modified_at, student_departments.is_archived, student_departments.archived_at, student_departments.archive_reason, student_departments.archived_by 
FROM student_departments 
WHERE student_departments.id = %(pk_1)s::UUID
2025-03-19 01:24:38,947 - sqlalchemy.engine.Engine - INFO - [cached since 217.7s ago] {'pk_1': UUID('4f9a41d7-391e-444b-9ebe-fac76d49b550')}
2025-03-19 01:24:38,949 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-19 01:24:38,950 - kademia - INFO - Request completed | 55323d7c-2252-419e-ae84-622e06a32db2 | Status: 204 | Time: 0.052s
2025-03-19 01:24:51,718 - kademia - INFO - Request started | c0ed4ab3-510e-4a71-a335-d8ff4d763cbf | DELETE /api/v1/archive/students/departments/4f9a41d7-391e-444b-9ebe-fac76d49b550
2025-03-19 01:24:51,721 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 01:24:51,721 - sqlalchemy.engine.Engine - INFO - SELECT student_departments.id AS student_departments_id, student_departments.name AS student_departments_name, student_departments.description AS student_departments_description, student_departments.mentor_id AS student_departments_mentor_id, student_departments.student_rep_id AS student_departments_student_rep_id, student_departments.assistant_rep_id AS student_departments_assistant_rep_id, student_departments.created_by AS student_departments_created_by, student_departments.last_modified_by AS student_departments_last_modified_by, student_departments.created_at AS student_departments_created_at, student_departments.last_modified_at AS student_departments_last_modified_at, student_departments.is_archived AS student_departments_is_archived, student_departments.archived_at AS student_departments_archived_at, student_departments.archive_reason AS student_departments_archive_reason, student_departments.archived_by AS student_departments_archived_by 
FROM student_departments 
WHERE student_departments.is_archived = true AND student_departments.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-03-19 01:24:51,722 - sqlalchemy.engine.Engine - INFO - [cached since 89.29s ago] {'id_1': UUID('4f9a41d7-391e-444b-9ebe-fac76d49b550'), 'param_1': 1}
2025-03-19 01:24:51,723 - sqlalchemy.engine.Engine - INFO - SELECT students.student_id AS students_student_id, students.user_type AS students_user_type, students.access_level AS students_access_level, students.status AS students_status, students.date_of_birth AS students_date_of_birth, students.image_url AS students_image_url, students.class_id AS students_class_id, students.level_id AS students_level_id, students.department_id AS students_department_id, students.guardian_id AS students_guardian_id, students.is_repeating AS students_is_repeating, students.admission_date AS students_admission_date, students.date_left AS students_date_left, students.graduation_date AS students_graduation_date, students.id AS students_id, students.password_hash AS students_password_hash, students.first_name AS students_first_name, students.last_name AS students_last_name, students.gender AS students_gender, students.last_login AS students_last_login, students.deletion_eligible AS students_deletion_eligible, students.created_by AS students_created_by, students.last_modified_by AS students_last_modified_by, students.created_at AS students_created_at, students.last_modified_at AS students_last_modified_at, students.is_archived AS students_is_archived, students.archived_at AS students_archived_at, students.archive_reason AS students_archive_reason, students.archived_by AS students_archived_by 
FROM students 
WHERE %(param_1)s::UUID = students.department_id
2025-03-19 01:24:51,725 - sqlalchemy.engine.Engine - INFO - [cached since 44.59s ago] {'param_1': UUID('4f9a41d7-391e-444b-9ebe-fac76d49b550')}
2025-03-19 01:24:51,727 - sqlalchemy.engine.Engine - INFO - DELETE FROM student_departments WHERE student_departments.id = %(id)s::UUID
2025-03-19 01:24:51,728 - sqlalchemy.engine.Engine - INFO - [cached since 44.58s ago] {'id': UUID('4f9a41d7-391e-444b-9ebe-fac76d49b550')}
2025-03-19 01:24:51,729 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-19 01:24:51,732 - kademia - INFO - Request completed | c0ed4ab3-510e-4a71-a335-d8ff4d763cbf | Status: 204 | Time: 0.014s
2025-03-19 01:25:42,097 - kademia - INFO - Request started | 530e8792-ecec-4a87-9ea8-d37147bc81cb | POST /api/v1/students/academic_levels/
2025-03-19 01:25:42,101 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 01:25:42,104 - sqlalchemy.engine.Engine - INFO - INSERT INTO academic_levels (id, name, description, "order", created_by, last_modified_by, created_at, last_modified_at, is_archived, archived_at, archive_reason, archived_by) VALUES (%(id)s::UUID, %(name)s, %(description)s, %(order)s, %(created_by)s::UUID, %(last_modified_by)s::UUID, now(), now(), %(is_archived)s, %(archived_at)s, %(archive_reason)s, %(archived_by)s::UUID) RETURNING academic_levels.created_at, academic_levels.last_modified_at
2025-03-19 01:25:42,104 - sqlalchemy.engine.Engine - INFO - [generated in 0.00084s] {'id': UUID('842301c1-7e05-4c34-ba54-7f41c0a05443'), 'name': 'Jss1', 'description': 'First Level In The Secondary School System', 'order': 1, 'created_by': UUID('00000000-0000-0000-0000-000000000000'), 'last_modified_by': UUID('00000000-0000-0000-0000-000000000000'), 'is_archived': False, 'archived_at': None, 'archive_reason': None, 'archived_by': None}
2025-03-19 01:25:42,117 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-19 01:25:42,121 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 01:25:42,122 - sqlalchemy.engine.Engine - INFO - SELECT academic_levels.id, academic_levels.name, academic_levels.description, academic_levels."order", academic_levels.created_by, academic_levels.last_modified_by, academic_levels.created_at, academic_levels.last_modified_at, academic_levels.is_archived, academic_levels.archived_at, academic_levels.archive_reason, academic_levels.archived_by 
FROM academic_levels 
WHERE academic_levels.id = %(pk_1)s::UUID
2025-03-19 01:25:42,123 - sqlalchemy.engine.Engine - INFO - [generated in 0.00048s] {'pk_1': UUID('842301c1-7e05-4c34-ba54-7f41c0a05443')}
2025-03-19 01:25:42,124 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-19 01:25:42,125 - kademia - INFO - Request completed | 530e8792-ecec-4a87-9ea8-d37147bc81cb | Status: 201 | Time: 0.028s
2025-03-19 01:25:45,733 - kademia - INFO - Request started | b119b389-cc54-410f-80ec-a777abcf35bc | POST /api/v1/students/academic_levels/
2025-03-19 01:25:45,734 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 01:25:45,736 - sqlalchemy.engine.Engine - INFO - INSERT INTO academic_levels (id, name, description, "order", created_by, last_modified_by, created_at, last_modified_at, is_archived, archived_at, archive_reason, archived_by) VALUES (%(id)s::UUID, %(name)s, %(description)s, %(order)s, %(created_by)s::UUID, %(last_modified_by)s::UUID, now(), now(), %(is_archived)s, %(archived_at)s, %(archive_reason)s, %(archived_by)s::UUID) RETURNING academic_levels.created_at, academic_levels.last_modified_at
2025-03-19 01:25:45,737 - sqlalchemy.engine.Engine - INFO - [cached since 3.633s ago] {'id': UUID('de44be43-e5e4-473b-b3b2-bd3e7bd29c08'), 'name': 'Jss1', 'description': 'First Level In The Secondary School System', 'order': 1, 'created_by': UUID('00000000-0000-0000-0000-000000000000'), 'last_modified_by': UUID('00000000-0000-0000-0000-000000000000'), 'is_archived': False, 'archived_at': None, 'archive_reason': None, 'archived_by': None}
2025-03-19 01:25:45,738 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-19 01:25:45,741 - kademia - ERROR - Unhandled exception | b119b389-cc54-410f-80ec-a777abcf35bc | Duplicate level creation attempted: unique constraint violation - detail: (psycopg2.errors.uniqueviolation) duplicate key value violates unique constraint "academic_levels_name_key"
detail:  key (name)=(jss1) already exists.

[sql: insert into academic_levels (id, name, description, "order", created_by, last_modified_by, created_at, last_modified_at, is_archived, archived_at, archive_reason, archived_by) values (%(id)s::uuid, %(name)s, %(description)s, %(order)s, %(created_by)s::uuid, %(last_modified_by)s::uuid, now(), now(), %(is_archived)s, %(archived_at)s, %(archive_reason)s, %(archived_by)s::uuid) returning academic_levels.created_at, academic_levels.last_modified_at]
[parameters: {'id': uuid('de44be43-e5e4-473b-b3b2-bd3e7bd29c08'), 'name': 'jss1', 'description': 'first level in the secondary school system', 'order': 1, 'created_by': uuid('00000000-0000-0000-0000-000000000000'), 'last_modified_by': uuid('00000000-0000-0000-0000-000000000000'), 'is_archived': false, 'archived_at': none, 'archive_reason': none, 'archived_by': none}]
(background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 111, in receive
    return self.receive_nowait()
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 106, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 124, in receive
    return receiver.item
           ^^^^^^^^^^^^^
AttributeError: 'MemoryObjectItemReceiver' object has no attribute 'item'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 157, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 126, in receive
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\middleware\error_handler.py", line 81, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\fastapi\routing.py", line 214, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\to_thread.py", line 56, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2461, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 962, in run
    result = context.run(func, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\routers\student_organization\academic_levels.py", line 21, in create_academic_level
    return academic_level_crud.create_level(data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\crud\student_organization\academic_levels.py", line 30, in create_level
    level = self.factory.create_academic_level(data)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\core\factories\student_organization\academic_level.py", line 46, in create_academic_level
    raise DuplicateLevelError(
app.core.errors.student_organisation_errors.DuplicateLevelError: Duplicate level creation attempted: unique constraint violation - detail: (psycopg2.errors.uniqueviolation) duplicate key value violates unique constraint "academic_levels_name_key"
detail:  key (name)=(jss1) already exists.

[sql: insert into academic_levels (id, name, description, "order", created_by, last_modified_by, created_at, last_modified_at, is_archived, archived_at, archive_reason, archived_by) values (%(id)s::uuid, %(name)s, %(description)s, %(order)s, %(created_by)s::uuid, %(last_modified_by)s::uuid, now(), now(), %(is_archived)s, %(archived_at)s, %(archive_reason)s, %(archived_by)s::uuid) returning academic_levels.created_at, academic_levels.last_modified_at]
[parameters: {'id': uuid('de44be43-e5e4-473b-b3b2-bd3e7bd29c08'), 'name': 'jss1', 'description': 'first level in the secondary school system', 'order': 1, 'created_by': uuid('00000000-0000-0000-0000-000000000000'), 'last_modified_by': uuid('00000000-0000-0000-0000-000000000000'), 'is_archived': false, 'archived_at': none, 'archive_reason': none, 'archived_by': none}]
(background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-19 01:25:45,787 - kademia - WARNING - UniqueViolationError | b119b389-cc54-410f-80ec-a777abcf35bc | Duplicate level creation attempted: unique constraint violation - detail: (psycopg2.errors.uniqueviolation) duplicate key value violates unique constraint "academic_levels_name_key"
detail:  key (name)=(jss1) already exists.

[sql: insert into academic_levels (id, name, description, "order", created_by, last_modified_by, created_at, last_modified_at, is_archived, archived_at, archive_reason, archived_by) values (%(id)s::uuid, %(name)s, %(description)s, %(order)s, %(created_by)s::uuid, %(last_modified_by)s::uuid, now(), now(), %(is_archived)s, %(archived_at)s, %(archive_reason)s, %(archived_by)s::uuid) returning academic_levels.created_at, academic_levels.last_modified_at]
[parameters: {'id': uuid('de44be43-e5e4-473b-b3b2-bd3e7bd29c08'), 'name': 'jss1', 'description': 'first level in the secondary school system', 'order': 1, 'created_by': uuid('00000000-0000-0000-0000-000000000000'), 'last_modified_by': uuid('00000000-0000-0000-0000-000000000000'), 'is_archived': false, 'archived_at': none, 'archive_reason': none, 'archived_by': none}]
(background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-19 01:25:57,827 - kademia - INFO - Request started | 88f21c4e-9d89-4d99-9e9d-3d6fdb2bee50 | POST /api/v1/students/academic_levels/
2025-03-19 01:25:57,829 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 01:25:57,831 - sqlalchemy.engine.Engine - INFO - INSERT INTO academic_levels (id, name, description, "order", created_by, last_modified_by, created_at, last_modified_at, is_archived, archived_at, archive_reason, archived_by) VALUES (%(id)s::UUID, %(name)s, %(description)s, %(order)s, %(created_by)s::UUID, %(last_modified_by)s::UUID, now(), now(), %(is_archived)s, %(archived_at)s, %(archive_reason)s, %(archived_by)s::UUID) RETURNING academic_levels.created_at, academic_levels.last_modified_at
2025-03-19 01:25:57,831 - sqlalchemy.engine.Engine - INFO - [cached since 15.73s ago] {'id': UUID('665d86e9-d4b1-4233-be57-3f4dc8195e0d'), 'name': 'Jssn', 'description': 'First Level In The Secondary School System', 'order': 1, 'created_by': UUID('00000000-0000-0000-0000-000000000000'), 'last_modified_by': UUID('00000000-0000-0000-0000-000000000000'), 'is_archived': False, 'archived_at': None, 'archive_reason': None, 'archived_by': None}
2025-03-19 01:25:57,833 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-19 01:25:57,835 - kademia - ERROR - Unhandled exception | 88f21c4e-9d89-4d99-9e9d-3d6fdb2bee50 | Duplicate level creation attempted: unique constraint violation - detail: (psycopg2.errors.uniqueviolation) duplicate key value violates unique constraint "academic_levels_order_key"
detail:  key ("order")=(1) already exists.

[sql: insert into academic_levels (id, name, description, "order", created_by, last_modified_by, created_at, last_modified_at, is_archived, archived_at, archive_reason, archived_by) values (%(id)s::uuid, %(name)s, %(description)s, %(order)s, %(created_by)s::uuid, %(last_modified_by)s::uuid, now(), now(), %(is_archived)s, %(archived_at)s, %(archive_reason)s, %(archived_by)s::uuid) returning academic_levels.created_at, academic_levels.last_modified_at]
[parameters: {'id': uuid('665d86e9-d4b1-4233-be57-3f4dc8195e0d'), 'name': 'jssn', 'description': 'first level in the secondary school system', 'order': 1, 'created_by': uuid('00000000-0000-0000-0000-000000000000'), 'last_modified_by': uuid('00000000-0000-0000-0000-000000000000'), 'is_archived': false, 'archived_at': none, 'archive_reason': none, 'archived_by': none}]
(background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 111, in receive
    return self.receive_nowait()
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 106, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 124, in receive
    return receiver.item
           ^^^^^^^^^^^^^
AttributeError: 'MemoryObjectItemReceiver' object has no attribute 'item'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 157, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 126, in receive
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\middleware\error_handler.py", line 81, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\fastapi\routing.py", line 214, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\to_thread.py", line 56, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2461, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 962, in run
    result = context.run(func, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\routers\student_organization\academic_levels.py", line 21, in create_academic_level
    return academic_level_crud.create_level(data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\crud\student_organization\academic_levels.py", line 30, in create_level
    level = self.factory.create_academic_level(data)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\core\factories\student_organization\academic_level.py", line 49, in create_academic_level
    raise DuplicateLevelError(
app.core.errors.student_organisation_errors.DuplicateLevelError: Duplicate level creation attempted: unique constraint violation - detail: (psycopg2.errors.uniqueviolation) duplicate key value violates unique constraint "academic_levels_order_key"
detail:  key ("order")=(1) already exists.

[sql: insert into academic_levels (id, name, description, "order", created_by, last_modified_by, created_at, last_modified_at, is_archived, archived_at, archive_reason, archived_by) values (%(id)s::uuid, %(name)s, %(description)s, %(order)s, %(created_by)s::uuid, %(last_modified_by)s::uuid, now(), now(), %(is_archived)s, %(archived_at)s, %(archive_reason)s, %(archived_by)s::uuid) returning academic_levels.created_at, academic_levels.last_modified_at]
[parameters: {'id': uuid('665d86e9-d4b1-4233-be57-3f4dc8195e0d'), 'name': 'jssn', 'description': 'first level in the secondary school system', 'order': 1, 'created_by': uuid('00000000-0000-0000-0000-000000000000'), 'last_modified_by': uuid('00000000-0000-0000-0000-000000000000'), 'is_archived': false, 'archived_at': none, 'archive_reason': none, 'archived_by': none}]
(background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-19 01:25:57,841 - kademia - WARNING - UniqueViolationError | 88f21c4e-9d89-4d99-9e9d-3d6fdb2bee50 | Duplicate level creation attempted: unique constraint violation - detail: (psycopg2.errors.uniqueviolation) duplicate key value violates unique constraint "academic_levels_order_key"
detail:  key ("order")=(1) already exists.

[sql: insert into academic_levels (id, name, description, "order", created_by, last_modified_by, created_at, last_modified_at, is_archived, archived_at, archive_reason, archived_by) values (%(id)s::uuid, %(name)s, %(description)s, %(order)s, %(created_by)s::uuid, %(last_modified_by)s::uuid, now(), now(), %(is_archived)s, %(archived_at)s, %(archive_reason)s, %(archived_by)s::uuid) returning academic_levels.created_at, academic_levels.last_modified_at]
[parameters: {'id': uuid('665d86e9-d4b1-4233-be57-3f4dc8195e0d'), 'name': 'jssn', 'description': 'first level in the secondary school system', 'order': 1, 'created_by': uuid('00000000-0000-0000-0000-000000000000'), 'last_modified_by': uuid('00000000-0000-0000-0000-000000000000'), 'is_archived': false, 'archived_at': none, 'archive_reason': none, 'archived_by': none}]
(background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-19 01:26:16,205 - kademia - INFO - Request started | 98aaf966-bd92-42ed-bc13-9b4eee329040 | POST /api/v1/students/academic_levels/
2025-03-19 01:26:16,207 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 01:26:16,208 - sqlalchemy.engine.Engine - INFO - INSERT INTO academic_levels (id, name, description, "order", created_by, last_modified_by, created_at, last_modified_at, is_archived, archived_at, archive_reason, archived_by) VALUES (%(id)s::UUID, %(name)s, %(description)s, %(order)s, %(created_by)s::UUID, %(last_modified_by)s::UUID, now(), now(), %(is_archived)s, %(archived_at)s, %(archive_reason)s, %(archived_by)s::UUID) RETURNING academic_levels.created_at, academic_levels.last_modified_at
2025-03-19 01:26:16,209 - sqlalchemy.engine.Engine - INFO - [cached since 34.11s ago] {'id': UUID('69297e55-a785-472f-9e3f-21c857cba53d'), 'name': 'Jssn', 'description': 'First Level In The Secondary School System', 'order': 6, 'created_by': UUID('00000000-0000-0000-0000-000000000000'), 'last_modified_by': UUID('00000000-0000-0000-0000-000000000000'), 'is_archived': False, 'archived_at': None, 'archive_reason': None, 'archived_by': None}
2025-03-19 01:26:16,211 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-19 01:26:16,215 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 01:26:16,216 - sqlalchemy.engine.Engine - INFO - SELECT academic_levels.id, academic_levels.name, academic_levels.description, academic_levels."order", academic_levels.created_by, academic_levels.last_modified_by, academic_levels.created_at, academic_levels.last_modified_at, academic_levels.is_archived, academic_levels.archived_at, academic_levels.archive_reason, academic_levels.archived_by 
FROM academic_levels 
WHERE academic_levels.id = %(pk_1)s::UUID
2025-03-19 01:26:16,217 - sqlalchemy.engine.Engine - INFO - [cached since 34.09s ago] {'pk_1': UUID('69297e55-a785-472f-9e3f-21c857cba53d')}
2025-03-19 01:26:16,220 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-19 01:26:16,222 - kademia - INFO - Request completed | 98aaf966-bd92-42ed-bc13-9b4eee329040 | Status: 201 | Time: 0.018s
2025-03-19 01:26:32,576 - kademia - INFO - Request started | 3e32682d-11b4-447c-91b4-f6241475c92d | GET /api/v1/students/academic_levels/
2025-03-19 01:26:32,578 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 01:26:32,580 - sqlalchemy.engine.Engine - INFO - SELECT academic_levels.id AS academic_levels_id, academic_levels.name AS academic_levels_name, academic_levels.description AS academic_levels_description, academic_levels."order" AS academic_levels_order, academic_levels.created_by AS academic_levels_created_by, academic_levels.last_modified_by AS academic_levels_last_modified_by, academic_levels.created_at AS academic_levels_created_at, academic_levels.last_modified_at AS academic_levels_last_modified_at, academic_levels.is_archived AS academic_levels_is_archived, academic_levels.archived_at AS academic_levels_archived_at, academic_levels.archive_reason AS academic_levels_archive_reason, academic_levels.archived_by AS academic_levels_archived_by 
FROM academic_levels 
WHERE academic_levels.is_archived = false AND academic_levels.name ILIKE %(name_1)s ORDER BY academic_levels."order" DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
2025-03-19 01:26:32,580 - sqlalchemy.engine.Engine - INFO - [generated in 0.00099s] {'name_1': '%n%', 'param_1': 50, 'param_2': 0}
2025-03-19 01:26:32,584 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-19 01:26:32,585 - kademia - INFO - Request completed | 3e32682d-11b4-447c-91b4-f6241475c92d | Status: 200 | Time: 0.008s
2025-03-19 01:27:07,023 - kademia - INFO - Request started | 1afbe689-155a-4c4f-8579-1e770fcfe473 | GET /api/v1/students/academic_levels/842301c1-7e05-4c34-ba54-7f41c0a05443
2025-03-19 01:27:07,025 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 01:27:07,026 - sqlalchemy.engine.Engine - INFO - SELECT academic_levels.id AS academic_levels_id, academic_levels.name AS academic_levels_name, academic_levels.description AS academic_levels_description, academic_levels."order" AS academic_levels_order, academic_levels.created_by AS academic_levels_created_by, academic_levels.last_modified_by AS academic_levels_last_modified_by, academic_levels.created_at AS academic_levels_created_at, academic_levels.last_modified_at AS academic_levels_last_modified_at, academic_levels.is_archived AS academic_levels_is_archived, academic_levels.archived_at AS academic_levels_archived_at, academic_levels.archive_reason AS academic_levels_archive_reason, academic_levels.archived_by AS academic_levels_archived_by 
FROM academic_levels 
WHERE academic_levels.is_archived = false AND academic_levels.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-03-19 01:27:07,027 - sqlalchemy.engine.Engine - INFO - [generated in 0.00080s] {'id_1': UUID('842301c1-7e05-4c34-ba54-7f41c0a05443'), 'param_1': 1}
2025-03-19 01:27:07,030 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-19 01:27:07,031 - kademia - INFO - Request completed | 1afbe689-155a-4c4f-8579-1e770fcfe473 | Status: 200 | Time: 0.008s
2025-03-19 01:28:00,195 - kademia - INFO - Request started | ec168e73-8504-4af7-b6e3-40c464dc0851 | PUT /api/v1/students/academic_levels/842301c1-7e05-4c34-ba54-7f41c0a05443
2025-03-19 01:28:00,199 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 01:28:00,200 - sqlalchemy.engine.Engine - INFO - SELECT academic_levels.id AS academic_levels_id, academic_levels.name AS academic_levels_name, academic_levels.description AS academic_levels_description, academic_levels."order" AS academic_levels_order, academic_levels.created_by AS academic_levels_created_by, academic_levels.last_modified_by AS academic_levels_last_modified_by, academic_levels.created_at AS academic_levels_created_at, academic_levels.last_modified_at AS academic_levels_last_modified_at, academic_levels.is_archived AS academic_levels_is_archived, academic_levels.archived_at AS academic_levels_archived_at, academic_levels.archive_reason AS academic_levels_archive_reason, academic_levels.archived_by AS academic_levels_archived_by 
FROM academic_levels 
WHERE academic_levels.is_archived = false AND academic_levels.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-03-19 01:28:00,201 - sqlalchemy.engine.Engine - INFO - [cached since 53.17s ago] {'id_1': UUID('842301c1-7e05-4c34-ba54-7f41c0a05443'), 'param_1': 1}
2025-03-19 01:28:00,203 - sqlalchemy.engine.Engine - INFO - SELECT academic_levels.id AS academic_levels_id, academic_levels.name AS academic_levels_name, academic_levels.description AS academic_levels_description, academic_levels."order" AS academic_levels_order, academic_levels.created_by AS academic_levels_created_by, academic_levels.last_modified_by AS academic_levels_last_modified_by, academic_levels.created_at AS academic_levels_created_at, academic_levels.last_modified_at AS academic_levels_last_modified_at, academic_levels.is_archived AS academic_levels_is_archived, academic_levels.archived_at AS academic_levels_archived_at, academic_levels.archive_reason AS academic_levels_archive_reason, academic_levels.archived_by AS academic_levels_archived_by 
FROM academic_levels 
WHERE academic_levels.is_archived = false AND academic_levels.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-03-19 01:28:00,204 - sqlalchemy.engine.Engine - INFO - [cached since 53.18s ago] {'id_1': UUID('842301c1-7e05-4c34-ba54-7f41c0a05443'), 'param_1': 1}
2025-03-19 01:28:00,206 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-19 01:28:00,208 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 01:28:00,209 - sqlalchemy.engine.Engine - INFO - SELECT academic_levels.id, academic_levels.name, academic_levels.description, academic_levels."order", academic_levels.created_by, academic_levels.last_modified_by, academic_levels.created_at, academic_levels.last_modified_at, academic_levels.is_archived, academic_levels.archived_at, academic_levels.archive_reason, academic_levels.archived_by 
FROM academic_levels 
WHERE academic_levels.id = %(pk_1)s::UUID
2025-03-19 01:28:00,230 - sqlalchemy.engine.Engine - INFO - [cached since 138.1s ago] {'pk_1': UUID('842301c1-7e05-4c34-ba54-7f41c0a05443')}
2025-03-19 01:28:00,236 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-19 01:28:00,248 - kademia - INFO - Request completed | ec168e73-8504-4af7-b6e3-40c464dc0851 | Status: 200 | Time: 0.053s
2025-03-19 01:28:21,532 - kademia - INFO - Request started | f8aa9991-34a3-4506-aea1-b1fee2237d9e | PUT /api/v1/students/academic_levels/842301c1-7e05-4c34-ba54-7f41c0a05443
2025-03-19 01:28:21,534 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 01:28:21,535 - sqlalchemy.engine.Engine - INFO - SELECT academic_levels.id AS academic_levels_id, academic_levels.name AS academic_levels_name, academic_levels.description AS academic_levels_description, academic_levels."order" AS academic_levels_order, academic_levels.created_by AS academic_levels_created_by, academic_levels.last_modified_by AS academic_levels_last_modified_by, academic_levels.created_at AS academic_levels_created_at, academic_levels.last_modified_at AS academic_levels_last_modified_at, academic_levels.is_archived AS academic_levels_is_archived, academic_levels.archived_at AS academic_levels_archived_at, academic_levels.archive_reason AS academic_levels_archive_reason, academic_levels.archived_by AS academic_levels_archived_by 
FROM academic_levels 
WHERE academic_levels.is_archived = false AND academic_levels.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-03-19 01:28:21,535 - sqlalchemy.engine.Engine - INFO - [cached since 74.51s ago] {'id_1': UUID('842301c1-7e05-4c34-ba54-7f41c0a05443'), 'param_1': 1}
2025-03-19 01:28:21,538 - sqlalchemy.engine.Engine - INFO - UPDATE academic_levels SET name=%(name)s, last_modified_at=now() WHERE academic_levels.id = %(academic_levels_id)s::UUID
2025-03-19 01:28:21,538 - sqlalchemy.engine.Engine - INFO - [generated in 0.00053s] {'name': 'Jssn', 'academic_levels_id': UUID('842301c1-7e05-4c34-ba54-7f41c0a05443')}
2025-03-19 01:28:21,540 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-19 01:28:21,543 - kademia - ERROR - Unhandled exception | f8aa9991-34a3-4506-aea1-b1fee2237d9e | Duplicate level creation attempted: Unique constraint violation - Detail: (raised as a result of query-invoked autoflush; consider using a session.no_autoflush block if this flush is occurring prematurely)
(psycopg2.errors.uniqueviolation) duplicate key value violates unique constraint "academic_levels_name_key"
detail:  key (name)=(jssn) already exists.

[sql: update academic_levels set name=%(name)s, last_modified_at=now() where academic_levels.id = %(academic_levels_id)s::uuid]
[parameters: {'name': 'jssn', 'academic_levels_id': uuid('842301c1-7e05-4c34-ba54-7f41c0a05443')}]
(background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 111, in receive
    return self.receive_nowait()
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 106, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 124, in receive
    return receiver.item
           ^^^^^^^^^^^^^
AttributeError: 'MemoryObjectItemReceiver' object has no attribute 'item'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 157, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 126, in receive
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\middleware\error_handler.py", line 81, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\fastapi\routing.py", line 214, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\to_thread.py", line 56, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2461, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 962, in run
    result = context.run(func, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\routers\student_organization\academic_levels.py", line 41, in update_academic_level
    return academic_level_crud.update_level(level_id, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\crud\student_organization\academic_levels.py", line 63, in update_level
    updated_level = self.factory.update_academic_level(level_id, data)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\core\factories\student_organization\academic_level.py", line 104, in update_academic_level
    raise DuplicateLevelError(
app.core.errors.student_organisation_errors.DuplicateLevelError: Duplicate level creation attempted: Unique constraint violation - Detail: (raised as a result of query-invoked autoflush; consider using a session.no_autoflush block if this flush is occurring prematurely)
(psycopg2.errors.uniqueviolation) duplicate key value violates unique constraint "academic_levels_name_key"
detail:  key (name)=(jssn) already exists.

[sql: update academic_levels set name=%(name)s, last_modified_at=now() where academic_levels.id = %(academic_levels_id)s::uuid]
[parameters: {'name': 'jssn', 'academic_levels_id': uuid('842301c1-7e05-4c34-ba54-7f41c0a05443')}]
(background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-19 01:28:21,550 - kademia - WARNING - UniqueViolationError | f8aa9991-34a3-4506-aea1-b1fee2237d9e | Duplicate level creation attempted: Unique constraint violation - Detail: (raised as a result of query-invoked autoflush; consider using a session.no_autoflush block if this flush is occurring prematurely)
(psycopg2.errors.uniqueviolation) duplicate key value violates unique constraint "academic_levels_name_key"
detail:  key (name)=(jssn) already exists.

[sql: update academic_levels set name=%(name)s, last_modified_at=now() where academic_levels.id = %(academic_levels_id)s::uuid]
[parameters: {'name': 'jssn', 'academic_levels_id': uuid('842301c1-7e05-4c34-ba54-7f41c0a05443')}]
(background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-19 01:28:43,267 - kademia - INFO - Request started | acfdfe0a-6772-49ff-904b-480587a77472 | PUT /api/v1/students/academic_levels/842301c1-7e05-4c34-ba54-7f41c0a05443
2025-03-19 01:28:43,270 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 01:28:43,270 - sqlalchemy.engine.Engine - INFO - SELECT academic_levels.id AS academic_levels_id, academic_levels.name AS academic_levels_name, academic_levels.description AS academic_levels_description, academic_levels."order" AS academic_levels_order, academic_levels.created_by AS academic_levels_created_by, academic_levels.last_modified_by AS academic_levels_last_modified_by, academic_levels.created_at AS academic_levels_created_at, academic_levels.last_modified_at AS academic_levels_last_modified_at, academic_levels.is_archived AS academic_levels_is_archived, academic_levels.archived_at AS academic_levels_archived_at, academic_levels.archive_reason AS academic_levels_archive_reason, academic_levels.archived_by AS academic_levels_archived_by 
FROM academic_levels 
WHERE academic_levels.is_archived = false AND academic_levels.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-03-19 01:28:43,272 - sqlalchemy.engine.Engine - INFO - [cached since 96.25s ago] {'id_1': UUID('842301c1-7e05-4c34-ba54-7f41c0a05443'), 'param_1': 1}
2025-03-19 01:28:43,274 - sqlalchemy.engine.Engine - INFO - UPDATE academic_levels SET name=%(name)s, "order"=%(order)s, last_modified_at=now() WHERE academic_levels.id = %(academic_levels_id)s::UUID
2025-03-19 01:28:43,275 - sqlalchemy.engine.Engine - INFO - [generated in 0.00063s] {'name': 'Jss7Y', 'order': 6, 'academic_levels_id': UUID('842301c1-7e05-4c34-ba54-7f41c0a05443')}
2025-03-19 01:28:43,277 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-19 01:28:43,279 - kademia - ERROR - Unhandled exception | acfdfe0a-6772-49ff-904b-480587a77472 | Duplicate level creation attempted: Unique constraint violation - Detail: (raised as a result of query-invoked autoflush; consider using a session.no_autoflush block if this flush is occurring prematurely)
(psycopg2.errors.uniqueviolation) duplicate key value violates unique constraint "academic_levels_order_key"
detail:  key ("order")=(6) already exists.

[sql: update academic_levels set name=%(name)s, "order"=%(order)s, last_modified_at=now() where academic_levels.id = %(academic_levels_id)s::uuid]
[parameters: {'name': 'jss7y', 'order': 6, 'academic_levels_id': uuid('842301c1-7e05-4c34-ba54-7f41c0a05443')}]
(background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 111, in receive
    return self.receive_nowait()
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 106, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 124, in receive
    return receiver.item
           ^^^^^^^^^^^^^
AttributeError: 'MemoryObjectItemReceiver' object has no attribute 'item'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 157, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 126, in receive
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\middleware\error_handler.py", line 81, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\fastapi\routing.py", line 214, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\to_thread.py", line 56, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2461, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 962, in run
    result = context.run(func, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\routers\student_organization\academic_levels.py", line 41, in update_academic_level
    return academic_level_crud.update_level(level_id, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\crud\student_organization\academic_levels.py", line 63, in update_level
    updated_level = self.factory.update_academic_level(level_id, data)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\core\factories\student_organization\academic_level.py", line 107, in update_academic_level
    raise DuplicateLevelError(
app.core.errors.student_organisation_errors.DuplicateLevelError: Duplicate level creation attempted: Unique constraint violation - Detail: (raised as a result of query-invoked autoflush; consider using a session.no_autoflush block if this flush is occurring prematurely)
(psycopg2.errors.uniqueviolation) duplicate key value violates unique constraint "academic_levels_order_key"
detail:  key ("order")=(6) already exists.

[sql: update academic_levels set name=%(name)s, "order"=%(order)s, last_modified_at=now() where academic_levels.id = %(academic_levels_id)s::uuid]
[parameters: {'name': 'jss7y', 'order': 6, 'academic_levels_id': uuid('842301c1-7e05-4c34-ba54-7f41c0a05443')}]
(background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-19 01:28:43,287 - kademia - WARNING - UniqueViolationError | acfdfe0a-6772-49ff-904b-480587a77472 | Duplicate level creation attempted: Unique constraint violation - Detail: (raised as a result of query-invoked autoflush; consider using a session.no_autoflush block if this flush is occurring prematurely)
(psycopg2.errors.uniqueviolation) duplicate key value violates unique constraint "academic_levels_order_key"
detail:  key ("order")=(6) already exists.

[sql: update academic_levels set name=%(name)s, "order"=%(order)s, last_modified_at=now() where academic_levels.id = %(academic_levels_id)s::uuid]
[parameters: {'name': 'jss7y', 'order': 6, 'academic_levels_id': uuid('842301c1-7e05-4c34-ba54-7f41c0a05443')}]
(background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-19 01:28:54,716 - kademia - INFO - Request started | 6c82501c-eb24-4a73-be46-c3a769fcfc74 | PUT /api/v1/students/academic_levels/842301c1-7e05-4c34-ba54-7f41c0a05443
2025-03-19 01:28:54,718 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 01:28:54,719 - sqlalchemy.engine.Engine - INFO - SELECT academic_levels.id AS academic_levels_id, academic_levels.name AS academic_levels_name, academic_levels.description AS academic_levels_description, academic_levels."order" AS academic_levels_order, academic_levels.created_by AS academic_levels_created_by, academic_levels.last_modified_by AS academic_levels_last_modified_by, academic_levels.created_at AS academic_levels_created_at, academic_levels.last_modified_at AS academic_levels_last_modified_at, academic_levels.is_archived AS academic_levels_is_archived, academic_levels.archived_at AS academic_levels_archived_at, academic_levels.archive_reason AS academic_levels_archive_reason, academic_levels.archived_by AS academic_levels_archived_by 
FROM academic_levels 
WHERE academic_levels.is_archived = false AND academic_levels.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-03-19 01:28:54,720 - sqlalchemy.engine.Engine - INFO - [cached since 107.7s ago] {'id_1': UUID('842301c1-7e05-4c34-ba54-7f41c0a05443'), 'param_1': 1}
2025-03-19 01:28:54,722 - sqlalchemy.engine.Engine - INFO - UPDATE academic_levels SET name=%(name)s, "order"=%(order)s, last_modified_at=now() WHERE academic_levels.id = %(academic_levels_id)s::UUID
2025-03-19 01:28:54,723 - sqlalchemy.engine.Engine - INFO - [cached since 11.45s ago] {'name': 'Jss7Y', 'order': 60, 'academic_levels_id': UUID('842301c1-7e05-4c34-ba54-7f41c0a05443')}
2025-03-19 01:28:54,725 - sqlalchemy.engine.Engine - INFO - SELECT academic_levels.id AS academic_levels_id, academic_levels.name AS academic_levels_name, academic_levels.description AS academic_levels_description, academic_levels."order" AS academic_levels_order, academic_levels.created_by AS academic_levels_created_by, academic_levels.last_modified_by AS academic_levels_last_modified_by, academic_levels.created_at AS academic_levels_created_at, academic_levels.last_modified_at AS academic_levels_last_modified_at, academic_levels.is_archived AS academic_levels_is_archived, academic_levels.archived_at AS academic_levels_archived_at, academic_levels.archive_reason AS academic_levels_archive_reason, academic_levels.archived_by AS academic_levels_archived_by 
FROM academic_levels 
WHERE academic_levels.is_archived = false AND academic_levels.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-03-19 01:28:54,726 - sqlalchemy.engine.Engine - INFO - [cached since 107.7s ago] {'id_1': UUID('842301c1-7e05-4c34-ba54-7f41c0a05443'), 'param_1': 1}
2025-03-19 01:28:54,727 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-19 01:28:54,730 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 01:28:54,732 - sqlalchemy.engine.Engine - INFO - SELECT academic_levels.id, academic_levels.name, academic_levels.description, academic_levels."order", academic_levels.created_by, academic_levels.last_modified_by, academic_levels.created_at, academic_levels.last_modified_at, academic_levels.is_archived, academic_levels.archived_at, academic_levels.archive_reason, academic_levels.archived_by 
FROM academic_levels 
WHERE academic_levels.id = %(pk_1)s::UUID
2025-03-19 01:28:54,733 - sqlalchemy.engine.Engine - INFO - [cached since 192.6s ago] {'pk_1': UUID('842301c1-7e05-4c34-ba54-7f41c0a05443')}
2025-03-19 01:28:54,740 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-19 01:28:54,784 - kademia - INFO - Request completed | 6c82501c-eb24-4a73-be46-c3a769fcfc74 | Status: 200 | Time: 0.068s
2025-03-19 01:29:10,737 - kademia - INFO - Request started | a612b134-4aca-49c7-966e-c992d3ffd484 | PATCH /api/v1/students/academic_levels/842301c1-7e05-4c34-ba54-7f41c0a05443
2025-03-19 01:29:10,740 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 01:29:10,741 - sqlalchemy.engine.Engine - INFO - SELECT academic_levels.id AS academic_levels_id, academic_levels.name AS academic_levels_name, academic_levels.description AS academic_levels_description, academic_levels."order" AS academic_levels_order, academic_levels.created_by AS academic_levels_created_by, academic_levels.last_modified_by AS academic_levels_last_modified_by, academic_levels.created_at AS academic_levels_created_at, academic_levels.last_modified_at AS academic_levels_last_modified_at, academic_levels.is_archived AS academic_levels_is_archived, academic_levels.archived_at AS academic_levels_archived_at, academic_levels.archive_reason AS academic_levels_archive_reason, academic_levels.archived_by AS academic_levels_archived_by 
FROM academic_levels 
WHERE academic_levels.is_archived = false AND academic_levels.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-03-19 01:29:10,741 - sqlalchemy.engine.Engine - INFO - [cached since 123.7s ago] {'id_1': UUID('842301c1-7e05-4c34-ba54-7f41c0a05443'), 'param_1': 1}
2025-03-19 01:29:10,744 - sqlalchemy.engine.Engine - INFO - UPDATE academic_levels SET last_modified_at=now(), is_archived=%(is_archived)s, archived_at=%(archived_at)s, archive_reason=%(archive_reason)s, archived_by=%(archived_by)s::UUID WHERE academic_levels.id = %(academic_levels_id)s::UUID
2025-03-19 01:29:10,745 - sqlalchemy.engine.Engine - INFO - [generated in 0.00067s] {'is_archived': True, 'archived_at': datetime.datetime(2025, 3, 19, 1, 29, 10, 743296, tzinfo=datetime.timezone.utc), 'archive_reason': 'ERROR', 'archived_by': UUID('00000000-0000-0000-0000-000000000000'), 'academic_levels_id': UUID('842301c1-7e05-4c34-ba54-7f41c0a05443')}
2025-03-19 01:29:10,747 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-19 01:29:10,752 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 01:29:10,753 - sqlalchemy.engine.Engine - INFO - SELECT academic_levels.id, academic_levels.name, academic_levels.description, academic_levels."order", academic_levels.created_by, academic_levels.last_modified_by, academic_levels.created_at, academic_levels.last_modified_at, academic_levels.is_archived, academic_levels.archived_at, academic_levels.archive_reason, academic_levels.archived_by 
FROM academic_levels 
WHERE academic_levels.id = %(pk_1)s::UUID
2025-03-19 01:29:10,754 - sqlalchemy.engine.Engine - INFO - [cached since 208.6s ago] {'pk_1': UUID('842301c1-7e05-4c34-ba54-7f41c0a05443')}
2025-03-19 01:29:10,756 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-19 01:29:10,757 - kademia - INFO - Request completed | a612b134-4aca-49c7-966e-c992d3ffd484 | Status: 204 | Time: 0.020s
2025-03-19 01:29:14,380 - kademia - INFO - Request started | 31eda11e-b4d5-465e-be85-8067da40f459 | PATCH /api/v1/students/academic_levels/842301c1-7e05-4c34-ba54-7f41c0a05443
2025-03-19 01:29:14,383 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 01:29:14,384 - sqlalchemy.engine.Engine - INFO - SELECT academic_levels.id AS academic_levels_id, academic_levels.name AS academic_levels_name, academic_levels.description AS academic_levels_description, academic_levels."order" AS academic_levels_order, academic_levels.created_by AS academic_levels_created_by, academic_levels.last_modified_by AS academic_levels_last_modified_by, academic_levels.created_at AS academic_levels_created_at, academic_levels.last_modified_at AS academic_levels_last_modified_at, academic_levels.is_archived AS academic_levels_is_archived, academic_levels.archived_at AS academic_levels_archived_at, academic_levels.archive_reason AS academic_levels_archive_reason, academic_levels.archived_by AS academic_levels_archived_by 
FROM academic_levels 
WHERE academic_levels.is_archived = false AND academic_levels.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-03-19 01:29:14,384 - sqlalchemy.engine.Engine - INFO - [cached since 127.4s ago] {'id_1': UUID('842301c1-7e05-4c34-ba54-7f41c0a05443'), 'param_1': 1}
2025-03-19 01:29:14,386 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-19 01:29:14,387 - kademia - ERROR - Unhandled exception | 31eda11e-b4d5-465e-be85-8067da40f459 | Academic level with id:842301c1-7e05-4c34-ba54-7f41c0a05443 not found. DETAIL: AcademicLevel not with id 842301c1-7e05-4c34-ba54-7f41c0a05443 not found. DETAIL: object not found
Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 111, in receive
    return self.receive_nowait()
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 106, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 124, in receive
    return receiver.item
           ^^^^^^^^^^^^^
AttributeError: 'MemoryObjectItemReceiver' object has no attribute 'item'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 157, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 126, in receive
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\middleware\error_handler.py", line 81, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\fastapi\routing.py", line 214, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\to_thread.py", line 56, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2461, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 962, in run
    result = context.run(func, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\routers\student_organization\academic_levels.py", line 48, in archive_academic_level
    return academic_level_crud.archive_level(level_id, reason.reason)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\crud\student_organization\academic_levels.py", line 74, in archive_level
    self.factory.archive_academic_level(level_id, reason)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\core\factories\student_organization\academic_level.py", line 125, in archive_academic_level
    raise LevelNotFoundError(id=academic_level_id, detail=str(e))
app.core.errors.student_organisation_errors.LevelNotFoundError: Academic level with id:842301c1-7e05-4c34-ba54-7f41c0a05443 not found. DETAIL: AcademicLevel not with id 842301c1-7e05-4c34-ba54-7f41c0a05443 not found. DETAIL: object not found
2025-03-19 01:29:14,427 - kademia - WARNING - EntityNotFoundError | 31eda11e-b4d5-465e-be85-8067da40f459 | Academic level with id:842301c1-7e05-4c34-ba54-7f41c0a05443 not found. DETAIL: AcademicLevel not with id 842301c1-7e05-4c34-ba54-7f41c0a05443 not found. DETAIL: object not found
2025-03-19 01:29:28,297 - kademia - INFO - Request started | a8405bd7-6368-4e3e-85dd-a771411b39cc | GET /api/v1/archive/students/academic_levels/842301c1-7e05-4c34-ba54-7f41c0a05443
2025-03-19 01:29:28,299 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 01:29:28,301 - sqlalchemy.engine.Engine - INFO - SELECT academic_levels.id AS academic_levels_id, academic_levels.name AS academic_levels_name, academic_levels.description AS academic_levels_description, academic_levels."order" AS academic_levels_order, academic_levels.created_by AS academic_levels_created_by, academic_levels.last_modified_by AS academic_levels_last_modified_by, academic_levels.created_at AS academic_levels_created_at, academic_levels.last_modified_at AS academic_levels_last_modified_at, academic_levels.is_archived AS academic_levels_is_archived, academic_levels.archived_at AS academic_levels_archived_at, academic_levels.archive_reason AS academic_levels_archive_reason, academic_levels.archived_by AS academic_levels_archived_by 
FROM academic_levels 
WHERE academic_levels.is_archived = true AND academic_levels.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-03-19 01:29:28,301 - sqlalchemy.engine.Engine - INFO - [generated in 0.00083s] {'id_1': UUID('842301c1-7e05-4c34-ba54-7f41c0a05443'), 'param_1': 1}
2025-03-19 01:29:28,303 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-19 01:29:28,304 - kademia - INFO - Request completed | a8405bd7-6368-4e3e-85dd-a771411b39cc | Status: 200 | Time: 0.007s
2025-03-19 01:29:38,844 - kademia - INFO - Request started | 18fe8e4a-ae18-4fda-a33b-b6163f4e63de | PATCH /api/v1/archive/students/academic_levels/842301c1-7e05-4c34-ba54-7f41c0a05443
2025-03-19 01:29:38,846 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 01:29:38,847 - sqlalchemy.engine.Engine - INFO - SELECT academic_levels.id AS academic_levels_id, academic_levels.name AS academic_levels_name, academic_levels.description AS academic_levels_description, academic_levels."order" AS academic_levels_order, academic_levels.created_by AS academic_levels_created_by, academic_levels.last_modified_by AS academic_levels_last_modified_by, academic_levels.created_at AS academic_levels_created_at, academic_levels.last_modified_at AS academic_levels_last_modified_at, academic_levels.is_archived AS academic_levels_is_archived, academic_levels.archived_at AS academic_levels_archived_at, academic_levels.archive_reason AS academic_levels_archive_reason, academic_levels.archived_by AS academic_levels_archived_by 
FROM academic_levels 
WHERE academic_levels.is_archived = true AND academic_levels.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-03-19 01:29:38,847 - sqlalchemy.engine.Engine - INFO - [cached since 10.55s ago] {'id_1': UUID('842301c1-7e05-4c34-ba54-7f41c0a05443'), 'param_1': 1}
2025-03-19 01:29:38,851 - sqlalchemy.engine.Engine - INFO - SELECT academic_levels.id AS academic_levels_id, academic_levels.name AS academic_levels_name, academic_levels.description AS academic_levels_description, academic_levels."order" AS academic_levels_order, academic_levels.created_by AS academic_levels_created_by, academic_levels.last_modified_by AS academic_levels_last_modified_by, academic_levels.created_at AS academic_levels_created_at, academic_levels.last_modified_at AS academic_levels_last_modified_at, academic_levels.is_archived AS academic_levels_is_archived, academic_levels.archived_at AS academic_levels_archived_at, academic_levels.archive_reason AS academic_levels_archive_reason, academic_levels.archived_by AS academic_levels_archived_by 
FROM academic_levels 
WHERE academic_levels.is_archived = true AND academic_levels.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-03-19 01:29:38,851 - sqlalchemy.engine.Engine - INFO - [cached since 10.55s ago] {'id_1': UUID('842301c1-7e05-4c34-ba54-7f41c0a05443'), 'param_1': 1}
2025-03-19 01:29:38,854 - sqlalchemy.engine.Engine - INFO - UPDATE academic_levels SET last_modified_at=now(), is_archived=%(is_archived)s WHERE academic_levels.id = %(academic_levels_id)s::UUID
2025-03-19 01:29:38,855 - sqlalchemy.engine.Engine - INFO - [generated in 0.00074s] {'is_archived': False, 'academic_levels_id': UUID('842301c1-7e05-4c34-ba54-7f41c0a05443')}
2025-03-19 01:29:38,856 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-19 01:29:38,863 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 01:29:38,864 - sqlalchemy.engine.Engine - INFO - SELECT academic_levels.id AS academic_levels_id, academic_levels.name AS academic_levels_name, academic_levels.description AS academic_levels_description, academic_levels."order" AS academic_levels_order, academic_levels.created_by AS academic_levels_created_by, academic_levels.last_modified_by AS academic_levels_last_modified_by, academic_levels.created_at AS academic_levels_created_at, academic_levels.last_modified_at AS academic_levels_last_modified_at, academic_levels.is_archived AS academic_levels_is_archived, academic_levels.archived_at AS academic_levels_archived_at, academic_levels.archive_reason AS academic_levels_archive_reason, academic_levels.archived_by AS academic_levels_archived_by 
FROM academic_levels 
WHERE academic_levels.id = %(pk_1)s::UUID
2025-03-19 01:29:38,865 - sqlalchemy.engine.Engine - INFO - [generated in 0.00078s] {'pk_1': UUID('842301c1-7e05-4c34-ba54-7f41c0a05443')}
2025-03-19 01:29:38,867 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-19 01:29:38,881 - kademia - INFO - Request completed | 18fe8e4a-ae18-4fda-a33b-b6163f4e63de | Status: 200 | Time: 0.036s
2025-03-19 01:29:47,479 - kademia - INFO - Request started | 2c38a081-975c-4524-b5ce-798c1f94253d | DELETE /api/v1/students/academic_levels/842301c1-7e05-4c34-ba54-7f41c0a05443
2025-03-19 01:29:47,481 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 01:29:47,481 - sqlalchemy.engine.Engine - INFO - SELECT academic_levels.id AS academic_levels_id, academic_levels.name AS academic_levels_name, academic_levels.description AS academic_levels_description, academic_levels."order" AS academic_levels_order, academic_levels.created_by AS academic_levels_created_by, academic_levels.last_modified_by AS academic_levels_last_modified_by, academic_levels.created_at AS academic_levels_created_at, academic_levels.last_modified_at AS academic_levels_last_modified_at, academic_levels.is_archived AS academic_levels_is_archived, academic_levels.archived_at AS academic_levels_archived_at, academic_levels.archive_reason AS academic_levels_archive_reason, academic_levels.archived_by AS academic_levels_archived_by 
FROM academic_levels 
WHERE academic_levels.is_archived = false AND academic_levels.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-03-19 01:29:47,482 - sqlalchemy.engine.Engine - INFO - [cached since 160.5s ago] {'id_1': UUID('842301c1-7e05-4c34-ba54-7f41c0a05443'), 'param_1': 1}
2025-03-19 01:29:47,485 - sqlalchemy.engine.Engine - INFO - SELECT classes.id AS classes_id, classes.level_id AS classes_level_id, classes.code AS classes_code, classes.mentor_id AS classes_mentor_id, classes.student_rep_id AS classes_student_rep_id, classes.assistant_rep_id AS classes_assistant_rep_id, classes."order" AS classes_order, classes.created_by AS classes_created_by, classes.last_modified_by AS classes_last_modified_by, classes.created_at AS classes_created_at, classes.last_modified_at AS classes_last_modified_at, classes.is_archived AS classes_is_archived, classes.archived_at AS classes_archived_at, classes.archive_reason AS classes_archive_reason, classes.archived_by AS classes_archived_by 
FROM classes 
WHERE %(param_1)s::UUID = classes.level_id
2025-03-19 01:29:47,486 - sqlalchemy.engine.Engine - INFO - [generated in 0.00078s] {'param_1': UUID('842301c1-7e05-4c34-ba54-7f41c0a05443')}
2025-03-19 01:29:47,500 - sqlalchemy.engine.Engine - INFO - SELECT academic_level_subjects.id AS academic_level_subjects_id, academic_level_subjects.level_id AS academic_level_subjects_level_id, academic_level_subjects.subject_id AS academic_level_subjects_subject_id, academic_level_subjects.educator_id AS academic_level_subjects_educator_id, academic_level_subjects.is_elective AS academic_level_subjects_is_elective, academic_level_subjects.academic_year AS academic_level_subjects_academic_year, academic_level_subjects.curriculum_url AS academic_level_subjects_curriculum_url, academic_level_subjects.created_by AS academic_level_subjects_created_by, academic_level_subjects.last_modified_by AS academic_level_subjects_last_modified_by, academic_level_subjects.created_at AS academic_level_subjects_created_at, academic_level_subjects.last_modified_at AS academic_level_subjects_last_modified_at, academic_level_subjects.is_archived AS academic_level_subjects_is_archived, academic_level_subjects.archived_at AS academic_level_subjects_archived_at, academic_level_subjects.archive_reason AS academic_level_subjects_archive_reason, academic_level_subjects.archived_by AS academic_level_subjects_archived_by 
FROM academic_level_subjects 
WHERE %(param_1)s::UUID = academic_level_subjects.level_id
2025-03-19 01:29:47,501 - sqlalchemy.engine.Engine - INFO - [generated in 0.00080s] {'param_1': UUID('842301c1-7e05-4c34-ba54-7f41c0a05443')}
2025-03-19 01:29:47,513 - sqlalchemy.engine.Engine - INFO - SELECT students.student_id AS students_student_id, students.user_type AS students_user_type, students.access_level AS students_access_level, students.status AS students_status, students.date_of_birth AS students_date_of_birth, students.image_url AS students_image_url, students.class_id AS students_class_id, students.level_id AS students_level_id, students.department_id AS students_department_id, students.guardian_id AS students_guardian_id, students.is_repeating AS students_is_repeating, students.admission_date AS students_admission_date, students.date_left AS students_date_left, students.graduation_date AS students_graduation_date, students.id AS students_id, students.password_hash AS students_password_hash, students.first_name AS students_first_name, students.last_name AS students_last_name, students.gender AS students_gender, students.last_login AS students_last_login, students.deletion_eligible AS students_deletion_eligible, students.created_by AS students_created_by, students.last_modified_by AS students_last_modified_by, students.created_at AS students_created_at, students.last_modified_at AS students_last_modified_at, students.is_archived AS students_is_archived, students.archived_at AS students_archived_at, students.archive_reason AS students_archive_reason, students.archived_by AS students_archived_by 
FROM students 
WHERE %(param_1)s::UUID = students.level_id
2025-03-19 01:29:47,513 - sqlalchemy.engine.Engine - INFO - [generated in 0.00078s] {'param_1': UUID('842301c1-7e05-4c34-ba54-7f41c0a05443')}
2025-03-19 01:29:47,515 - sqlalchemy.engine.Engine - INFO - DELETE FROM academic_levels WHERE academic_levels.id = %(id)s::UUID
2025-03-19 01:29:47,515 - sqlalchemy.engine.Engine - INFO - [generated in 0.00043s] {'id': UUID('842301c1-7e05-4c34-ba54-7f41c0a05443')}
2025-03-19 01:29:47,529 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-19 01:29:47,531 - kademia - INFO - Request completed | 2c38a081-975c-4524-b5ce-798c1f94253d | Status: 204 | Time: 0.052s
2025-03-19 01:30:14,160 - kademia - INFO - Request started | fd67ac78-801b-4d7e-ad21-9730030aac53 | PATCH /api/v1/students/academic_levels/69297e55-a785-472f-9e3f-21c857cba53d
2025-03-19 01:30:14,162 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 01:30:14,162 - sqlalchemy.engine.Engine - INFO - SELECT academic_levels.id AS academic_levels_id, academic_levels.name AS academic_levels_name, academic_levels.description AS academic_levels_description, academic_levels."order" AS academic_levels_order, academic_levels.created_by AS academic_levels_created_by, academic_levels.last_modified_by AS academic_levels_last_modified_by, academic_levels.created_at AS academic_levels_created_at, academic_levels.last_modified_at AS academic_levels_last_modified_at, academic_levels.is_archived AS academic_levels_is_archived, academic_levels.archived_at AS academic_levels_archived_at, academic_levels.archive_reason AS academic_levels_archive_reason, academic_levels.archived_by AS academic_levels_archived_by 
FROM academic_levels 
WHERE academic_levels.is_archived = false AND academic_levels.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-03-19 01:30:14,164 - sqlalchemy.engine.Engine - INFO - [cached since 187.1s ago] {'id_1': UUID('69297e55-a785-472f-9e3f-21c857cba53d'), 'param_1': 1}
2025-03-19 01:30:14,166 - sqlalchemy.engine.Engine - INFO - UPDATE academic_levels SET last_modified_at=now(), is_archived=%(is_archived)s, archived_at=%(archived_at)s, archive_reason=%(archive_reason)s, archived_by=%(archived_by)s::UUID WHERE academic_levels.id = %(academic_levels_id)s::UUID
2025-03-19 01:30:14,166 - sqlalchemy.engine.Engine - INFO - [cached since 63.42s ago] {'is_archived': True, 'archived_at': datetime.datetime(2025, 3, 19, 1, 30, 14, 165153, tzinfo=datetime.timezone.utc), 'archive_reason': 'ERROR', 'archived_by': UUID('00000000-0000-0000-0000-000000000000'), 'academic_levels_id': UUID('69297e55-a785-472f-9e3f-21c857cba53d')}
2025-03-19 01:30:14,167 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-19 01:30:14,170 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 01:30:14,171 - sqlalchemy.engine.Engine - INFO - SELECT academic_levels.id, academic_levels.name, academic_levels.description, academic_levels."order", academic_levels.created_by, academic_levels.last_modified_by, academic_levels.created_at, academic_levels.last_modified_at, academic_levels.is_archived, academic_levels.archived_at, academic_levels.archive_reason, academic_levels.archived_by 
FROM academic_levels 
WHERE academic_levels.id = %(pk_1)s::UUID
2025-03-19 01:30:14,171 - sqlalchemy.engine.Engine - INFO - [cached since 272s ago] {'pk_1': UUID('69297e55-a785-472f-9e3f-21c857cba53d')}
2025-03-19 01:30:14,173 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-19 01:30:14,175 - kademia - INFO - Request completed | fd67ac78-801b-4d7e-ad21-9730030aac53 | Status: 204 | Time: 0.014s
2025-03-19 01:30:26,271 - kademia - INFO - Request started | 9abb16f2-ef8f-4091-b61f-bd36d50f4989 | DELETE /api/v1/archive/students/academic_levels/{level_id}
2025-03-19 01:30:26,273 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 01:30:26,274 - sqlalchemy.engine.Engine - INFO - SELECT academic_levels.id AS academic_levels_id, academic_levels.name AS academic_levels_name, academic_levels.description AS academic_levels_description, academic_levels."order" AS academic_levels_order, academic_levels.created_by AS academic_levels_created_by, academic_levels.last_modified_by AS academic_levels_last_modified_by, academic_levels.created_at AS academic_levels_created_at, academic_levels.last_modified_at AS academic_levels_last_modified_at, academic_levels.is_archived AS academic_levels_is_archived, academic_levels.archived_at AS academic_levels_archived_at, academic_levels.archive_reason AS academic_levels_archive_reason, academic_levels.archived_by AS academic_levels_archived_by 
FROM academic_levels 
WHERE academic_levels.is_archived = true AND academic_levels.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-03-19 01:30:26,276 - sqlalchemy.engine.Engine - INFO - [cached since 57.98s ago] {'id_1': UUID('69297e55-a785-472f-9e3f-21c857cba53d'), 'param_1': 1}
2025-03-19 01:30:26,278 - sqlalchemy.engine.Engine - INFO - SELECT classes.id AS classes_id, classes.level_id AS classes_level_id, classes.code AS classes_code, classes.mentor_id AS classes_mentor_id, classes.student_rep_id AS classes_student_rep_id, classes.assistant_rep_id AS classes_assistant_rep_id, classes."order" AS classes_order, classes.created_by AS classes_created_by, classes.last_modified_by AS classes_last_modified_by, classes.created_at AS classes_created_at, classes.last_modified_at AS classes_last_modified_at, classes.is_archived AS classes_is_archived, classes.archived_at AS classes_archived_at, classes.archive_reason AS classes_archive_reason, classes.archived_by AS classes_archived_by 
FROM classes 
WHERE %(param_1)s::UUID = classes.level_id
2025-03-19 01:30:26,279 - sqlalchemy.engine.Engine - INFO - [cached since 38.79s ago] {'param_1': UUID('69297e55-a785-472f-9e3f-21c857cba53d')}
2025-03-19 01:30:26,282 - sqlalchemy.engine.Engine - INFO - SELECT academic_level_subjects.id AS academic_level_subjects_id, academic_level_subjects.level_id AS academic_level_subjects_level_id, academic_level_subjects.subject_id AS academic_level_subjects_subject_id, academic_level_subjects.educator_id AS academic_level_subjects_educator_id, academic_level_subjects.is_elective AS academic_level_subjects_is_elective, academic_level_subjects.academic_year AS academic_level_subjects_academic_year, academic_level_subjects.curriculum_url AS academic_level_subjects_curriculum_url, academic_level_subjects.created_by AS academic_level_subjects_created_by, academic_level_subjects.last_modified_by AS academic_level_subjects_last_modified_by, academic_level_subjects.created_at AS academic_level_subjects_created_at, academic_level_subjects.last_modified_at AS academic_level_subjects_last_modified_at, academic_level_subjects.is_archived AS academic_level_subjects_is_archived, academic_level_subjects.archived_at AS academic_level_subjects_archived_at, academic_level_subjects.archive_reason AS academic_level_subjects_archive_reason, academic_level_subjects.archived_by AS academic_level_subjects_archived_by 
FROM academic_level_subjects 
WHERE %(param_1)s::UUID = academic_level_subjects.level_id
2025-03-19 01:30:26,283 - sqlalchemy.engine.Engine - INFO - [cached since 38.78s ago] {'param_1': UUID('69297e55-a785-472f-9e3f-21c857cba53d')}
2025-03-19 01:30:26,284 - sqlalchemy.engine.Engine - INFO - SELECT students.student_id AS students_student_id, students.user_type AS students_user_type, students.access_level AS students_access_level, students.status AS students_status, students.date_of_birth AS students_date_of_birth, students.image_url AS students_image_url, students.class_id AS students_class_id, students.level_id AS students_level_id, students.department_id AS students_department_id, students.guardian_id AS students_guardian_id, students.is_repeating AS students_is_repeating, students.admission_date AS students_admission_date, students.date_left AS students_date_left, students.graduation_date AS students_graduation_date, students.id AS students_id, students.password_hash AS students_password_hash, students.first_name AS students_first_name, students.last_name AS students_last_name, students.gender AS students_gender, students.last_login AS students_last_login, students.deletion_eligible AS students_deletion_eligible, students.created_by AS students_created_by, students.last_modified_by AS students_last_modified_by, students.created_at AS students_created_at, students.last_modified_at AS students_last_modified_at, students.is_archived AS students_is_archived, students.archived_at AS students_archived_at, students.archive_reason AS students_archive_reason, students.archived_by AS students_archived_by 
FROM students 
WHERE %(param_1)s::UUID = students.level_id
2025-03-19 01:30:26,285 - sqlalchemy.engine.Engine - INFO - [cached since 38.77s ago] {'param_1': UUID('69297e55-a785-472f-9e3f-21c857cba53d')}
2025-03-19 01:30:26,286 - sqlalchemy.engine.Engine - INFO - DELETE FROM academic_levels WHERE academic_levels.id = %(id)s::UUID
2025-03-19 01:30:26,286 - sqlalchemy.engine.Engine - INFO - [cached since 38.77s ago] {'id': UUID('69297e55-a785-472f-9e3f-21c857cba53d')}
2025-03-19 01:30:26,288 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-19 01:30:26,293 - kademia - INFO - Request completed | 9abb16f2-ef8f-4091-b61f-bd36d50f4989 | Status: 204 | Time: 0.021s
2025-03-19 01:30:46,809 - kademia - INFO - Request started | 5d2044ca-3508-4d4d-b91e-0db7c2c161cd | GET /api/v1/students/academic_levels/69297e55-a785-472f-9e3f-21c857cba53d
2025-03-19 01:30:46,811 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 01:30:46,812 - sqlalchemy.engine.Engine - INFO - SELECT academic_levels.id AS academic_levels_id, academic_levels.name AS academic_levels_name, academic_levels.description AS academic_levels_description, academic_levels."order" AS academic_levels_order, academic_levels.created_by AS academic_levels_created_by, academic_levels.last_modified_by AS academic_levels_last_modified_by, academic_levels.created_at AS academic_levels_created_at, academic_levels.last_modified_at AS academic_levels_last_modified_at, academic_levels.is_archived AS academic_levels_is_archived, academic_levels.archived_at AS academic_levels_archived_at, academic_levels.archive_reason AS academic_levels_archive_reason, academic_levels.archived_by AS academic_levels_archived_by 
FROM academic_levels 
WHERE academic_levels.is_archived = false AND academic_levels.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-03-19 01:30:46,812 - sqlalchemy.engine.Engine - INFO - [cached since 219.8s ago] {'id_1': UUID('69297e55-a785-472f-9e3f-21c857cba53d'), 'param_1': 1}
2025-03-19 01:30:46,815 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-19 01:30:46,816 - kademia - ERROR - Unhandled exception | 5d2044ca-3508-4d4d-b91e-0db7c2c161cd | Academic level with id:69297e55-a785-472f-9e3f-21c857cba53d not found. DETAIL: AcademicLevel not with id 69297e55-a785-472f-9e3f-21c857cba53d not found. DETAIL: Record not found
Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 111, in receive
    return self.receive_nowait()
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 106, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 124, in receive
    return receiver.item
           ^^^^^^^^^^^^^
AttributeError: 'MemoryObjectItemReceiver' object has no attribute 'item'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 157, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 126, in receive
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\middleware\error_handler.py", line 81, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\fastapi\routing.py", line 214, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\to_thread.py", line 56, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2461, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 962, in run
    result = context.run(func, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\routers\student_organization\academic_levels.py", line 34, in get_academic_level
    return academic_level_crud.get_level(level_id)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\crud\student_organization\academic_levels.py", line 41, in get_level
    level = self.factory.get_academic_level(level_id)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\core\factories\student_organization\academic_level.py", line 66, in get_academic_level
    raise LevelNotFoundError(id=academic_level_id, detail= str(e))
app.core.errors.student_organisation_errors.LevelNotFoundError: Academic level with id:69297e55-a785-472f-9e3f-21c857cba53d not found. DETAIL: AcademicLevel not with id 69297e55-a785-472f-9e3f-21c857cba53d not found. DETAIL: Record not found
2025-03-19 01:30:46,821 - kademia - WARNING - EntityNotFoundError | 5d2044ca-3508-4d4d-b91e-0db7c2c161cd | Academic level with id:69297e55-a785-472f-9e3f-21c857cba53d not found. DETAIL: AcademicLevel not with id 69297e55-a785-472f-9e3f-21c857cba53d not found. DETAIL: Record not found
2025-03-19 01:33:14,292 - kademia - INFO - Application started
2025-03-19 01:33:14,313 - kademia - INFO - Application started
2025-03-19 01:33:17,396 - kademia - INFO - Request started | ae9058e4-5e2e-4843-bc60-2f5f1fba6840 | GET /docs
2025-03-19 01:33:17,398 - kademia - INFO - Request completed | ae9058e4-5e2e-4843-bc60-2f5f1fba6840 | Status: 200 | Time: 0.002s
2025-03-19 01:33:17,607 - kademia - INFO - Request started | 2cbb9dfb-1af3-48da-9e7d-16920b54b3f9 | GET /openapi.json
2025-03-19 01:33:17,720 - kademia - INFO - Request completed | 2cbb9dfb-1af3-48da-9e7d-16920b54b3f9 | Status: 200 | Time: 0.113s
2025-03-19 01:40:01,996 - kademia - INFO - Application started
2025-03-19 01:40:01,997 - kademia - INFO - Application started
2025-03-19 02:03:04,168 - kademia - INFO - Application started
2025-03-19 02:03:04,169 - kademia - INFO - Application started
2025-03-19 02:03:04,177 - kademia - INFO - Request started | a45a3b84-dff9-4d75-8515-4c8a42e13934 | POST /api/v1/students/academic_levels/
2025-03-19 02:03:04,255 - kademia - ERROR - Unhandled exception | a45a3b84-dff9-4d75-8515-4c8a42e13934 | Mapper 'Mapper[Educator(educators)]' has no property 'mentored_class'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2520, in get_property
    return self._props[key]
           ~~~~~~~~~~~^^^^^
KeyError: 'mentored_class'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\middleware\error_handler.py", line 81, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\fastapi\routing.py", line 214, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\to_thread.py", line 56, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2461, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 962, in run
    result = context.run(func, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\routers\student_organization\academic_levels.py", line 21, in create_level
    return academic_level_crud.create_level(data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\crud\student_organization\academic_levels.py", line 30, in create_level
    level = self.factory.create_academic_level(data)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\core\factories\student_organization\academic_level.py", line 31, in create_academic_level
    academic_level = AcademicLevel(
                     ^^^^^^^^^^^^^^
  File "<string>", line 4, in __init__
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\sqlalchemy\orm\state.py", line 566, in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\sqlalchemy\event\attr.py", line 497, in __call__
    fn(*args, **kw)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4407, in _event_on_init
    instrumenting_mapper._check_configure()
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2399, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4215, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4256, in _do_configure_registries
    mapper._post_configure_properties()
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2416, in _post_configure_properties
    prop.init()
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 589, in init
    self.do_init()
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1647, in do_init
    self._generate_backref()
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2133, in _generate_backref
    self._add_reverse_property(self.back_populates)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1578, in _add_reverse_property
    other = self.mapper.get_property(key, _configure_mappers=False)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2522, in get_property
    raise sa_exc.InvalidRequestError(
sqlalchemy.exc.InvalidRequestError: Mapper 'Mapper[Educator(educators)]' has no property 'mentored_class'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-03-19 02:03:04,284 - kademia - ERROR - Unhandled exception | a45a3b84-dff9-4d75-8515-4c8a42e13934 | Mapper 'Mapper[Educator(educators)]' has no property 'mentored_class'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2520, in get_property
    return self._props[key]
           ~~~~~~~~~~~^^^^^
KeyError: 'mentored_class'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\middleware\error_handler.py", line 81, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\fastapi\routing.py", line 214, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\to_thread.py", line 56, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2461, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 962, in run
    result = context.run(func, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\routers\student_organization\academic_levels.py", line 21, in create_level
    return academic_level_crud.create_level(data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\crud\student_organization\academic_levels.py", line 30, in create_level
    level = self.factory.create_academic_level(data)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\core\factories\student_organization\academic_level.py", line 31, in create_academic_level
    academic_level = AcademicLevel(
                     ^^^^^^^^^^^^^^
  File "<string>", line 4, in __init__
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\sqlalchemy\orm\state.py", line 566, in _initialize_instance
    manager.dispatch.init(self, args, kwargs)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\sqlalchemy\event\attr.py", line 497, in __call__
    fn(*args, **kw)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4407, in _event_on_init
    instrumenting_mapper._check_configure()
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2399, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4215, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4256, in _do_configure_registries
    mapper._post_configure_properties()
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2416, in _post_configure_properties
    prop.init()
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 589, in init
    self.do_init()
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1647, in do_init
    self._generate_backref()
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2133, in _generate_backref
    self._add_reverse_property(self.back_populates)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1578, in _add_reverse_property
    other = self.mapper.get_property(key, _configure_mappers=False)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2522, in get_property
    raise sa_exc.InvalidRequestError(
sqlalchemy.exc.InvalidRequestError: Mapper 'Mapper[Educator(educators)]' has no property 'mentored_class'.  If this property was indicated from other mappers or configure events, ensure registry.configure() has been called.
2025-03-19 02:04:33,724 - kademia - INFO - Application started
2025-03-19 02:04:33,729 - kademia - INFO - Application started
2025-03-19 02:06:13,168 - kademia - INFO - Application started
2025-03-19 02:06:15,689 - kademia - INFO - Request started | c7d391f7-b80e-4aac-8aed-84711ed7294e | GET /
2025-03-19 02:06:15,696 - kademia - INFO - Request completed | c7d391f7-b80e-4aac-8aed-84711ed7294e | Status: 200 | Time: 0.006s
2025-03-19 02:06:15,911 - kademia - INFO - Request started | 92fe052a-8aa1-4c76-874d-db7590572436 | GET /favicon.ico
2025-03-19 02:06:15,913 - kademia - INFO - Request completed | 92fe052a-8aa1-4c76-874d-db7590572436 | Status: 404 | Time: 0.001s
2025-03-19 02:06:23,553 - kademia - INFO - Request started | da04cf6c-19d9-4191-afea-97c2f8b0e2ad | GET /docs
2025-03-19 02:06:23,556 - kademia - INFO - Request completed | da04cf6c-19d9-4191-afea-97c2f8b0e2ad | Status: 200 | Time: 0.001s
2025-03-19 02:06:23,748 - kademia - INFO - Request started | 4ae1e153-444a-4250-b317-9b66854909e7 | GET /openapi.json
2025-03-19 02:06:23,882 - kademia - INFO - Request completed | 4ae1e153-444a-4250-b317-9b66854909e7 | Status: 200 | Time: 0.133s
2025-03-19 02:06:37,596 - kademia - INFO - Request started | 6e91a108-63aa-4cbd-a451-33762629ae75 | POST /api/v1/students/academic_levels/
2025-03-19 02:06:37,916 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-03-19 02:06:37,916 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-03-19 02:06:37,918 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-03-19 02:06:37,919 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-03-19 02:06:37,919 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-03-19 02:06:37,920 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-03-19 02:06:37,922 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 02:06:37,925 - sqlalchemy.engine.Engine - INFO - INSERT INTO academic_levels (id, name, description, "order", created_by, last_modified_by, created_at, last_modified_at, is_archived, archived_at, archive_reason, archived_by) VALUES (%(id)s::UUID, %(name)s, %(description)s, %(order)s, %(created_by)s::UUID, %(last_modified_by)s::UUID, now(), now(), %(is_archived)s, %(archived_at)s, %(archive_reason)s, %(archived_by)s::UUID) RETURNING academic_levels.created_at, academic_levels.last_modified_at
2025-03-19 02:06:37,927 - sqlalchemy.engine.Engine - INFO - [generated in 0.00083s] {'id': UUID('b7aeece1-55a8-41c2-bf8d-2f9d124366a1'), 'name': 'Jss1', 'description': 'First Level In The Secondary School System', 'order': 1, 'created_by': UUID('00000000-0000-0000-0000-000000000000'), 'last_modified_by': UUID('00000000-0000-0000-0000-000000000000'), 'is_archived': False, 'archived_at': None, 'archive_reason': None, 'archived_by': None}
2025-03-19 02:06:37,940 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-19 02:06:37,942 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 02:06:37,946 - sqlalchemy.engine.Engine - INFO - SELECT academic_levels.id, academic_levels.name, academic_levels.description, academic_levels."order", academic_levels.created_by, academic_levels.last_modified_by, academic_levels.created_at, academic_levels.last_modified_at, academic_levels.is_archived, academic_levels.archived_at, academic_levels.archive_reason, academic_levels.archived_by 
FROM academic_levels 
WHERE academic_levels.id = %(pk_1)s::UUID
2025-03-19 02:06:37,947 - sqlalchemy.engine.Engine - INFO - [generated in 0.00085s] {'pk_1': UUID('b7aeece1-55a8-41c2-bf8d-2f9d124366a1')}
2025-03-19 02:06:37,951 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-19 02:06:37,952 - kademia - INFO - Request completed | 6e91a108-63aa-4cbd-a451-33762629ae75 | Status: 201 | Time: 0.356s
2025-03-19 02:07:21,655 - kademia - INFO - Request started | 2166b1dd-09cf-4abb-bae0-6e79b53da15e | POST /api/v1/students/student_organization/
2025-03-19 02:07:21,658 - kademia - INFO - Request completed | 2166b1dd-09cf-4abb-bae0-6e79b53da15e | Status: 422 | Time: 0.002s
2025-03-19 02:07:56,200 - kademia - INFO - Request started | eb812b32-7676-47d4-89dc-d3b83b055488 | POST /api/v1/students/student_organization/
2025-03-19 02:07:56,202 - kademia - INFO - Request completed | eb812b32-7676-47d4-89dc-d3b83b055488 | Status: 422 | Time: 0.001s
2025-03-19 02:08:50,653 - kademia - INFO - Request started | f783c67c-01eb-43fd-814c-68f2140e1c87 | POST /api/v1/students/student_organization/
2025-03-19 02:08:50,660 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 02:08:50,663 - sqlalchemy.engine.Engine - INFO - INSERT INTO classes (id, level_id, code, supervisor_id, student_rep_id, assistant_rep_id, "order", created_by, last_modified_by, created_at, last_modified_at, is_archived, archived_at, archive_reason, archived_by) VALUES (%(id)s::UUID, %(level_id)s::UUID, %(code)s, %(supervisor_id)s::UUID, %(student_rep_id)s::UUID, %(assistant_rep_id)s::UUID, %(order)s, %(created_by)s::UUID, %(last_modified_by)s::UUID, now(), now(), %(is_archived)s, %(archived_at)s, %(archive_reason)s, %(archived_by)s::UUID) RETURNING classes.created_at, classes.last_modified_at
2025-03-19 02:08:50,665 - sqlalchemy.engine.Engine - INFO - [generated in 0.00123s] {'id': UUID('fc16463e-f327-4315-8ec8-2a45fa6da560'), 'level_id': UUID('b7aeece1-55a8-41c2-bf8d-2f9d124366a5'), 'code': 'A', 'supervisor_id': None, 'student_rep_id': None, 'assistant_rep_id': None, 'order': 1, 'created_by': UUID('00000000-0000-0000-0000-000000000000'), 'last_modified_by': UUID('00000000-0000-0000-0000-000000000000'), 'is_archived': False, 'archived_at': None, 'archive_reason': None, 'archived_by': None}
2025-03-19 02:08:50,679 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-19 02:08:50,682 - kademia - ERROR - Unhandled exception | f783c67c-01eb-43fd-814c-68f2140e1c87 | Error during during fk insertion of Academic Level with id:b7aeece1-55a8-41c2-bf8d-2f9d124366a5 during create operation. Detail Foreign key constraint violation during create operation. Detail: (psycopg2.errors.ForeignKeyViolation) insert or update on table "classes" violates foreign key constraint "fk_classes_academic_levels_level_id"
DETAIL:  Key (level_id)=(b7aeece1-55a8-41c2-bf8d-2f9d124366a5) is not present in table "academic_levels".

[SQL: INSERT INTO classes (id, level_id, code, supervisor_id, student_rep_id, assistant_rep_id, "order", created_by, last_modified_by, created_at, last_modified_at, is_archived, archived_at, archive_reason, archived_by) VALUES (%(id)s::UUID, %(level_id)s::UUID, %(code)s, %(supervisor_id)s::UUID, %(student_rep_id)s::UUID, %(assistant_rep_id)s::UUID, %(order)s, %(created_by)s::UUID, %(last_modified_by)s::UUID, now(), now(), %(is_archived)s, %(archived_at)s, %(archive_reason)s, %(archived_by)s::UUID) RETURNING classes.created_at, classes.last_modified_at]
[parameters: {'id': UUID('fc16463e-f327-4315-8ec8-2a45fa6da560'), 'level_id': UUID('b7aeece1-55a8-41c2-bf8d-2f9d124366a5'), 'code': 'A', 'supervisor_id': None, 'student_rep_id': None, 'assistant_rep_id': None, 'order': 1, 'created_by': UUID('00000000-0000-0000-0000-000000000000'), 'last_modified_by': UUID('00000000-0000-0000-0000-000000000000'), 'is_archived': False, 'archived_at': None, 'archive_reason': None, 'archived_by': None}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 111, in receive
    return self.receive_nowait()
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 106, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 124, in receive
    return receiver.item
           ^^^^^^^^^^^^^
AttributeError: 'MemoryObjectItemReceiver' object has no attribute 'item'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 157, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 126, in receive
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\middleware\error_handler.py", line 81, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\fastapi\routing.py", line 214, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\to_thread.py", line 56, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2461, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 962, in run
    result = context.run(func, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\routers\student_organization\classes.py", line 19, in create_class
    return class_crud.create_class(data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\crud\student_organization\classes.py", line 30, in create_class
    new_class = self.factory.create_class(data)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\core\factories\student_organization\classes.py", line 75, in create_class
    raise error_class(id=entity_id, detail=str(e), action='create')
app.core.errors.student_organisation_errors.RelatedLevelNotFoundError: Error during during fk insertion of Academic Level with id:b7aeece1-55a8-41c2-bf8d-2f9d124366a5 during create operation. Detail Foreign key constraint violation during create operation. Detail: (psycopg2.errors.ForeignKeyViolation) insert or update on table "classes" violates foreign key constraint "fk_classes_academic_levels_level_id"
DETAIL:  Key (level_id)=(b7aeece1-55a8-41c2-bf8d-2f9d124366a5) is not present in table "academic_levels".

[SQL: INSERT INTO classes (id, level_id, code, supervisor_id, student_rep_id, assistant_rep_id, "order", created_by, last_modified_by, created_at, last_modified_at, is_archived, archived_at, archive_reason, archived_by) VALUES (%(id)s::UUID, %(level_id)s::UUID, %(code)s, %(supervisor_id)s::UUID, %(student_rep_id)s::UUID, %(assistant_rep_id)s::UUID, %(order)s, %(created_by)s::UUID, %(last_modified_by)s::UUID, now(), now(), %(is_archived)s, %(archived_at)s, %(archive_reason)s, %(archived_by)s::UUID) RETURNING classes.created_at, classes.last_modified_at]
[parameters: {'id': UUID('fc16463e-f327-4315-8ec8-2a45fa6da560'), 'level_id': UUID('b7aeece1-55a8-41c2-bf8d-2f9d124366a5'), 'code': 'A', 'supervisor_id': None, 'student_rep_id': None, 'assistant_rep_id': None, 'order': 1, 'created_by': UUID('00000000-0000-0000-0000-000000000000'), 'last_modified_by': UUID('00000000-0000-0000-0000-000000000000'), 'is_archived': False, 'archived_at': None, 'archive_reason': None, 'archived_by': None}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-19 02:08:50,701 - kademia - WARNING - RelationshipError | f783c67c-01eb-43fd-814c-68f2140e1c87 | Error during during fk insertion of Academic Level with id:b7aeece1-55a8-41c2-bf8d-2f9d124366a5 during create operation. Detail Foreign key constraint violation during create operation. Detail: (psycopg2.errors.ForeignKeyViolation) insert or update on table "classes" violates foreign key constraint "fk_classes_academic_levels_level_id"
DETAIL:  Key (level_id)=(b7aeece1-55a8-41c2-bf8d-2f9d124366a5) is not present in table "academic_levels".

[SQL: INSERT INTO classes (id, level_id, code, supervisor_id, student_rep_id, assistant_rep_id, "order", created_by, last_modified_by, created_at, last_modified_at, is_archived, archived_at, archive_reason, archived_by) VALUES (%(id)s::UUID, %(level_id)s::UUID, %(code)s, %(supervisor_id)s::UUID, %(student_rep_id)s::UUID, %(assistant_rep_id)s::UUID, %(order)s, %(created_by)s::UUID, %(last_modified_by)s::UUID, now(), now(), %(is_archived)s, %(archived_at)s, %(archive_reason)s, %(archived_by)s::UUID) RETURNING classes.created_at, classes.last_modified_at]
[parameters: {'id': UUID('fc16463e-f327-4315-8ec8-2a45fa6da560'), 'level_id': UUID('b7aeece1-55a8-41c2-bf8d-2f9d124366a5'), 'code': 'A', 'supervisor_id': None, 'student_rep_id': None, 'assistant_rep_id': None, 'order': 1, 'created_by': UUID('00000000-0000-0000-0000-000000000000'), 'last_modified_by': UUID('00000000-0000-0000-0000-000000000000'), 'is_archived': False, 'archived_at': None, 'archive_reason': None, 'archived_by': None}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-19 02:10:08,547 - kademia - INFO - Request started | e9bd6a75-a832-410a-8a0c-7192d70672bd | POST /api/v1/students/student_organization/
2025-03-19 02:10:08,550 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 02:10:08,550 - sqlalchemy.engine.Engine - INFO - INSERT INTO classes (id, level_id, code, supervisor_id, student_rep_id, assistant_rep_id, "order", created_by, last_modified_by, created_at, last_modified_at, is_archived, archived_at, archive_reason, archived_by) VALUES (%(id)s::UUID, %(level_id)s::UUID, %(code)s, %(supervisor_id)s::UUID, %(student_rep_id)s::UUID, %(assistant_rep_id)s::UUID, %(order)s, %(created_by)s::UUID, %(last_modified_by)s::UUID, now(), now(), %(is_archived)s, %(archived_at)s, %(archive_reason)s, %(archived_by)s::UUID) RETURNING classes.created_at, classes.last_modified_at
2025-03-19 02:10:08,552 - sqlalchemy.engine.Engine - INFO - [cached since 77.89s ago] {'id': UUID('6d3b633d-519a-4307-b042-2248f9d11d97'), 'level_id': UUID('b7aeece1-55a8-41c2-bf8d-2f9d124366a1'), 'code': 'A', 'supervisor_id': None, 'student_rep_id': None, 'assistant_rep_id': None, 'order': 1, 'created_by': UUID('00000000-0000-0000-0000-000000000000'), 'last_modified_by': UUID('00000000-0000-0000-0000-000000000000'), 'is_archived': False, 'archived_at': None, 'archive_reason': None, 'archived_by': None}
2025-03-19 02:10:08,555 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-19 02:10:08,561 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 02:10:08,564 - sqlalchemy.engine.Engine - INFO - SELECT classes.id, classes.level_id, classes.code, classes.supervisor_id, classes.student_rep_id, classes.assistant_rep_id, classes."order", classes.created_by, classes.last_modified_by, classes.created_at, classes.last_modified_at, classes.is_archived, classes.archived_at, classes.archive_reason, classes.archived_by 
FROM classes 
WHERE classes.id = %(pk_1)s::UUID
2025-03-19 02:10:08,565 - sqlalchemy.engine.Engine - INFO - [generated in 0.00080s] {'pk_1': UUID('6d3b633d-519a-4307-b042-2248f9d11d97')}
2025-03-19 02:10:08,568 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-19 02:10:08,571 - kademia - INFO - Request completed | e9bd6a75-a832-410a-8a0c-7192d70672bd | Status: 201 | Time: 0.023s
2025-03-19 02:10:47,896 - kademia - INFO - Application started
2025-03-19 02:11:22,376 - kademia - INFO - Request started | 4201829c-601d-45fc-ad20-576d5c677069 | POST /api/v1/students/student_organization/
2025-03-19 02:11:22,597 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-03-19 02:11:22,598 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-03-19 02:11:22,599 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-03-19 02:11:22,600 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-03-19 02:11:22,601 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-03-19 02:11:22,601 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-03-19 02:11:22,603 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 02:11:22,605 - sqlalchemy.engine.Engine - INFO - INSERT INTO classes (id, level_id, code, supervisor_id, student_rep_id, assistant_rep_id, "order", created_by, last_modified_by, created_at, last_modified_at, is_archived, archived_at, archive_reason, archived_by) VALUES (%(id)s::UUID, %(level_id)s::UUID, %(code)s, %(supervisor_id)s::UUID, %(student_rep_id)s::UUID, %(assistant_rep_id)s::UUID, %(order)s, %(created_by)s::UUID, %(last_modified_by)s::UUID, now(), now(), %(is_archived)s, %(archived_at)s, %(archive_reason)s, %(archived_by)s::UUID) RETURNING classes.created_at, classes.last_modified_at
2025-03-19 02:11:22,606 - sqlalchemy.engine.Engine - INFO - [generated in 0.00108s] {'id': UUID('bd47433c-97ba-4d7f-8422-a556e2e414a1'), 'level_id': UUID('b7aeece1-55a8-41c2-bf8d-2f9d124366a1'), 'code': 'A', 'supervisor_id': UUID('b7aeece1-55a8-41c2-bf8d-2f9d124366a0'), 'student_rep_id': None, 'assistant_rep_id': None, 'order': 1, 'created_by': UUID('00000000-0000-0000-0000-000000000000'), 'last_modified_by': UUID('00000000-0000-0000-0000-000000000000'), 'is_archived': False, 'archived_at': None, 'archive_reason': None, 'archived_by': None}
2025-03-19 02:11:22,610 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-19 02:11:22,612 - kademia - ERROR - Unhandled exception | 4201829c-601d-45fc-ad20-576d5c677069 | Duplicate class creation attempted: Unique constraint violation - Detail: (psycopg2.errors.uniqueviolation) duplicate key value violates unique constraint "uq_class_level_code"
detail:  key (level_id, code)=(b7aeece1-55a8-41c2-bf8d-2f9d124366a1, a) already exists.

[sql: insert into classes (id, level_id, code, supervisor_id, student_rep_id, assistant_rep_id, "order", created_by, last_modified_by, created_at, last_modified_at, is_archived, archived_at, archive_reason, archived_by) values (%(id)s::uuid, %(level_id)s::uuid, %(code)s, %(supervisor_id)s::uuid, %(student_rep_id)s::uuid, %(assistant_rep_id)s::uuid, %(order)s, %(created_by)s::uuid, %(last_modified_by)s::uuid, now(), now(), %(is_archived)s, %(archived_at)s, %(archive_reason)s, %(archived_by)s::uuid) returning classes.created_at, classes.last_modified_at]
[parameters: {'id': uuid('bd47433c-97ba-4d7f-8422-a556e2e414a1'), 'level_id': uuid('b7aeece1-55a8-41c2-bf8d-2f9d124366a1'), 'code': 'a', 'supervisor_id': uuid('b7aeece1-55a8-41c2-bf8d-2f9d124366a0'), 'student_rep_id': none, 'assistant_rep_id': none, 'order': 1, 'created_by': uuid('00000000-0000-0000-0000-000000000000'), 'last_modified_by': uuid('00000000-0000-0000-0000-000000000000'), 'is_archived': false, 'archived_at': none, 'archive_reason': none, 'archived_by': none}]
(background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 111, in receive
    return self.receive_nowait()
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 106, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 124, in receive
    return receiver.item
           ^^^^^^^^^^^^^
AttributeError: 'MemoryObjectItemReceiver' object has no attribute 'item'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 157, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 126, in receive
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\middleware\error_handler.py", line 81, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\fastapi\routing.py", line 214, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\to_thread.py", line 56, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2461, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 962, in run
    result = context.run(func, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\routers\student_organization\classes.py", line 19, in create_class
    return class_crud.create_class(data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\crud\student_organization\classes.py", line 30, in create_class
    new_class = self.factory.create_class(data)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\core\factories\student_organization\classes.py", line 55, in create_class
    raise DuplicateClassError(
app.core.errors.student_organisation_errors.DuplicateClassError: Duplicate class creation attempted: Unique constraint violation - Detail: (psycopg2.errors.uniqueviolation) duplicate key value violates unique constraint "uq_class_level_code"
detail:  key (level_id, code)=(b7aeece1-55a8-41c2-bf8d-2f9d124366a1, a) already exists.

[sql: insert into classes (id, level_id, code, supervisor_id, student_rep_id, assistant_rep_id, "order", created_by, last_modified_by, created_at, last_modified_at, is_archived, archived_at, archive_reason, archived_by) values (%(id)s::uuid, %(level_id)s::uuid, %(code)s, %(supervisor_id)s::uuid, %(student_rep_id)s::uuid, %(assistant_rep_id)s::uuid, %(order)s, %(created_by)s::uuid, %(last_modified_by)s::uuid, now(), now(), %(is_archived)s, %(archived_at)s, %(archive_reason)s, %(archived_by)s::uuid) returning classes.created_at, classes.last_modified_at]
[parameters: {'id': uuid('bd47433c-97ba-4d7f-8422-a556e2e414a1'), 'level_id': uuid('b7aeece1-55a8-41c2-bf8d-2f9d124366a1'), 'code': 'a', 'supervisor_id': uuid('b7aeece1-55a8-41c2-bf8d-2f9d124366a0'), 'student_rep_id': none, 'assistant_rep_id': none, 'order': 1, 'created_by': uuid('00000000-0000-0000-0000-000000000000'), 'last_modified_by': uuid('00000000-0000-0000-0000-000000000000'), 'is_archived': false, 'archived_at': none, 'archive_reason': none, 'archived_by': none}]
(background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-19 02:11:22,620 - kademia - WARNING - UniqueViolationError | 4201829c-601d-45fc-ad20-576d5c677069 | Duplicate class creation attempted: Unique constraint violation - Detail: (psycopg2.errors.uniqueviolation) duplicate key value violates unique constraint "uq_class_level_code"
detail:  key (level_id, code)=(b7aeece1-55a8-41c2-bf8d-2f9d124366a1, a) already exists.

[sql: insert into classes (id, level_id, code, supervisor_id, student_rep_id, assistant_rep_id, "order", created_by, last_modified_by, created_at, last_modified_at, is_archived, archived_at, archive_reason, archived_by) values (%(id)s::uuid, %(level_id)s::uuid, %(code)s, %(supervisor_id)s::uuid, %(student_rep_id)s::uuid, %(assistant_rep_id)s::uuid, %(order)s, %(created_by)s::uuid, %(last_modified_by)s::uuid, now(), now(), %(is_archived)s, %(archived_at)s, %(archive_reason)s, %(archived_by)s::uuid) returning classes.created_at, classes.last_modified_at]
[parameters: {'id': uuid('bd47433c-97ba-4d7f-8422-a556e2e414a1'), 'level_id': uuid('b7aeece1-55a8-41c2-bf8d-2f9d124366a1'), 'code': 'a', 'supervisor_id': uuid('b7aeece1-55a8-41c2-bf8d-2f9d124366a0'), 'student_rep_id': none, 'assistant_rep_id': none, 'order': 1, 'created_by': uuid('00000000-0000-0000-0000-000000000000'), 'last_modified_by': uuid('00000000-0000-0000-0000-000000000000'), 'is_archived': false, 'archived_at': none, 'archive_reason': none, 'archived_by': none}]
(background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-19 02:19:09,137 - kademia - INFO - Application started
2025-03-19 02:19:31,489 - kademia - INFO - Request started | 87255f67-b3f6-43ae-baca-7d78bd8ae56c | GET /docs
2025-03-19 02:19:31,490 - kademia - INFO - Request completed | 87255f67-b3f6-43ae-baca-7d78bd8ae56c | Status: 200 | Time: 0.001s
2025-03-19 02:19:31,598 - kademia - INFO - Request started | 2ba687ac-9d3a-4ad4-910f-c11eb7c9cc7f | GET /openapi.json
2025-03-19 02:19:31,688 - kademia - INFO - Request completed | 2ba687ac-9d3a-4ad4-910f-c11eb7c9cc7f | Status: 200 | Time: 0.090s
2025-03-19 02:19:57,362 - kademia - INFO - Request started | 713379e3-91a4-4fa4-980c-1a3c6c670d37 | POST /api/v1/students/student_organization/
2025-03-19 02:19:57,599 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-03-19 02:19:57,600 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-03-19 02:19:57,601 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-03-19 02:19:57,602 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-03-19 02:19:57,603 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-03-19 02:19:57,603 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-03-19 02:19:57,604 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 02:19:57,607 - sqlalchemy.engine.Engine - INFO - INSERT INTO classes (id, level_id, code, supervisor_id, student_rep_id, assistant_rep_id, "order", created_by, last_modified_by, created_at, last_modified_at, is_archived, archived_at, archive_reason, archived_by) VALUES (%(id)s::UUID, %(level_id)s::UUID, %(code)s, %(supervisor_id)s::UUID, %(student_rep_id)s::UUID, %(assistant_rep_id)s::UUID, %(order)s, %(created_by)s::UUID, %(last_modified_by)s::UUID, now(), now(), %(is_archived)s, %(archived_at)s, %(archive_reason)s, %(archived_by)s::UUID) RETURNING classes.created_at, classes.last_modified_at
2025-03-19 02:19:57,608 - sqlalchemy.engine.Engine - INFO - [generated in 0.00122s] {'id': UUID('508a1875-988b-4293-a59c-2dabfe809cc6'), 'level_id': UUID('b7aeece1-55a8-41c2-bf8d-2f9d124366a1'), 'code': 'A', 'supervisor_id': None, 'student_rep_id': None, 'assistant_rep_id': None, 'order': 1, 'created_by': UUID('00000000-0000-0000-0000-000000000000'), 'last_modified_by': UUID('00000000-0000-0000-0000-000000000000'), 'is_archived': False, 'archived_at': None, 'archive_reason': None, 'archived_by': None}
2025-03-19 02:19:57,612 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-19 02:19:57,613 - kademia - ERROR - Unhandled exception | 713379e3-91a4-4fa4-980c-1a3c6c670d37 | Duplicate class creation attempted: Unique constraint violation - Detail: (psycopg2.errors.uniqueviolation) duplicate key value violates unique constraint "uq_class_level_code"
detail:  key (level_id, code)=(b7aeece1-55a8-41c2-bf8d-2f9d124366a1, a) already exists.

[sql: insert into classes (id, level_id, code, supervisor_id, student_rep_id, assistant_rep_id, "order", created_by, last_modified_by, created_at, last_modified_at, is_archived, archived_at, archive_reason, archived_by) values (%(id)s::uuid, %(level_id)s::uuid, %(code)s, %(supervisor_id)s::uuid, %(student_rep_id)s::uuid, %(assistant_rep_id)s::uuid, %(order)s, %(created_by)s::uuid, %(last_modified_by)s::uuid, now(), now(), %(is_archived)s, %(archived_at)s, %(archive_reason)s, %(archived_by)s::uuid) returning classes.created_at, classes.last_modified_at]
[parameters: {'id': uuid('508a1875-988b-4293-a59c-2dabfe809cc6'), 'level_id': uuid('b7aeece1-55a8-41c2-bf8d-2f9d124366a1'), 'code': 'a', 'supervisor_id': none, 'student_rep_id': none, 'assistant_rep_id': none, 'order': 1, 'created_by': uuid('00000000-0000-0000-0000-000000000000'), 'last_modified_by': uuid('00000000-0000-0000-0000-000000000000'), 'is_archived': false, 'archived_at': none, 'archive_reason': none, 'archived_by': none}]
(background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 111, in receive
    return self.receive_nowait()
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 106, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 124, in receive
    return receiver.item
           ^^^^^^^^^^^^^
AttributeError: 'MemoryObjectItemReceiver' object has no attribute 'item'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 157, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 126, in receive
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\middleware\error_handler.py", line 81, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\fastapi\routing.py", line 214, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\to_thread.py", line 56, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2461, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 962, in run
    result = context.run(func, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\routers\student_organization\classes.py", line 19, in create_class
    return class_crud.create_class(data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\crud\student_organization\classes.py", line 30, in create_class
    new_class = self.factory.create_class(data)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\core\factories\student_organization\classes.py", line 55, in create_class
    raise DuplicateClassError(
app.core.errors.student_organisation_errors.DuplicateClassError: Duplicate class creation attempted: Unique constraint violation - Detail: (psycopg2.errors.uniqueviolation) duplicate key value violates unique constraint "uq_class_level_code"
detail:  key (level_id, code)=(b7aeece1-55a8-41c2-bf8d-2f9d124366a1, a) already exists.

[sql: insert into classes (id, level_id, code, supervisor_id, student_rep_id, assistant_rep_id, "order", created_by, last_modified_by, created_at, last_modified_at, is_archived, archived_at, archive_reason, archived_by) values (%(id)s::uuid, %(level_id)s::uuid, %(code)s, %(supervisor_id)s::uuid, %(student_rep_id)s::uuid, %(assistant_rep_id)s::uuid, %(order)s, %(created_by)s::uuid, %(last_modified_by)s::uuid, now(), now(), %(is_archived)s, %(archived_at)s, %(archive_reason)s, %(archived_by)s::uuid) returning classes.created_at, classes.last_modified_at]
[parameters: {'id': uuid('508a1875-988b-4293-a59c-2dabfe809cc6'), 'level_id': uuid('b7aeece1-55a8-41c2-bf8d-2f9d124366a1'), 'code': 'a', 'supervisor_id': none, 'student_rep_id': none, 'assistant_rep_id': none, 'order': 1, 'created_by': uuid('00000000-0000-0000-0000-000000000000'), 'last_modified_by': uuid('00000000-0000-0000-0000-000000000000'), 'is_archived': false, 'archived_at': none, 'archive_reason': none, 'archived_by': none}]
(background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-19 02:19:57,626 - kademia - WARNING - UniqueViolationError | 713379e3-91a4-4fa4-980c-1a3c6c670d37 | Duplicate class creation attempted: Unique constraint violation - Detail: (psycopg2.errors.uniqueviolation) duplicate key value violates unique constraint "uq_class_level_code"
detail:  key (level_id, code)=(b7aeece1-55a8-41c2-bf8d-2f9d124366a1, a) already exists.

[sql: insert into classes (id, level_id, code, supervisor_id, student_rep_id, assistant_rep_id, "order", created_by, last_modified_by, created_at, last_modified_at, is_archived, archived_at, archive_reason, archived_by) values (%(id)s::uuid, %(level_id)s::uuid, %(code)s, %(supervisor_id)s::uuid, %(student_rep_id)s::uuid, %(assistant_rep_id)s::uuid, %(order)s, %(created_by)s::uuid, %(last_modified_by)s::uuid, now(), now(), %(is_archived)s, %(archived_at)s, %(archive_reason)s, %(archived_by)s::uuid) returning classes.created_at, classes.last_modified_at]
[parameters: {'id': uuid('508a1875-988b-4293-a59c-2dabfe809cc6'), 'level_id': uuid('b7aeece1-55a8-41c2-bf8d-2f9d124366a1'), 'code': 'a', 'supervisor_id': none, 'student_rep_id': none, 'assistant_rep_id': none, 'order': 1, 'created_by': uuid('00000000-0000-0000-0000-000000000000'), 'last_modified_by': uuid('00000000-0000-0000-0000-000000000000'), 'is_archived': false, 'archived_at': none, 'archive_reason': none, 'archived_by': none}]
(background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-19 02:24:23,268 - kademia - INFO - Application started
2025-03-19 02:24:43,805 - kademia - INFO - Request started | 1ec407ed-4d5b-4c9b-8531-d7097d8c4065 | GET /docs
2025-03-19 02:24:43,806 - kademia - INFO - Request completed | 1ec407ed-4d5b-4c9b-8531-d7097d8c4065 | Status: 200 | Time: 0.001s
2025-03-19 02:24:43,966 - kademia - INFO - Request started | 14514901-a943-405e-8eef-38694a581224 | GET /openapi.json
2025-03-19 02:24:44,096 - kademia - INFO - Request completed | 14514901-a943-405e-8eef-38694a581224 | Status: 200 | Time: 0.130s
2025-03-19 02:25:27,221 - kademia - INFO - Request started | 0f534e58-74b6-450a-8f59-d64ca6bddb5c | POST /api/v1/students/student_organization/
2025-03-19 02:25:27,467 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-03-19 02:25:27,467 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-03-19 02:25:27,468 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-03-19 02:25:27,469 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-03-19 02:25:27,469 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-03-19 02:25:27,470 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-03-19 02:25:27,471 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 02:25:27,474 - sqlalchemy.engine.Engine - INFO - INSERT INTO classes (id, level_id, code, supervisor_id, student_rep_id, assistant_rep_id, "order", created_by, last_modified_by, created_at, last_modified_at, is_archived, archived_at, archive_reason, archived_by) VALUES (%(id)s::UUID, %(level_id)s::UUID, %(code)s, %(supervisor_id)s::UUID, %(student_rep_id)s::UUID, %(assistant_rep_id)s::UUID, %(order)s, %(created_by)s::UUID, %(last_modified_by)s::UUID, now(), now(), %(is_archived)s, %(archived_at)s, %(archive_reason)s, %(archived_by)s::UUID) RETURNING classes.created_at, classes.last_modified_at
2025-03-19 02:25:27,474 - sqlalchemy.engine.Engine - INFO - [generated in 0.00067s] {'id': UUID('ee0bee09-dd94-45d3-8e2c-52cc5390050a'), 'level_id': UUID('b7aeece1-55a8-41c2-bf8d-2f9d124366a1'), 'code': 'A', 'supervisor_id': None, 'student_rep_id': None, 'assistant_rep_id': None, 'order': 1, 'created_by': UUID('00000000-0000-0000-0000-000000000000'), 'last_modified_by': UUID('00000000-0000-0000-0000-000000000000'), 'is_archived': False, 'archived_at': None, 'archive_reason': None, 'archived_by': None}
2025-03-19 02:25:27,478 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-19 02:25:27,480 - kademia - ERROR - Unhandled exception | 0f534e58-74b6-450a-8f59-d64ca6bddb5c | Duplicate class creation attempted: Unique constraint violation - Detail: (psycopg2.errors.uniqueviolation) duplicate key value violates unique constraint "uq_class_level_code"
detail:  key (level_id, code)=(b7aeece1-55a8-41c2-bf8d-2f9d124366a1, a) already exists.

[sql: insert into classes (id, level_id, code, supervisor_id, student_rep_id, assistant_rep_id, "order", created_by, last_modified_by, created_at, last_modified_at, is_archived, archived_at, archive_reason, archived_by) values (%(id)s::uuid, %(level_id)s::uuid, %(code)s, %(supervisor_id)s::uuid, %(student_rep_id)s::uuid, %(assistant_rep_id)s::uuid, %(order)s, %(created_by)s::uuid, %(last_modified_by)s::uuid, now(), now(), %(is_archived)s, %(archived_at)s, %(archive_reason)s, %(archived_by)s::uuid) returning classes.created_at, classes.last_modified_at]
[parameters: {'id': uuid('ee0bee09-dd94-45d3-8e2c-52cc5390050a'), 'level_id': uuid('b7aeece1-55a8-41c2-bf8d-2f9d124366a1'), 'code': 'a', 'supervisor_id': none, 'student_rep_id': none, 'assistant_rep_id': none, 'order': 1, 'created_by': uuid('00000000-0000-0000-0000-000000000000'), 'last_modified_by': uuid('00000000-0000-0000-0000-000000000000'), 'is_archived': false, 'archived_at': none, 'archive_reason': none, 'archived_by': none}]
(background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 111, in receive
    return self.receive_nowait()
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 106, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 124, in receive
    return receiver.item
           ^^^^^^^^^^^^^
AttributeError: 'MemoryObjectItemReceiver' object has no attribute 'item'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 157, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 126, in receive
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\middleware\error_handler.py", line 81, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\fastapi\routing.py", line 214, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\to_thread.py", line 56, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2461, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 962, in run
    result = context.run(func, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\routers\student_organization\classes.py", line 19, in create_class
    return class_crud.create_class(data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\crud\student_organization\classes.py", line 30, in create_class
    new_class = self.factory.create_class(data)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\core\factories\student_organization\classes.py", line 55, in create_class
    raise DuplicateClassError(
app.core.errors.student_organisation_errors.DuplicateClassError: Duplicate class creation attempted: Unique constraint violation - Detail: (psycopg2.errors.uniqueviolation) duplicate key value violates unique constraint "uq_class_level_code"
detail:  key (level_id, code)=(b7aeece1-55a8-41c2-bf8d-2f9d124366a1, a) already exists.

[sql: insert into classes (id, level_id, code, supervisor_id, student_rep_id, assistant_rep_id, "order", created_by, last_modified_by, created_at, last_modified_at, is_archived, archived_at, archive_reason, archived_by) values (%(id)s::uuid, %(level_id)s::uuid, %(code)s, %(supervisor_id)s::uuid, %(student_rep_id)s::uuid, %(assistant_rep_id)s::uuid, %(order)s, %(created_by)s::uuid, %(last_modified_by)s::uuid, now(), now(), %(is_archived)s, %(archived_at)s, %(archive_reason)s, %(archived_by)s::uuid) returning classes.created_at, classes.last_modified_at]
[parameters: {'id': uuid('ee0bee09-dd94-45d3-8e2c-52cc5390050a'), 'level_id': uuid('b7aeece1-55a8-41c2-bf8d-2f9d124366a1'), 'code': 'a', 'supervisor_id': none, 'student_rep_id': none, 'assistant_rep_id': none, 'order': 1, 'created_by': uuid('00000000-0000-0000-0000-000000000000'), 'last_modified_by': uuid('00000000-0000-0000-0000-000000000000'), 'is_archived': false, 'archived_at': none, 'archive_reason': none, 'archived_by': none}]
(background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-19 02:25:27,487 - kademia - WARNING - UniqueViolationError | 0f534e58-74b6-450a-8f59-d64ca6bddb5c | Duplicate class creation attempted: Unique constraint violation - Detail: (psycopg2.errors.uniqueviolation) duplicate key value violates unique constraint "uq_class_level_code"
detail:  key (level_id, code)=(b7aeece1-55a8-41c2-bf8d-2f9d124366a1, a) already exists.

[sql: insert into classes (id, level_id, code, supervisor_id, student_rep_id, assistant_rep_id, "order", created_by, last_modified_by, created_at, last_modified_at, is_archived, archived_at, archive_reason, archived_by) values (%(id)s::uuid, %(level_id)s::uuid, %(code)s, %(supervisor_id)s::uuid, %(student_rep_id)s::uuid, %(assistant_rep_id)s::uuid, %(order)s, %(created_by)s::uuid, %(last_modified_by)s::uuid, now(), now(), %(is_archived)s, %(archived_at)s, %(archive_reason)s, %(archived_by)s::uuid) returning classes.created_at, classes.last_modified_at]
[parameters: {'id': uuid('ee0bee09-dd94-45d3-8e2c-52cc5390050a'), 'level_id': uuid('b7aeece1-55a8-41c2-bf8d-2f9d124366a1'), 'code': 'a', 'supervisor_id': none, 'student_rep_id': none, 'assistant_rep_id': none, 'order': 1, 'created_by': uuid('00000000-0000-0000-0000-000000000000'), 'last_modified_by': uuid('00000000-0000-0000-0000-000000000000'), 'is_archived': false, 'archived_at': none, 'archive_reason': none, 'archived_by': none}]
(background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-19 02:28:56,805 - kademia - INFO - Request started | 4fc49724-785a-47c4-adb8-95ca2102200d | POST /api/v1/students/student_organization/
2025-03-19 02:28:56,808 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 02:28:56,809 - sqlalchemy.engine.Engine - INFO - INSERT INTO classes (id, level_id, code, supervisor_id, student_rep_id, assistant_rep_id, "order", created_by, last_modified_by, created_at, last_modified_at, is_archived, archived_at, archive_reason, archived_by) VALUES (%(id)s::UUID, %(level_id)s::UUID, %(code)s, %(supervisor_id)s::UUID, %(student_rep_id)s::UUID, %(assistant_rep_id)s::UUID, %(order)s, %(created_by)s::UUID, %(last_modified_by)s::UUID, now(), now(), %(is_archived)s, %(archived_at)s, %(archive_reason)s, %(archived_by)s::UUID) RETURNING classes.created_at, classes.last_modified_at
2025-03-19 02:28:56,810 - sqlalchemy.engine.Engine - INFO - [cached since 209.3s ago] {'id': UUID('ae3fd2a2-015a-4a65-af10-240036166390'), 'level_id': UUID('b7aeece1-55a8-41c2-bf8d-2f9d124366a1'), 'code': 'B', 'supervisor_id': None, 'student_rep_id': None, 'assistant_rep_id': None, 'order': 1, 'created_by': UUID('00000000-0000-0000-0000-000000000000'), 'last_modified_by': UUID('00000000-0000-0000-0000-000000000000'), 'is_archived': False, 'archived_at': None, 'archive_reason': None, 'archived_by': None}
2025-03-19 02:28:56,812 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-19 02:28:56,814 - kademia - ERROR - Unhandled exception | 4fc49724-785a-47c4-adb8-95ca2102200d | Duplicate class creation attempted: Unique constraint violation - Detail: (psycopg2.errors.uniqueviolation) duplicate key value violates unique constraint "classes_order_key"
detail:  key ("order")=(1) already exists.

[sql: insert into classes (id, level_id, code, supervisor_id, student_rep_id, assistant_rep_id, "order", created_by, last_modified_by, created_at, last_modified_at, is_archived, archived_at, archive_reason, archived_by) values (%(id)s::uuid, %(level_id)s::uuid, %(code)s, %(supervisor_id)s::uuid, %(student_rep_id)s::uuid, %(assistant_rep_id)s::uuid, %(order)s, %(created_by)s::uuid, %(last_modified_by)s::uuid, now(), now(), %(is_archived)s, %(archived_at)s, %(archive_reason)s, %(archived_by)s::uuid) returning classes.created_at, classes.last_modified_at]
[parameters: {'id': uuid('ae3fd2a2-015a-4a65-af10-240036166390'), 'level_id': uuid('b7aeece1-55a8-41c2-bf8d-2f9d124366a1'), 'code': 'b', 'supervisor_id': none, 'student_rep_id': none, 'assistant_rep_id': none, 'order': 1, 'created_by': uuid('00000000-0000-0000-0000-000000000000'), 'last_modified_by': uuid('00000000-0000-0000-0000-000000000000'), 'is_archived': false, 'archived_at': none, 'archive_reason': none, 'archived_by': none}]
(background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 111, in receive
    return self.receive_nowait()
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 106, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 124, in receive
    return receiver.item
           ^^^^^^^^^^^^^
AttributeError: 'MemoryObjectItemReceiver' object has no attribute 'item'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 157, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 126, in receive
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\middleware\error_handler.py", line 81, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\fastapi\routing.py", line 214, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\to_thread.py", line 56, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2461, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 962, in run
    result = context.run(func, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\routers\student_organization\classes.py", line 19, in create_class
    return class_crud.create_class(data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\crud\student_organization\classes.py", line 30, in create_class
    new_class = self.factory.create_class(data)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\core\factories\student_organization\classes.py", line 58, in create_class
    raise DuplicateClassError(
app.core.errors.student_organisation_errors.DuplicateClassError: Duplicate class creation attempted: Unique constraint violation - Detail: (psycopg2.errors.uniqueviolation) duplicate key value violates unique constraint "classes_order_key"
detail:  key ("order")=(1) already exists.

[sql: insert into classes (id, level_id, code, supervisor_id, student_rep_id, assistant_rep_id, "order", created_by, last_modified_by, created_at, last_modified_at, is_archived, archived_at, archive_reason, archived_by) values (%(id)s::uuid, %(level_id)s::uuid, %(code)s, %(supervisor_id)s::uuid, %(student_rep_id)s::uuid, %(assistant_rep_id)s::uuid, %(order)s, %(created_by)s::uuid, %(last_modified_by)s::uuid, now(), now(), %(is_archived)s, %(archived_at)s, %(archive_reason)s, %(archived_by)s::uuid) returning classes.created_at, classes.last_modified_at]
[parameters: {'id': uuid('ae3fd2a2-015a-4a65-af10-240036166390'), 'level_id': uuid('b7aeece1-55a8-41c2-bf8d-2f9d124366a1'), 'code': 'b', 'supervisor_id': none, 'student_rep_id': none, 'assistant_rep_id': none, 'order': 1, 'created_by': uuid('00000000-0000-0000-0000-000000000000'), 'last_modified_by': uuid('00000000-0000-0000-0000-000000000000'), 'is_archived': false, 'archived_at': none, 'archive_reason': none, 'archived_by': none}]
(background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-19 02:28:56,871 - kademia - WARNING - UniqueViolationError | 4fc49724-785a-47c4-adb8-95ca2102200d | Duplicate class creation attempted: Unique constraint violation - Detail: (psycopg2.errors.uniqueviolation) duplicate key value violates unique constraint "classes_order_key"
detail:  key ("order")=(1) already exists.

[sql: insert into classes (id, level_id, code, supervisor_id, student_rep_id, assistant_rep_id, "order", created_by, last_modified_by, created_at, last_modified_at, is_archived, archived_at, archive_reason, archived_by) values (%(id)s::uuid, %(level_id)s::uuid, %(code)s, %(supervisor_id)s::uuid, %(student_rep_id)s::uuid, %(assistant_rep_id)s::uuid, %(order)s, %(created_by)s::uuid, %(last_modified_by)s::uuid, now(), now(), %(is_archived)s, %(archived_at)s, %(archive_reason)s, %(archived_by)s::uuid) returning classes.created_at, classes.last_modified_at]
[parameters: {'id': uuid('ae3fd2a2-015a-4a65-af10-240036166390'), 'level_id': uuid('b7aeece1-55a8-41c2-bf8d-2f9d124366a1'), 'code': 'b', 'supervisor_id': none, 'student_rep_id': none, 'assistant_rep_id': none, 'order': 1, 'created_by': uuid('00000000-0000-0000-0000-000000000000'), 'last_modified_by': uuid('00000000-0000-0000-0000-000000000000'), 'is_archived': false, 'archived_at': none, 'archive_reason': none, 'archived_by': none}]
(background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-19 02:29:30,749 - kademia - INFO - Request started | e5445d4f-8d4f-4e4a-b907-aa64eb9868c9 | POST /api/v1/students/student_organization/
2025-03-19 02:29:30,751 - kademia - INFO - Request completed | e5445d4f-8d4f-4e4a-b907-aa64eb9868c9 | Status: 422 | Time: 0.002s
2025-03-19 02:29:39,802 - kademia - INFO - Request started | 71d6a6e7-bae0-44be-9611-4cdf22b71cad | POST /api/v1/students/student_organization/
2025-03-19 02:29:39,806 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 02:29:39,810 - sqlalchemy.engine.Engine - INFO - SELECT max(classes."order") AS max_1 
FROM classes 
WHERE classes.level_id = %(level_id_1)s::UUID
2025-03-19 02:29:39,811 - sqlalchemy.engine.Engine - INFO - [generated in 0.00074s] {'level_id_1': UUID('b7aeece1-55a8-41c2-bf8d-2f9d124366a1')}
2025-03-19 02:29:39,818 - sqlalchemy.engine.Engine - INFO - INSERT INTO classes (id, level_id, code, supervisor_id, student_rep_id, assistant_rep_id, "order", created_by, last_modified_by, created_at, last_modified_at, is_archived, archived_at, archive_reason, archived_by) VALUES (%(id)s::UUID, %(level_id)s::UUID, %(code)s, %(supervisor_id)s::UUID, %(student_rep_id)s::UUID, %(assistant_rep_id)s::UUID, %(order)s, %(created_by)s::UUID, %(last_modified_by)s::UUID, now(), now(), %(is_archived)s, %(archived_at)s, %(archive_reason)s, %(archived_by)s::UUID) RETURNING classes.created_at, classes.last_modified_at
2025-03-19 02:29:39,819 - sqlalchemy.engine.Engine - INFO - [cached since 252.3s ago] {'id': UUID('87159b49-3b94-40c0-b3ab-a7d190311b15'), 'level_id': UUID('b7aeece1-55a8-41c2-bf8d-2f9d124366a1'), 'code': 'B', 'supervisor_id': None, 'student_rep_id': None, 'assistant_rep_id': None, 'order': 2, 'created_by': UUID('00000000-0000-0000-0000-000000000000'), 'last_modified_by': UUID('00000000-0000-0000-0000-000000000000'), 'is_archived': False, 'archived_at': None, 'archive_reason': None, 'archived_by': None}
2025-03-19 02:29:39,837 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-19 02:29:39,841 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 02:29:39,844 - sqlalchemy.engine.Engine - INFO - SELECT classes.id, classes.level_id, classes.code, classes.supervisor_id, classes.student_rep_id, classes.assistant_rep_id, classes."order", classes.created_by, classes.last_modified_by, classes.created_at, classes.last_modified_at, classes.is_archived, classes.archived_at, classes.archive_reason, classes.archived_by 
FROM classes 
WHERE classes.id = %(pk_1)s::UUID
2025-03-19 02:29:39,845 - sqlalchemy.engine.Engine - INFO - [generated in 0.00064s] {'pk_1': UUID('87159b49-3b94-40c0-b3ab-a7d190311b15')}
2025-03-19 02:29:39,848 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-19 02:29:39,849 - kademia - INFO - Request completed | 71d6a6e7-bae0-44be-9611-4cdf22b71cad | Status: 201 | Time: 0.046s
2025-03-19 02:30:23,724 - kademia - INFO - Request started | 1cd500b8-1e81-42ce-a709-a1b8f54e2dd9 | GET /api/v1/students/student_organization/
2025-03-19 02:30:23,725 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 02:30:23,727 - sqlalchemy.engine.Engine - INFO - SELECT classes.id AS classes_id, classes.level_id AS classes_level_id, classes.code AS classes_code, classes.supervisor_id AS classes_supervisor_id, classes.student_rep_id AS classes_student_rep_id, classes.assistant_rep_id AS classes_assistant_rep_id, classes."order" AS classes_order, classes.created_by AS classes_created_by, classes.last_modified_by AS classes_last_modified_by, classes.created_at AS classes_created_at, classes.last_modified_at AS classes_last_modified_at, classes.is_archived AS classes_is_archived, classes.archived_at AS classes_archived_at, classes.archive_reason AS classes_archive_reason, classes.archived_by AS classes_archived_by 
FROM classes 
WHERE classes.is_archived = false ORDER BY classes."order" DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
2025-03-19 02:30:23,728 - sqlalchemy.engine.Engine - INFO - [generated in 0.00083s] {'param_1': 50, 'param_2': 0}
2025-03-19 02:30:23,731 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-19 02:30:23,734 - kademia - INFO - Request completed | 1cd500b8-1e81-42ce-a709-a1b8f54e2dd9 | Status: 200 | Time: 0.010s
2025-03-19 02:31:31,606 - kademia - INFO - Application started
2025-03-19 02:31:35,106 - kademia - INFO - Request started | b8ad838c-9639-4c56-b970-ccaf6206e894 | GET /docs
2025-03-19 02:31:35,109 - kademia - INFO - Request completed | b8ad838c-9639-4c56-b970-ccaf6206e894 | Status: 200 | Time: 0.001s
2025-03-19 02:31:35,227 - kademia - INFO - Request started | 9f5940a2-eb34-4e7f-a859-57f769548d18 | GET /openapi.json
2025-03-19 02:31:35,312 - kademia - INFO - Request completed | 9f5940a2-eb34-4e7f-a859-57f769548d18 | Status: 200 | Time: 0.085s
2025-03-19 02:44:40,572 - kademia - INFO - Request started | 170792f6-a295-489c-b36b-7fed3ea0ea54 | GET /api/v1/students/student_organization/
2025-03-19 02:44:40,800 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-03-19 02:44:40,800 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-03-19 02:44:40,802 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-03-19 02:44:40,803 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-03-19 02:44:40,804 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-03-19 02:44:40,804 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-03-19 02:44:40,806 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 02:44:40,810 - sqlalchemy.engine.Engine - INFO - SELECT classes.id AS classes_id, classes.level_id AS classes_level_id, classes.code AS classes_code, classes.supervisor_id AS classes_supervisor_id, classes.student_rep_id AS classes_student_rep_id, classes.assistant_rep_id AS classes_assistant_rep_id, classes."order" AS classes_order, classes.created_by AS classes_created_by, classes.last_modified_by AS classes_last_modified_by, classes.created_at AS classes_created_at, classes.last_modified_at AS classes_last_modified_at, classes.is_archived AS classes_is_archived, classes.archived_at AS classes_archived_at, classes.archive_reason AS classes_archive_reason, classes.archived_by AS classes_archived_by 
FROM classes 
WHERE classes.is_archived = false ORDER BY classes."order" DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
2025-03-19 02:44:40,811 - sqlalchemy.engine.Engine - INFO - [generated in 0.00084s] {'param_1': 50, 'param_2': 0}
2025-03-19 02:44:40,817 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-19 02:44:40,820 - kademia - INFO - Request completed | 170792f6-a295-489c-b36b-7fed3ea0ea54 | Status: 200 | Time: 0.247s
2025-03-19 02:44:56,835 - kademia - INFO - Request started | cdd818b1-1df9-4e93-9f68-4e7691027364 | GET /api/v1/students/student_organization/6d3b633d-519a-4307-b042-2248f9d11d97
2025-03-19 02:44:56,839 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 02:44:56,840 - sqlalchemy.engine.Engine - INFO - SELECT classes.id AS classes_id, classes.level_id AS classes_level_id, classes.code AS classes_code, classes.supervisor_id AS classes_supervisor_id, classes.student_rep_id AS classes_student_rep_id, classes.assistant_rep_id AS classes_assistant_rep_id, classes."order" AS classes_order, classes.created_by AS classes_created_by, classes.last_modified_by AS classes_last_modified_by, classes.created_at AS classes_created_at, classes.last_modified_at AS classes_last_modified_at, classes.is_archived AS classes_is_archived, classes.archived_at AS classes_archived_at, classes.archive_reason AS classes_archive_reason, classes.archived_by AS classes_archived_by 
FROM classes 
WHERE classes.is_archived = false AND classes.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-03-19 02:44:56,841 - sqlalchemy.engine.Engine - INFO - [generated in 0.00088s] {'id_1': UUID('6d3b633d-519a-4307-b042-2248f9d11d97'), 'param_1': 1}
2025-03-19 02:44:56,844 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-19 02:44:56,845 - kademia - INFO - Request completed | cdd818b1-1df9-4e93-9f68-4e7691027364 | Status: 200 | Time: 0.008s
2025-03-19 02:45:19,922 - kademia - INFO - Request started | be724abd-c3c2-4188-a8d0-174196158c8a | PUT /api/v1/students/student_organization/6d3b633d-519a-4307-b042-2248f9d11d97
2025-03-19 02:45:19,927 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 02:45:19,927 - sqlalchemy.engine.Engine - INFO - SELECT classes.id AS classes_id, classes.level_id AS classes_level_id, classes.code AS classes_code, classes.supervisor_id AS classes_supervisor_id, classes.student_rep_id AS classes_student_rep_id, classes.assistant_rep_id AS classes_assistant_rep_id, classes."order" AS classes_order, classes.created_by AS classes_created_by, classes.last_modified_by AS classes_last_modified_by, classes.created_at AS classes_created_at, classes.last_modified_at AS classes_last_modified_at, classes.is_archived AS classes_is_archived, classes.archived_at AS classes_archived_at, classes.archive_reason AS classes_archive_reason, classes.archived_by AS classes_archived_by 
FROM classes 
WHERE classes.is_archived = false AND classes.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-03-19 02:45:19,928 - sqlalchemy.engine.Engine - INFO - [cached since 23.09s ago] {'id_1': UUID('6d3b633d-519a-4307-b042-2248f9d11d97'), 'param_1': 1}
2025-03-19 02:45:19,935 - sqlalchemy.engine.Engine - INFO - UPDATE classes SET supervisor_id=%(supervisor_id)s::UUID, student_rep_id=%(student_rep_id)s::UUID, assistant_rep_id=%(assistant_rep_id)s::UUID, last_modified_at=now() WHERE classes.id = %(classes_id)s::UUID
2025-03-19 02:45:19,936 - sqlalchemy.engine.Engine - INFO - [generated in 0.00130s] {'supervisor_id': UUID('00000000-0000-0000-0000-000000000000'), 'student_rep_id': UUID('00000000-0000-0000-0000-000000000000'), 'assistant_rep_id': UUID('00000000-0000-0000-0000-000000000000'), 'classes_id': UUID('6d3b633d-519a-4307-b042-2248f9d11d97')}
2025-03-19 02:45:19,939 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-19 02:45:19,943 - kademia - ERROR - Unhandled exception | be724abd-c3c2-4188-a8d0-174196158c8a | Error during during fk insertion of Educator with id:00000000-0000-0000-0000-000000000000 during update operation. Detail Foreign key constraint violation during create operation. Detail: (raised as a result of Query-invoked autoflush; consider using a session.no_autoflush block if this flush is occurring prematurely)
(psycopg2.errors.ForeignKeyViolation) insert or update on table "classes" violates foreign key constraint "fk_classes_educators_mentor_id"
DETAIL:  Key (supervisor_id)=(00000000-0000-0000-0000-000000000000) is not present in table "educators".

[SQL: UPDATE classes SET supervisor_id=%(supervisor_id)s::UUID, student_rep_id=%(student_rep_id)s::UUID, assistant_rep_id=%(assistant_rep_id)s::UUID, last_modified_at=now() WHERE classes.id = %(classes_id)s::UUID]
[parameters: {'supervisor_id': UUID('00000000-0000-0000-0000-000000000000'), 'student_rep_id': UUID('00000000-0000-0000-0000-000000000000'), 'assistant_rep_id': UUID('00000000-0000-0000-0000-000000000000'), 'classes_id': UUID('6d3b633d-519a-4307-b042-2248f9d11d97')}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 111, in receive
    return self.receive_nowait()
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 106, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 124, in receive
    return receiver.item
           ^^^^^^^^^^^^^
AttributeError: 'MemoryObjectItemReceiver' object has no attribute 'item'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 157, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 126, in receive
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\middleware\error_handler.py", line 81, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\fastapi\routing.py", line 214, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\to_thread.py", line 56, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2461, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 962, in run
    result = context.run(func, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\routers\student_organization\classes.py", line 36, in update_class
    return class_crud.update_class(class_id, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\crud\student_organization\classes.py", line 63, in update_class
    updated_class = self.factory.update_class(class_id, data)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\core\factories\student_organization\classes.py", line 137, in update_class
    raise error_class(id=entity_id, detail=str(e), action='update')
app.core.errors.profile_errors.RelatedEducatorNotFoundError: Error during during fk insertion of Educator with id:00000000-0000-0000-0000-000000000000 during update operation. Detail Foreign key constraint violation during create operation. Detail: (raised as a result of Query-invoked autoflush; consider using a session.no_autoflush block if this flush is occurring prematurely)
(psycopg2.errors.ForeignKeyViolation) insert or update on table "classes" violates foreign key constraint "fk_classes_educators_mentor_id"
DETAIL:  Key (supervisor_id)=(00000000-0000-0000-0000-000000000000) is not present in table "educators".

[SQL: UPDATE classes SET supervisor_id=%(supervisor_id)s::UUID, student_rep_id=%(student_rep_id)s::UUID, assistant_rep_id=%(assistant_rep_id)s::UUID, last_modified_at=now() WHERE classes.id = %(classes_id)s::UUID]
[parameters: {'supervisor_id': UUID('00000000-0000-0000-0000-000000000000'), 'student_rep_id': UUID('00000000-0000-0000-0000-000000000000'), 'assistant_rep_id': UUID('00000000-0000-0000-0000-000000000000'), 'classes_id': UUID('6d3b633d-519a-4307-b042-2248f9d11d97')}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-19 02:45:19,956 - kademia - WARNING - RelationshipError | be724abd-c3c2-4188-a8d0-174196158c8a | Error during during fk insertion of Educator with id:00000000-0000-0000-0000-000000000000 during update operation. Detail Foreign key constraint violation during create operation. Detail: (raised as a result of Query-invoked autoflush; consider using a session.no_autoflush block if this flush is occurring prematurely)
(psycopg2.errors.ForeignKeyViolation) insert or update on table "classes" violates foreign key constraint "fk_classes_educators_mentor_id"
DETAIL:  Key (supervisor_id)=(00000000-0000-0000-0000-000000000000) is not present in table "educators".

[SQL: UPDATE classes SET supervisor_id=%(supervisor_id)s::UUID, student_rep_id=%(student_rep_id)s::UUID, assistant_rep_id=%(assistant_rep_id)s::UUID, last_modified_at=now() WHERE classes.id = %(classes_id)s::UUID]
[parameters: {'supervisor_id': UUID('00000000-0000-0000-0000-000000000000'), 'student_rep_id': UUID('00000000-0000-0000-0000-000000000000'), 'assistant_rep_id': UUID('00000000-0000-0000-0000-000000000000'), 'classes_id': UUID('6d3b633d-519a-4307-b042-2248f9d11d97')}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-19 02:46:26,581 - kademia - INFO - Request started | 6a21f179-8fb9-4354-8742-db7545637dea | PUT /api/v1/students/student_organization/6d3b633d-519a-4307-b042-2248f9d11d97
2025-03-19 02:46:26,585 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 02:46:26,585 - sqlalchemy.engine.Engine - INFO - SELECT classes.id AS classes_id, classes.level_id AS classes_level_id, classes.code AS classes_code, classes.supervisor_id AS classes_supervisor_id, classes.student_rep_id AS classes_student_rep_id, classes.assistant_rep_id AS classes_assistant_rep_id, classes."order" AS classes_order, classes.created_by AS classes_created_by, classes.last_modified_by AS classes_last_modified_by, classes.created_at AS classes_created_at, classes.last_modified_at AS classes_last_modified_at, classes.is_archived AS classes_is_archived, classes.archived_at AS classes_archived_at, classes.archive_reason AS classes_archive_reason, classes.archived_by AS classes_archived_by 
FROM classes 
WHERE classes.is_archived = false AND classes.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-03-19 02:46:26,586 - sqlalchemy.engine.Engine - INFO - [cached since 89.75s ago] {'id_1': UUID('6d3b633d-519a-4307-b042-2248f9d11d97'), 'param_1': 1}
2025-03-19 02:46:26,592 - sqlalchemy.engine.Engine - INFO - UPDATE classes SET student_rep_id=%(student_rep_id)s::UUID, assistant_rep_id=%(assistant_rep_id)s::UUID, last_modified_at=now() WHERE classes.id = %(classes_id)s::UUID
2025-03-19 02:46:26,593 - sqlalchemy.engine.Engine - INFO - [generated in 0.00104s] {'student_rep_id': UUID('00000000-0000-0000-0000-000000000000'), 'assistant_rep_id': UUID('00000000-0000-0000-0000-000000000000'), 'classes_id': UUID('6d3b633d-519a-4307-b042-2248f9d11d97')}
2025-03-19 02:46:26,604 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-19 02:46:26,607 - kademia - ERROR - Unhandled exception | 6a21f179-8fb9-4354-8742-db7545637dea | Error during during fk insertion of student with id:00000000-0000-0000-0000-000000000000 during update operation. Detail Foreign key constraint violation during create operation. Detail: (raised as a result of Query-invoked autoflush; consider using a session.no_autoflush block if this flush is occurring prematurely)
(psycopg2.errors.ForeignKeyViolation) insert or update on table "classes" violates foreign key constraint "fk_classes_students_student_rep"
DETAIL:  Key (student_rep_id)=(00000000-0000-0000-0000-000000000000) is not present in table "students".

[SQL: UPDATE classes SET student_rep_id=%(student_rep_id)s::UUID, assistant_rep_id=%(assistant_rep_id)s::UUID, last_modified_at=now() WHERE classes.id = %(classes_id)s::UUID]
[parameters: {'student_rep_id': UUID('00000000-0000-0000-0000-000000000000'), 'assistant_rep_id': UUID('00000000-0000-0000-0000-000000000000'), 'classes_id': UUID('6d3b633d-519a-4307-b042-2248f9d11d97')}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 111, in receive
    return self.receive_nowait()
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 106, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 124, in receive
    return receiver.item
           ^^^^^^^^^^^^^
AttributeError: 'MemoryObjectItemReceiver' object has no attribute 'item'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 157, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 126, in receive
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\middleware\error_handler.py", line 81, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\fastapi\routing.py", line 214, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\to_thread.py", line 56, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2461, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 962, in run
    result = context.run(func, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\routers\student_organization\classes.py", line 36, in update_class
    return class_crud.update_class(class_id, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\crud\student_organization\classes.py", line 63, in update_class
    updated_class = self.factory.update_class(class_id, data)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\core\factories\student_organization\classes.py", line 137, in update_class
    raise error_class(id=entity_id, detail=str(e), action='update')
app.core.errors.profile_errors.RelatedStudentNotFoundError: Error during during fk insertion of student with id:00000000-0000-0000-0000-000000000000 during update operation. Detail Foreign key constraint violation during create operation. Detail: (raised as a result of Query-invoked autoflush; consider using a session.no_autoflush block if this flush is occurring prematurely)
(psycopg2.errors.ForeignKeyViolation) insert or update on table "classes" violates foreign key constraint "fk_classes_students_student_rep"
DETAIL:  Key (student_rep_id)=(00000000-0000-0000-0000-000000000000) is not present in table "students".

[SQL: UPDATE classes SET student_rep_id=%(student_rep_id)s::UUID, assistant_rep_id=%(assistant_rep_id)s::UUID, last_modified_at=now() WHERE classes.id = %(classes_id)s::UUID]
[parameters: {'student_rep_id': UUID('00000000-0000-0000-0000-000000000000'), 'assistant_rep_id': UUID('00000000-0000-0000-0000-000000000000'), 'classes_id': UUID('6d3b633d-519a-4307-b042-2248f9d11d97')}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-19 02:46:26,613 - kademia - WARNING - RelationshipError | 6a21f179-8fb9-4354-8742-db7545637dea | Error during during fk insertion of student with id:00000000-0000-0000-0000-000000000000 during update operation. Detail Foreign key constraint violation during create operation. Detail: (raised as a result of Query-invoked autoflush; consider using a session.no_autoflush block if this flush is occurring prematurely)
(psycopg2.errors.ForeignKeyViolation) insert or update on table "classes" violates foreign key constraint "fk_classes_students_student_rep"
DETAIL:  Key (student_rep_id)=(00000000-0000-0000-0000-000000000000) is not present in table "students".

[SQL: UPDATE classes SET student_rep_id=%(student_rep_id)s::UUID, assistant_rep_id=%(assistant_rep_id)s::UUID, last_modified_at=now() WHERE classes.id = %(classes_id)s::UUID]
[parameters: {'student_rep_id': UUID('00000000-0000-0000-0000-000000000000'), 'assistant_rep_id': UUID('00000000-0000-0000-0000-000000000000'), 'classes_id': UUID('6d3b633d-519a-4307-b042-2248f9d11d97')}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-03-19 02:46:37,965 - kademia - INFO - Request started | 4d8a2ed9-176e-459c-bb4c-9ddf05dffb6a | PATCH /api/v1/students/student_organization/6d3b633d-519a-4307-b042-2248f9d11d97
2025-03-19 02:46:37,968 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 02:46:37,969 - sqlalchemy.engine.Engine - INFO - SELECT classes.id AS classes_id, classes.level_id AS classes_level_id, classes.code AS classes_code, classes.supervisor_id AS classes_supervisor_id, classes.student_rep_id AS classes_student_rep_id, classes.assistant_rep_id AS classes_assistant_rep_id, classes."order" AS classes_order, classes.created_by AS classes_created_by, classes.last_modified_by AS classes_last_modified_by, classes.created_at AS classes_created_at, classes.last_modified_at AS classes_last_modified_at, classes.is_archived AS classes_is_archived, classes.archived_at AS classes_archived_at, classes.archive_reason AS classes_archive_reason, classes.archived_by AS classes_archived_by 
FROM classes 
WHERE classes.is_archived = false AND classes.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-03-19 02:46:37,969 - sqlalchemy.engine.Engine - INFO - [cached since 101.1s ago] {'id_1': UUID('6d3b633d-519a-4307-b042-2248f9d11d97'), 'param_1': 1}
2025-03-19 02:46:37,974 - sqlalchemy.engine.Engine - INFO - UPDATE classes SET last_modified_at=now(), is_archived=%(is_archived)s, archived_at=%(archived_at)s, archive_reason=%(archive_reason)s, archived_by=%(archived_by)s::UUID WHERE classes.id = %(classes_id)s::UUID
2025-03-19 02:46:37,975 - sqlalchemy.engine.Engine - INFO - [generated in 0.00127s] {'is_archived': True, 'archived_at': datetime.datetime(2025, 3, 19, 2, 46, 37, 973684, tzinfo=datetime.timezone.utc), 'archive_reason': 'ERROR', 'archived_by': UUID('00000000-0000-0000-0000-000000000000'), 'classes_id': UUID('6d3b633d-519a-4307-b042-2248f9d11d97')}
2025-03-19 02:46:37,986 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-19 02:46:37,992 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 02:46:37,995 - sqlalchemy.engine.Engine - INFO - SELECT classes.id, classes.level_id, classes.code, classes.supervisor_id, classes.student_rep_id, classes.assistant_rep_id, classes."order", classes.created_by, classes.last_modified_by, classes.created_at, classes.last_modified_at, classes.is_archived, classes.archived_at, classes.archive_reason, classes.archived_by 
FROM classes 
WHERE classes.id = %(pk_1)s::UUID
2025-03-19 02:46:37,995 - sqlalchemy.engine.Engine - INFO - [generated in 0.00051s] {'pk_1': UUID('6d3b633d-519a-4307-b042-2248f9d11d97')}
2025-03-19 02:46:37,997 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-19 02:46:37,997 - kademia - INFO - Request completed | 4d8a2ed9-176e-459c-bb4c-9ddf05dffb6a | Status: 204 | Time: 0.031s
2025-03-19 02:46:47,722 - kademia - INFO - Request started | 319dc9a7-8509-4b7e-b094-2a7c08aa0211 | GET /api/v1/students/student_organization/6d3b633d-519a-4307-b042-2248f9d11d97
2025-03-19 02:46:47,724 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 02:46:47,725 - sqlalchemy.engine.Engine - INFO - SELECT classes.id AS classes_id, classes.level_id AS classes_level_id, classes.code AS classes_code, classes.supervisor_id AS classes_supervisor_id, classes.student_rep_id AS classes_student_rep_id, classes.assistant_rep_id AS classes_assistant_rep_id, classes."order" AS classes_order, classes.created_by AS classes_created_by, classes.last_modified_by AS classes_last_modified_by, classes.created_at AS classes_created_at, classes.last_modified_at AS classes_last_modified_at, classes.is_archived AS classes_is_archived, classes.archived_at AS classes_archived_at, classes.archive_reason AS classes_archive_reason, classes.archived_by AS classes_archived_by 
FROM classes 
WHERE classes.is_archived = false AND classes.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-03-19 02:46:47,725 - sqlalchemy.engine.Engine - INFO - [cached since 110.9s ago] {'id_1': UUID('6d3b633d-519a-4307-b042-2248f9d11d97'), 'param_1': 1}
2025-03-19 02:46:47,727 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-19 02:46:47,729 - kademia - ERROR - Unhandled exception | 319dc9a7-8509-4b7e-b094-2a7c08aa0211 | Class with id:6d3b633d-519a-4307-b042-2248f9d11d97 not found. DETAIL: Classes not with id 6d3b633d-519a-4307-b042-2248f9d11d97 not found. DETAIL: Record not found
Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 111, in receive
    return self.receive_nowait()
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 106, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 124, in receive
    return receiver.item
           ^^^^^^^^^^^^^
AttributeError: 'MemoryObjectItemReceiver' object has no attribute 'item'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 157, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 126, in receive
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\middleware\error_handler.py", line 81, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\fastapi\routing.py", line 214, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\to_thread.py", line 56, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2461, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 962, in run
    result = context.run(func, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\routers\student_organization\classes.py", line 30, in get_class
    return class_crud.get_class(class_id)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\crud\student_organization\classes.py", line 41, in get_class
    class_response = self.factory.get_class(class_id)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\core\factories\student_organization\classes.py", line 87, in get_class
    raise ClassNotFoundError(id=class_id, detail = str(e))
app.core.errors.student_organisation_errors.ClassNotFoundError: Class with id:6d3b633d-519a-4307-b042-2248f9d11d97 not found. DETAIL: Classes not with id 6d3b633d-519a-4307-b042-2248f9d11d97 not found. DETAIL: Record not found
2025-03-19 02:46:47,735 - kademia - WARNING - EntityNotFoundError | 319dc9a7-8509-4b7e-b094-2a7c08aa0211 | Class with id:6d3b633d-519a-4307-b042-2248f9d11d97 not found. DETAIL: Classes not with id 6d3b633d-519a-4307-b042-2248f9d11d97 not found. DETAIL: Record not found
2025-03-19 02:46:59,533 - kademia - INFO - Request started | 2020d948-e876-41ea-a7cf-5e728436e91e | GET /api/v1/archive/students/student_organization/
2025-03-19 02:46:59,535 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 02:46:59,536 - sqlalchemy.engine.Engine - INFO - SELECT classes.id AS classes_id, classes.level_id AS classes_level_id, classes.code AS classes_code, classes.supervisor_id AS classes_supervisor_id, classes.student_rep_id AS classes_student_rep_id, classes.assistant_rep_id AS classes_assistant_rep_id, classes."order" AS classes_order, classes.created_by AS classes_created_by, classes.last_modified_by AS classes_last_modified_by, classes.created_at AS classes_created_at, classes.last_modified_at AS classes_last_modified_at, classes.is_archived AS classes_is_archived, classes.archived_at AS classes_archived_at, classes.archive_reason AS classes_archive_reason, classes.archived_by AS classes_archived_by 
FROM classes 
WHERE classes.is_archived = true ORDER BY classes."order" DESC 
 LIMIT %(param_1)s OFFSET %(param_2)s
2025-03-19 02:46:59,537 - sqlalchemy.engine.Engine - INFO - [generated in 0.00106s] {'param_1': 50, 'param_2': 0}
2025-03-19 02:46:59,540 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-19 02:46:59,541 - kademia - INFO - Request completed | 2020d948-e876-41ea-a7cf-5e728436e91e | Status: 200 | Time: 0.009s
2025-03-19 02:47:08,754 - kademia - INFO - Request started | a125347a-22c2-4ffb-a8ea-2f381566f37f | GET /api/v1/archive/students/student_organization/6d3b633d-519a-4307-b042-2248f9d11d97
2025-03-19 02:47:08,756 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 02:47:08,757 - sqlalchemy.engine.Engine - INFO - SELECT classes.id AS classes_id, classes.level_id AS classes_level_id, classes.code AS classes_code, classes.supervisor_id AS classes_supervisor_id, classes.student_rep_id AS classes_student_rep_id, classes.assistant_rep_id AS classes_assistant_rep_id, classes."order" AS classes_order, classes.created_by AS classes_created_by, classes.last_modified_by AS classes_last_modified_by, classes.created_at AS classes_created_at, classes.last_modified_at AS classes_last_modified_at, classes.is_archived AS classes_is_archived, classes.archived_at AS classes_archived_at, classes.archive_reason AS classes_archive_reason, classes.archived_by AS classes_archived_by 
FROM classes 
WHERE classes.is_archived = true AND classes.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-03-19 02:47:08,759 - sqlalchemy.engine.Engine - INFO - [generated in 0.00159s] {'id_1': UUID('6d3b633d-519a-4307-b042-2248f9d11d97'), 'param_1': 1}
2025-03-19 02:47:08,763 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-19 02:47:08,764 - kademia - INFO - Request completed | a125347a-22c2-4ffb-a8ea-2f381566f37f | Status: 200 | Time: 0.010s
2025-03-19 02:47:18,954 - kademia - INFO - Request started | 92e1ced7-a08b-43a2-bf4f-0f56cef14b2e | PATCH /api/v1/archive/students/student_organization/6d3b633d-519a-4307-b042-2248f9d11d97
2025-03-19 02:47:18,955 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 02:47:18,956 - sqlalchemy.engine.Engine - INFO - SELECT classes.id AS classes_id, classes.level_id AS classes_level_id, classes.code AS classes_code, classes.supervisor_id AS classes_supervisor_id, classes.student_rep_id AS classes_student_rep_id, classes.assistant_rep_id AS classes_assistant_rep_id, classes."order" AS classes_order, classes.created_by AS classes_created_by, classes.last_modified_by AS classes_last_modified_by, classes.created_at AS classes_created_at, classes.last_modified_at AS classes_last_modified_at, classes.is_archived AS classes_is_archived, classes.archived_at AS classes_archived_at, classes.archive_reason AS classes_archive_reason, classes.archived_by AS classes_archived_by 
FROM classes 
WHERE classes.is_archived = true AND classes.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-03-19 02:47:18,957 - sqlalchemy.engine.Engine - INFO - [cached since 10.2s ago] {'id_1': UUID('6d3b633d-519a-4307-b042-2248f9d11d97'), 'param_1': 1}
2025-03-19 02:47:18,960 - sqlalchemy.engine.Engine - INFO - SELECT classes.id AS classes_id, classes.level_id AS classes_level_id, classes.code AS classes_code, classes.supervisor_id AS classes_supervisor_id, classes.student_rep_id AS classes_student_rep_id, classes.assistant_rep_id AS classes_assistant_rep_id, classes."order" AS classes_order, classes.created_by AS classes_created_by, classes.last_modified_by AS classes_last_modified_by, classes.created_at AS classes_created_at, classes.last_modified_at AS classes_last_modified_at, classes.is_archived AS classes_is_archived, classes.archived_at AS classes_archived_at, classes.archive_reason AS classes_archive_reason, classes.archived_by AS classes_archived_by 
FROM classes 
WHERE classes.is_archived = true AND classes.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-03-19 02:47:18,960 - sqlalchemy.engine.Engine - INFO - [cached since 10.2s ago] {'id_1': UUID('6d3b633d-519a-4307-b042-2248f9d11d97'), 'param_1': 1}
2025-03-19 02:47:18,964 - sqlalchemy.engine.Engine - INFO - UPDATE classes SET last_modified_at=now(), is_archived=%(is_archived)s WHERE classes.id = %(classes_id)s::UUID
2025-03-19 02:47:18,964 - sqlalchemy.engine.Engine - INFO - [generated in 0.00068s] {'is_archived': False, 'classes_id': UUID('6d3b633d-519a-4307-b042-2248f9d11d97')}
2025-03-19 02:47:18,966 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-19 02:47:18,969 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 02:47:18,970 - sqlalchemy.engine.Engine - INFO - SELECT classes.id AS classes_id, classes.level_id AS classes_level_id, classes.code AS classes_code, classes.supervisor_id AS classes_supervisor_id, classes.student_rep_id AS classes_student_rep_id, classes.assistant_rep_id AS classes_assistant_rep_id, classes."order" AS classes_order, classes.created_by AS classes_created_by, classes.last_modified_by AS classes_last_modified_by, classes.created_at AS classes_created_at, classes.last_modified_at AS classes_last_modified_at, classes.is_archived AS classes_is_archived, classes.archived_at AS classes_archived_at, classes.archive_reason AS classes_archive_reason, classes.archived_by AS classes_archived_by 
FROM classes 
WHERE classes.id = %(pk_1)s::UUID
2025-03-19 02:47:18,971 - sqlalchemy.engine.Engine - INFO - [generated in 0.00109s] {'pk_1': UUID('6d3b633d-519a-4307-b042-2248f9d11d97')}
2025-03-19 02:47:18,977 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-19 02:47:18,978 - kademia - INFO - Request completed | 92e1ced7-a08b-43a2-bf4f-0f56cef14b2e | Status: 200 | Time: 0.024s
2025-03-19 02:47:29,633 - kademia - INFO - Request started | c92f2e43-b486-4e10-bc98-e6aad38d90fe | DELETE /api/v1/archive/students/student_organization/6d3b633d-519a-4307-b042-2248f9d11d97
2025-03-19 02:47:29,635 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 02:47:29,636 - sqlalchemy.engine.Engine - INFO - SELECT classes.id AS classes_id, classes.level_id AS classes_level_id, classes.code AS classes_code, classes.supervisor_id AS classes_supervisor_id, classes.student_rep_id AS classes_student_rep_id, classes.assistant_rep_id AS classes_assistant_rep_id, classes."order" AS classes_order, classes.created_by AS classes_created_by, classes.last_modified_by AS classes_last_modified_by, classes.created_at AS classes_created_at, classes.last_modified_at AS classes_last_modified_at, classes.is_archived AS classes_is_archived, classes.archived_at AS classes_archived_at, classes.archive_reason AS classes_archive_reason, classes.archived_by AS classes_archived_by 
FROM classes 
WHERE classes.is_archived = false AND classes.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-03-19 02:47:29,637 - sqlalchemy.engine.Engine - INFO - [cached since 152.8s ago] {'id_1': UUID('6d3b633d-519a-4307-b042-2248f9d11d97'), 'param_1': 1}
2025-03-19 02:47:29,646 - sqlalchemy.engine.Engine - INFO - SELECT students.student_id AS students_student_id, students.user_type AS students_user_type, students.access_level AS students_access_level, students.status AS students_status, students.date_of_birth AS students_date_of_birth, students.image_url AS students_image_url, students.class_id AS students_class_id, students.level_id AS students_level_id, students.department_id AS students_department_id, students.guardian_id AS students_guardian_id, students.is_repeating AS students_is_repeating, students.admission_date AS students_admission_date, students.date_left AS students_date_left, students.graduation_date AS students_graduation_date, students.id AS students_id, students.password_hash AS students_password_hash, students.first_name AS students_first_name, students.last_name AS students_last_name, students.gender AS students_gender, students.last_login AS students_last_login, students.deletion_eligible AS students_deletion_eligible, students.created_by AS students_created_by, students.last_modified_by AS students_last_modified_by, students.created_at AS students_created_at, students.last_modified_at AS students_last_modified_at, students.is_archived AS students_is_archived, students.archived_at AS students_archived_at, students.archive_reason AS students_archive_reason, students.archived_by AS students_archived_by 
FROM students 
WHERE %(param_1)s::UUID = students.class_id
2025-03-19 02:47:29,649 - sqlalchemy.engine.Engine - INFO - [generated in 0.00306s] {'param_1': UUID('6d3b633d-519a-4307-b042-2248f9d11d97')}
2025-03-19 02:47:29,653 - sqlalchemy.engine.Engine - INFO - DELETE FROM classes WHERE classes.id = %(id)s::UUID
2025-03-19 02:47:29,653 - sqlalchemy.engine.Engine - INFO - [generated in 0.00044s] {'id': UUID('6d3b633d-519a-4307-b042-2248f9d11d97')}
2025-03-19 02:47:29,666 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-19 02:47:29,672 - kademia - INFO - Request completed | c92f2e43-b486-4e10-bc98-e6aad38d90fe | Status: 204 | Time: 0.039s
2025-03-19 02:48:05,526 - kademia - INFO - Request started | 19a8e5dc-9079-4cb1-bcf0-5220de7f314a | PATCH /api/v1/archive/students/student_organization/6d3b633d-519a-4307-b042-2248f9d11d97
2025-03-19 02:48:05,528 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 02:48:05,529 - sqlalchemy.engine.Engine - INFO - SELECT classes.id AS classes_id, classes.level_id AS classes_level_id, classes.code AS classes_code, classes.supervisor_id AS classes_supervisor_id, classes.student_rep_id AS classes_student_rep_id, classes.assistant_rep_id AS classes_assistant_rep_id, classes."order" AS classes_order, classes.created_by AS classes_created_by, classes.last_modified_by AS classes_last_modified_by, classes.created_at AS classes_created_at, classes.last_modified_at AS classes_last_modified_at, classes.is_archived AS classes_is_archived, classes.archived_at AS classes_archived_at, classes.archive_reason AS classes_archive_reason, classes.archived_by AS classes_archived_by 
FROM classes 
WHERE classes.is_archived = true AND classes.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-03-19 02:48:05,531 - sqlalchemy.engine.Engine - INFO - [cached since 56.77s ago] {'id_1': UUID('6d3b633d-519a-4307-b042-2248f9d11d97'), 'param_1': 1}
2025-03-19 02:48:05,533 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-19 02:48:05,534 - kademia - ERROR - Unhandled exception | 19a8e5dc-9079-4cb1-bcf0-5220de7f314a | Class with id:6d3b633d-519a-4307-b042-2248f9d11d97 not found. DETAIL: Class with id:6d3b633d-519a-4307-b042-2248f9d11d97 not found. DETAIL: Classes not with id 6d3b633d-519a-4307-b042-2248f9d11d97 not found. DETAIL: object not found
Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 111, in receive
    return self.receive_nowait()
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 106, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 124, in receive
    return receiver.item
           ^^^^^^^^^^^^^
AttributeError: 'MemoryObjectItemReceiver' object has no attribute 'item'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 157, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 126, in receive
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\middleware\error_handler.py", line 81, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\fastapi\routing.py", line 214, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\to_thread.py", line 56, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2461, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 962, in run
    result = context.run(func, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\routers\student_organization\archived_classes.py", line 28, in restore_class
    return class_crud.restore_class(class_id)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\crud\student_organization\classes.py", line 114, in restore_class
    restored_class = self.factory.restore_class(class_id)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\core\factories\student_organization\classes.py", line 200, in restore_class
    raise ClassNotFoundError(id=class_id, detail = str(e))
app.core.errors.student_organisation_errors.ClassNotFoundError: Class with id:6d3b633d-519a-4307-b042-2248f9d11d97 not found. DETAIL: Class with id:6d3b633d-519a-4307-b042-2248f9d11d97 not found. DETAIL: Classes not with id 6d3b633d-519a-4307-b042-2248f9d11d97 not found. DETAIL: object not found
2025-03-19 02:48:05,544 - kademia - WARNING - EntityNotFoundError | 19a8e5dc-9079-4cb1-bcf0-5220de7f314a | Class with id:6d3b633d-519a-4307-b042-2248f9d11d97 not found. DETAIL: Class with id:6d3b633d-519a-4307-b042-2248f9d11d97 not found. DETAIL: Classes not with id 6d3b633d-519a-4307-b042-2248f9d11d97 not found. DETAIL: object not found
2025-03-19 02:48:36,422 - kademia - INFO - Request started | 7bd6ff19-9499-4d19-8385-d22cea0cdb68 | PATCH /api/v1/students/student_organization/87159b49-3b94-40c0-b3ab-a7d190311b15
2025-03-19 02:48:36,425 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 02:48:36,426 - sqlalchemy.engine.Engine - INFO - SELECT classes.id AS classes_id, classes.level_id AS classes_level_id, classes.code AS classes_code, classes.supervisor_id AS classes_supervisor_id, classes.student_rep_id AS classes_student_rep_id, classes.assistant_rep_id AS classes_assistant_rep_id, classes."order" AS classes_order, classes.created_by AS classes_created_by, classes.last_modified_by AS classes_last_modified_by, classes.created_at AS classes_created_at, classes.last_modified_at AS classes_last_modified_at, classes.is_archived AS classes_is_archived, classes.archived_at AS classes_archived_at, classes.archive_reason AS classes_archive_reason, classes.archived_by AS classes_archived_by 
FROM classes 
WHERE classes.is_archived = false AND classes.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-03-19 02:48:36,426 - sqlalchemy.engine.Engine - INFO - [cached since 219.6s ago] {'id_1': UUID('87159b49-3b94-40c0-b3ab-a7d190311b15'), 'param_1': 1}
2025-03-19 02:48:36,429 - sqlalchemy.engine.Engine - INFO - UPDATE classes SET last_modified_at=now(), is_archived=%(is_archived)s, archived_at=%(archived_at)s, archive_reason=%(archive_reason)s, archived_by=%(archived_by)s::UUID WHERE classes.id = %(classes_id)s::UUID
2025-03-19 02:48:36,429 - sqlalchemy.engine.Engine - INFO - [cached since 118.5s ago] {'is_archived': True, 'archived_at': datetime.datetime(2025, 3, 19, 2, 48, 36, 427751, tzinfo=datetime.timezone.utc), 'archive_reason': 'ERROR', 'archived_by': UUID('00000000-0000-0000-0000-000000000000'), 'classes_id': UUID('87159b49-3b94-40c0-b3ab-a7d190311b15')}
2025-03-19 02:48:36,431 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-19 02:48:36,434 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 02:48:36,434 - sqlalchemy.engine.Engine - INFO - SELECT classes.id, classes.level_id, classes.code, classes.supervisor_id, classes.student_rep_id, classes.assistant_rep_id, classes."order", classes.created_by, classes.last_modified_by, classes.created_at, classes.last_modified_at, classes.is_archived, classes.archived_at, classes.archive_reason, classes.archived_by 
FROM classes 
WHERE classes.id = %(pk_1)s::UUID
2025-03-19 02:48:36,437 - sqlalchemy.engine.Engine - INFO - [cached since 118.4s ago] {'pk_1': UUID('87159b49-3b94-40c0-b3ab-a7d190311b15')}
2025-03-19 02:48:36,438 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-19 02:48:36,439 - kademia - INFO - Request completed | 7bd6ff19-9499-4d19-8385-d22cea0cdb68 | Status: 204 | Time: 0.016s
2025-03-19 02:48:44,125 - kademia - INFO - Request started | 62bb0537-9361-48c6-8bba-4c3ebe8651a8 | GET /api/v1/students/student_organization/87159b49-3b94-40c0-b3ab-a7d190311b15
2025-03-19 02:48:44,127 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 02:48:44,127 - sqlalchemy.engine.Engine - INFO - SELECT classes.id AS classes_id, classes.level_id AS classes_level_id, classes.code AS classes_code, classes.supervisor_id AS classes_supervisor_id, classes.student_rep_id AS classes_student_rep_id, classes.assistant_rep_id AS classes_assistant_rep_id, classes."order" AS classes_order, classes.created_by AS classes_created_by, classes.last_modified_by AS classes_last_modified_by, classes.created_at AS classes_created_at, classes.last_modified_at AS classes_last_modified_at, classes.is_archived AS classes_is_archived, classes.archived_at AS classes_archived_at, classes.archive_reason AS classes_archive_reason, classes.archived_by AS classes_archived_by 
FROM classes 
WHERE classes.is_archived = false AND classes.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-03-19 02:48:44,128 - sqlalchemy.engine.Engine - INFO - [cached since 227.3s ago] {'id_1': UUID('87159b49-3b94-40c0-b3ab-a7d190311b15'), 'param_1': 1}
2025-03-19 02:48:44,130 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-19 02:48:44,131 - kademia - ERROR - Unhandled exception | 62bb0537-9361-48c6-8bba-4c3ebe8651a8 | Class with id:87159b49-3b94-40c0-b3ab-a7d190311b15 not found. DETAIL: Classes not with id 87159b49-3b94-40c0-b3ab-a7d190311b15 not found. DETAIL: Record not found
Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 111, in receive
    return self.receive_nowait()
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 106, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 124, in receive
    return receiver.item
           ^^^^^^^^^^^^^
AttributeError: 'MemoryObjectItemReceiver' object has no attribute 'item'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 157, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 126, in receive
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\middleware\error_handler.py", line 81, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\fastapi\routing.py", line 214, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\to_thread.py", line 56, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2461, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 962, in run
    result = context.run(func, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\routers\student_organization\classes.py", line 30, in get_class
    return class_crud.get_class(class_id)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\crud\student_organization\classes.py", line 41, in get_class
    class_response = self.factory.get_class(class_id)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\core\factories\student_organization\classes.py", line 87, in get_class
    raise ClassNotFoundError(id=class_id, detail = str(e))
app.core.errors.student_organisation_errors.ClassNotFoundError: Class with id:87159b49-3b94-40c0-b3ab-a7d190311b15 not found. DETAIL: Classes not with id 87159b49-3b94-40c0-b3ab-a7d190311b15 not found. DETAIL: Record not found
2025-03-19 02:48:44,140 - kademia - WARNING - EntityNotFoundError | 62bb0537-9361-48c6-8bba-4c3ebe8651a8 | Class with id:87159b49-3b94-40c0-b3ab-a7d190311b15 not found. DETAIL: Classes not with id 87159b49-3b94-40c0-b3ab-a7d190311b15 not found. DETAIL: Record not found
2025-03-19 02:49:40,565 - kademia - INFO - Request started | 84b4001e-23a7-48c1-9037-242d0300c30d | PATCH /api/v1/students/student_organization/87159b49-3b94-40c0-b3ab-a7d190311b15
2025-03-19 02:49:40,568 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 02:49:40,569 - sqlalchemy.engine.Engine - INFO - SELECT classes.id AS classes_id, classes.level_id AS classes_level_id, classes.code AS classes_code, classes.supervisor_id AS classes_supervisor_id, classes.student_rep_id AS classes_student_rep_id, classes.assistant_rep_id AS classes_assistant_rep_id, classes."order" AS classes_order, classes.created_by AS classes_created_by, classes.last_modified_by AS classes_last_modified_by, classes.created_at AS classes_created_at, classes.last_modified_at AS classes_last_modified_at, classes.is_archived AS classes_is_archived, classes.archived_at AS classes_archived_at, classes.archive_reason AS classes_archive_reason, classes.archived_by AS classes_archived_by 
FROM classes 
WHERE classes.is_archived = false AND classes.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-03-19 02:49:40,570 - sqlalchemy.engine.Engine - INFO - [cached since 283.7s ago] {'id_1': UUID('87159b49-3b94-40c0-b3ab-a7d190311b15'), 'param_1': 1}
2025-03-19 02:49:40,571 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-19 02:49:40,573 - kademia - ERROR - Unhandled exception | 84b4001e-23a7-48c1-9037-242d0300c30d | Class with id:87159b49-3b94-40c0-b3ab-a7d190311b15 not found. DETAIL: Classes not with id 87159b49-3b94-40c0-b3ab-a7d190311b15 not found. DETAIL: object not found
Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 111, in receive
    return self.receive_nowait()
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 106, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 124, in receive
    return receiver.item
           ^^^^^^^^^^^^^
AttributeError: 'MemoryObjectItemReceiver' object has no attribute 'item'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 157, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\streams\memory.py", line 126, in receive
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\middleware\error_handler.py", line 81, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\fastapi\routing.py", line 214, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\starlette\concurrency.py", line 39, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\to_thread.py", line 56, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 2461, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\venv\Lib\site-packages\anyio\_backends\_asyncio.py", line 962, in run
    result = context.run(func, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\routers\student_organization\classes.py", line 42, in archive_class
    return class_crud.archive_class(class_id, reason.reason)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\crud\student_organization\classes.py", line 74, in archive_class
    self.factory.archive_class(class_id, reason)
  File "C:\Users\dell\Desktop\Engineering\Projects\Kademia\V2\app\core\factories\student_organization\classes.py", line 153, in archive_class
    raise ClassNotFoundError(id=class_id, detail = str(e))
app.core.errors.student_organisation_errors.ClassNotFoundError: Class with id:87159b49-3b94-40c0-b3ab-a7d190311b15 not found. DETAIL: Classes not with id 87159b49-3b94-40c0-b3ab-a7d190311b15 not found. DETAIL: object not found
2025-03-19 02:49:40,577 - kademia - WARNING - EntityNotFoundError | 84b4001e-23a7-48c1-9037-242d0300c30d | Class with id:87159b49-3b94-40c0-b3ab-a7d190311b15 not found. DETAIL: Classes not with id 87159b49-3b94-40c0-b3ab-a7d190311b15 not found. DETAIL: object not found
2025-03-19 02:50:03,250 - kademia - INFO - Request started | a6858cd7-00fa-4430-99be-e222cd059032 | PATCH /api/v1/archive/students/student_organization/87159b49-3b94-40c0-b3ab-a7d190311b15
2025-03-19 02:50:03,252 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 02:50:03,252 - sqlalchemy.engine.Engine - INFO - SELECT classes.id AS classes_id, classes.level_id AS classes_level_id, classes.code AS classes_code, classes.supervisor_id AS classes_supervisor_id, classes.student_rep_id AS classes_student_rep_id, classes.assistant_rep_id AS classes_assistant_rep_id, classes."order" AS classes_order, classes.created_by AS classes_created_by, classes.last_modified_by AS classes_last_modified_by, classes.created_at AS classes_created_at, classes.last_modified_at AS classes_last_modified_at, classes.is_archived AS classes_is_archived, classes.archived_at AS classes_archived_at, classes.archive_reason AS classes_archive_reason, classes.archived_by AS classes_archived_by 
FROM classes 
WHERE classes.is_archived = true AND classes.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-03-19 02:50:03,253 - sqlalchemy.engine.Engine - INFO - [cached since 174.5s ago] {'id_1': UUID('87159b49-3b94-40c0-b3ab-a7d190311b15'), 'param_1': 1}
2025-03-19 02:50:03,256 - sqlalchemy.engine.Engine - INFO - SELECT classes.id AS classes_id, classes.level_id AS classes_level_id, classes.code AS classes_code, classes.supervisor_id AS classes_supervisor_id, classes.student_rep_id AS classes_student_rep_id, classes.assistant_rep_id AS classes_assistant_rep_id, classes."order" AS classes_order, classes.created_by AS classes_created_by, classes.last_modified_by AS classes_last_modified_by, classes.created_at AS classes_created_at, classes.last_modified_at AS classes_last_modified_at, classes.is_archived AS classes_is_archived, classes.archived_at AS classes_archived_at, classes.archive_reason AS classes_archive_reason, classes.archived_by AS classes_archived_by 
FROM classes 
WHERE classes.is_archived = true AND classes.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-03-19 02:50:03,257 - sqlalchemy.engine.Engine - INFO - [cached since 174.5s ago] {'id_1': UUID('87159b49-3b94-40c0-b3ab-a7d190311b15'), 'param_1': 1}
2025-03-19 02:50:03,261 - sqlalchemy.engine.Engine - INFO - UPDATE classes SET last_modified_at=now(), is_archived=%(is_archived)s WHERE classes.id = %(classes_id)s::UUID
2025-03-19 02:50:03,283 - sqlalchemy.engine.Engine - INFO - [cached since 164.3s ago] {'is_archived': False, 'classes_id': UUID('87159b49-3b94-40c0-b3ab-a7d190311b15')}
2025-03-19 02:50:03,288 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-19 02:50:03,294 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 02:50:03,295 - sqlalchemy.engine.Engine - INFO - SELECT classes.id AS classes_id, classes.level_id AS classes_level_id, classes.code AS classes_code, classes.supervisor_id AS classes_supervisor_id, classes.student_rep_id AS classes_student_rep_id, classes.assistant_rep_id AS classes_assistant_rep_id, classes."order" AS classes_order, classes.created_by AS classes_created_by, classes.last_modified_by AS classes_last_modified_by, classes.created_at AS classes_created_at, classes.last_modified_at AS classes_last_modified_at, classes.is_archived AS classes_is_archived, classes.archived_at AS classes_archived_at, classes.archive_reason AS classes_archive_reason, classes.archived_by AS classes_archived_by 
FROM classes 
WHERE classes.id = %(pk_1)s::UUID
2025-03-19 02:50:03,300 - sqlalchemy.engine.Engine - INFO - [cached since 164.3s ago] {'pk_1': UUID('87159b49-3b94-40c0-b3ab-a7d190311b15')}
2025-03-19 02:50:03,302 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-03-19 02:50:03,303 - kademia - INFO - Request completed | a6858cd7-00fa-4430-99be-e222cd059032 | Status: 200 | Time: 0.053s
2025-03-19 02:50:12,002 - kademia - INFO - Request started | e1275db7-150f-423b-8abe-e2481623f73a | DELETE /api/v1/archive/students/student_organization/87159b49-3b94-40c0-b3ab-a7d190311b15
2025-03-19 02:50:12,004 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-03-19 02:50:12,005 - sqlalchemy.engine.Engine - INFO - SELECT classes.id AS classes_id, classes.level_id AS classes_level_id, classes.code AS classes_code, classes.supervisor_id AS classes_supervisor_id, classes.student_rep_id AS classes_student_rep_id, classes.assistant_rep_id AS classes_assistant_rep_id, classes."order" AS classes_order, classes.created_by AS classes_created_by, classes.last_modified_by AS classes_last_modified_by, classes.created_at AS classes_created_at, classes.last_modified_at AS classes_last_modified_at, classes.is_archived AS classes_is_archived, classes.archived_at AS classes_archived_at, classes.archive_reason AS classes_archive_reason, classes.archived_by AS classes_archived_by 
FROM classes 
WHERE classes.is_archived = false AND classes.id = %(id_1)s::UUID 
 LIMIT %(param_1)s
2025-03-19 02:50:12,005 - sqlalchemy.engine.Engine - INFO - [cached since 315.2s ago] {'id_1': UUID('87159b49-3b94-40c0-b3ab-a7d190311b15'), 'param_1': 1}
2025-03-19 02:50:12,008 - sqlalchemy.engine.Engine - INFO - SELECT students.student_id AS students_student_id, students.user_type AS students_user_type, students.access_level AS students_access_level, students.status AS students_status, students.date_of_birth AS students_date_of_birth, students.image_url AS students_image_url, students.class_id AS students_class_id, students.level_id AS students_level_id, students.department_id AS students_department_id, students.guardian_id AS students_guardian_id, students.is_repeating AS students_is_repeating, students.admission_date AS students_admission_date, students.date_left AS students_date_left, students.graduation_date AS students_graduation_date, students.id AS students_id, students.password_hash AS students_password_hash, students.first_name AS students_first_name, students.last_name AS students_last_name, students.gender AS students_gender, students.last_login AS students_last_login, students.deletion_eligible AS students_deletion_eligible, students.created_by AS students_created_by, students.last_modified_by AS students_last_modified_by, students.created_at AS students_created_at, students.last_modified_at AS students_last_modified_at, students.is_archived AS students_is_archived, students.archived_at AS students_archived_at, students.archive_reason AS students_archive_reason, students.archived_by AS students_archived_by 
FROM students 
WHERE %(param_1)s::UUID = students.class_id
2025-03-19 02:50:12,009 - sqlalchemy.engine.Engine - INFO - [cached since 162.4s ago] {'param_1': UUID('87159b49-3b94-40c0-b3ab-a7d190311b15')}
2025-03-19 02:50:12,012 - sqlalchemy.engine.Engine - INFO - DELETE FROM classes WHERE classes.id = %(id)s::UUID
2025-03-19 02:50:12,013 - sqlalchemy.engine.Engine - INFO - [cached since 162.4s ago] {'id': UUID('87159b49-3b94-40c0-b3ab-a7d190311b15')}
2025-03-19 02:50:12,015 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-03-19 02:50:12,019 - kademia - INFO - Request completed | e1275db7-150f-423b-8abe-e2481623f73a | Status: 204 | Time: 0.016s
2025-03-19 02:51:39,041 - kademia - INFO - Application started
